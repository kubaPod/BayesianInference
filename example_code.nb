Notebook[{

Cell[CellGroupData[{
Cell["Nested sampling with the BayesianInference package", \
"Title",ExpressionUUID->"c3f34d57-925e-4f95-92c2-19d5b664416d"],

Cell[CellGroupData[{

Cell["General", \
"Chapter",ExpressionUUID->"624c9164-0fe4-4f1e-b362-624e99f78c18"],

Cell[TextData[{
 "This package implements the nested sampling algorithm as described by John \
Skilling in his 2006 paper \[OpenCurlyDoubleQuote]Nested Sampling for General \
Bayesian Computation\[CloseCurlyDoubleQuote] (Bayesian Analysis, 1, number 4, \
pp. 833 - 860; available at ",
 Cell[BoxData[
  TemplateBox[{
   StyleBox["\"http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.117.\
5542&rep=rep1&type=pdf\"", "Text", StripOnInput -> False],
    "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.117.5542&rep=\
rep1&type=pdf"},
   "HyperlinkURL"]],ExpressionUUID->"d90716e5-c339-4a0f-bef1-e6bd26265ab8"],
 "). There is also some functionality for ordinary Markov Chain Monte Carlo \
(MCMC) sampling."
}], "Text",ExpressionUUID->"fe56e51f-9879-46b8-bd1b-3b8a3cf97438"],

Cell["Load the package:", \
"Text",ExpressionUUID->"c2cd2525-6743-4f5a-a26d-65c7614a84ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "BayesianInference`"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:=",ExpressionUUID->"9091f228-26fe-4eaf-9bca-4b7d4425d20b"],

Cell["The general workflow for using this package is as follows:", \
"Text",ExpressionUUID->"5dcbada7-f440-4639-9044-7fc10730d39a"],

Cell[CellGroupData[{

Cell[TextData[{
 "Define an inference problem using ",
 StyleBox["defineInferenceProblem",
  FontWeight->"Bold"],
 ". This returns an ",
 StyleBox["inferenceObject",
  FontWeight->"Bold"],
 " that contains all of the relevant  information needed for the next steps. \
defineInferenceProblem will do some sanity checks to try and anticipate \
problems further ahead"
}], "Item",ExpressionUUID->"6b63ee2e-50da-4b21-a5c1-2c763db7823a"],

Cell[TextData[{
 "Use ",
 StyleBox["nestedSampling",
  FontWeight->"Bold"],
 " or ",
 StyleBox["parallelNestedSampling",
  FontWeight->"Bold"],
 " to run the algorithm on the inferenceObject"
}], "Item",ExpressionUUID->"1d7696b3-2f32-4e9d-ac6b-1f64a5d4d592"],

Cell["Use visualisation functions to interpret the result", \
"Item",ExpressionUUID->"d8765d25-4067-4336-ab15-3df55ef272f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["About the nested sampling algorithm", \
"Subsection",ExpressionUUID->"3e4cc027-46e9-4b2e-9a46-b456658641b5"],

Cell[CellGroupData[{

Cell["What is it good for?", \
"Subsubsection",ExpressionUUID->"ed5e2430-f506-4250-b3cb-d61895be5eb6"],

Cell["\<\
The main goal of this package is to provide easy-to use code to do Bayesian \
inference with in Wolfram Language. The focus of the package is on the \
inference of distribution parameters from data and the computation of the \
evidence integral to compare different models of the data. \
\>", "Text",ExpressionUUID->"dbe313a7-dfb0-4a75-a64f-fa3abbb4c331"],

Cell["\<\
As a simple example of a problem, you could have a vector of numbers and \
you'd like to find out what distribution models these data:\
\>", "Text",ExpressionUUID->"3857cc4e-a6f3-4717-abc4-91f04721295a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.11751148528054446`"}], ",", 
     RowBox[{"-", "2.191995254140541`"}], ",", 
     RowBox[{"-", "0.5143685660334552`"}], ",", "0.2492396710667894`", ",", 
     "0.6840020913116259`", ",", "3.0847964529819953`", ",", 
     RowBox[{"-", "0.5024324412173994`"}], ",", "0.20244486030286893`", ",", 
     "0.4171228273329824`", ",", "0.2541157610514157`", ",", 
     RowBox[{"-", "12.07292196121161`"}], ",", "1.791517773009199`", ",", 
     "1.4615659758762654`", ",", 
     RowBox[{"-", "4.086822460322223`"}], ",", "2.0862808562289623`", ",", 
     RowBox[{"-", "0.4356962558165376`"}], ",", "1.3728589355070022`", ",", 
     "0.176323448749464`", ",", "3.8047877638159977`", ",", 
     "1.5122102999265055`"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "data", "]"}]}], "Input",
 CellLabel->
  "In[173]:=",ExpressionUUID->"b38f1d1f-7073-4b3b-ad9a-3dde81c7d822"],

Cell["\<\
The first idea is that these data could come from a normal distribution. A \
normal distribution has two free parameters that you would need to estimate:\
\>", "Text",ExpressionUUID->"9d94a05b-3602-4ac8-a07a-db99337cfc04"],

Cell[BoxData[
 RowBox[{"distNormal", " ", "=", 
  RowBox[{"NormalDistribution", "[", 
   RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}]}]], "Input",
 CellLabel->
  "In[180]:=",ExpressionUUID->"9cd65cdf-ce8f-43fc-8d28-1156e1934dc5"],

Cell["\<\
The posterior distribution of \[Mu] and \[Sigma] is given by, we know from \
Bayes\[CloseCurlyQuote] rule that:\
\>", "Text",ExpressionUUID->"279d221f-0b31-4b47-9206-a3dffa1d271e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ProbabilityPr]", 
   RowBox[{"[", 
    RowBox[{"\[Mu]", ",", 
     RowBox[{"\[Sigma]", "\[Conditioned]", "Data"}]}], "]"}]}], "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{"Likelihood", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", " ", "data"}], "]"}], 
    RowBox[{"\[ProbabilityPr]", 
     RowBox[{"[", 
      RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}]}]}], 
   "Z"]}]], "DisplayFormula",ExpressionUUID->"7f0a8756-0a26-4830-870e-\
79897b8d4b33"],

Cell["So to infer the posterior distribution, we need 3 things:", \
"Text",ExpressionUUID->"c5ea679b-fadb-4d10-a49a-e7c980d05bba"],

Cell[CellGroupData[{

Cell[TextData[{
 "The likelihood function",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{" ", 
     RowBox[{"Likelihood", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", " ", "data"}], "]"}]}],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "8fd5acbe-adfa-414e-b4f5-a185b3755f50"],
 ", which is an unnormalised function of \[Mu] and \[Sigma]. In this package, \
the likelihood is generally expressed as loglikelihood, because \
machine-precision arithmetic will often underflow when calculating the \
regular likelihood function. Whenever I mention the loglikelihood function in \
the context of this code package, I will always mean a function that:"
}], "Item",ExpressionUUID->"a8786c69-b027-4b09-8fc5-2c9a347f1b3a"],

Cell[CellGroupData[{

Cell["\<\
Had the data \[OpenCurlyDoubleQuote]backed in\[CloseCurlyDoubleQuote] to it. \
The data is treated as a given and will always be part of the loglikelihood \
function and never an argument. This is primarily for efficiency reasons.\
\>", "Subitem",ExpressionUUID->"d2ddd59c-f231-404c-b1a5-62a839e08ef9"],

Cell["Accepts the parameters as a list like such: ", \
"Subitem",ExpressionUUID->"f29b60ae-a67a-4ebf-b7f7-c4df3a3b62d6"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"logLikeFunction", "  ", "=", " ", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "paramVector", "}"}], ",", 
    RowBox[{"Likelihood", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"paramVector", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"paramVector", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", " ", "data"}], "]"}]}],
    "]"}]}]], "Input",ExpressionUUID->"90cbf967-2893-4369-ad2b-bbeb9cc93648"],

Cell[CellGroupData[{

Cell[TextData[{
 "A prior distribution ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ProbabilityPr]", 
    RowBox[{"[", 
     RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}]}], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"696c5081-5f67-445c-8a6f-a5247c439e08"],
 ". In this package, the prior will always be converted to a log-PDF function \
that (just like the loglikelihood) accepts the parameters as a list."
}], "Item",ExpressionUUID->"76d83696-68dd-4dc8-aed9-f40e81abd411"],

Cell[TextData[{
 "The normalising constant ",
 Cell[BoxData[
  FormBox[
   StyleBox["Z",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "e846725b-85fd-4100-a274-f3f326d2c4d9"],
 ", called the evidence (though in practise the quantity computed will be the \
log of the evidence). It is given by the multi-dimensional integral:"
}], "Item",ExpressionUUID->"f0b34172-0dfe-44bf-a822-dd039c2f9a98"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[Integral]", 
  RowBox[{
   RowBox[{"Likelihood", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", " ", "data"}], "]"}], 
   RowBox[{"\[ProbabilityPr]", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], 
     RowBox[{"\[DifferentialD]", "\[Mu]"}], " ", 
     RowBox[{
     "\[DifferentialD]", 
      "\[Sigma]"}]}]}]}]}]], \
"DisplayFormula",ExpressionUUID->"b1da2783-3c7b-4dd4-8358-6cdde50e77a1"],

Cell[TextData[{
 "The evidence is generally not analytically tractable and usually also \
difficult to approximate numerically with standard quadrature methods, which \
is a problem that the nested sampling algorithm specifically designed to \
solve. The evidence is a very useful quantity to know, though, because it\
\[CloseCurlyQuote]s a robust measure of model correctness for the data that \
automatically ",
 StyleBox["penalises",
  IgnoreSpellCheck->True],
 " a model for over-fitting. Thus, whenever the choice of model is uncertain, \
knowing the evidence for each will be of great help in model selection."
}], "Text",ExpressionUUID->"9c56bc68-b2a4-485e-808b-67c61141332b"],

Cell[TextData[{
 "It should be note that an implicit assumption that is being made here is \
that the model parameters like \[Mu] and \[Sigma] are continuous rather than \
discrete. This is the case for most inference problems, regardless of wether \
they are dealing with continuous data (like in this example) or nominal data \
(such as in classification). Classification is ultimately just regression of \
probabilities values, which are real values ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Element]", 
    RowBox[{"[", 
     RowBox[{"0", ",", " ", "1"}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "7a92d59d-f3ec-4818-ab53-1142bc50d799"],
 ". For example, the simplest nominal distribution is the ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"BernoulliDistribution", "[", "p", "]"}],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "45fe06c7-d9f6-4147-9451-874f96e925ce"],
 " , which is ",
 StyleBox["parameterised",
  IgnoreSpellCheck->True],
 " by the continuous variable ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "945386a0-4fc2-4142-bd62-f1b02a6385ce"],
 ". Still, it is good to take note of the fact that the code in this package ",
 StyleBox["cannot",
  FontSlant->"Italic"],
 " deal with discrete model parameters directly; it is purely for dealing \
with continuous integration problems over the parameter space."
}], "Text",ExpressionUUID->"5e1d4aa6-8060-4d11-9e56-0ac31e2336ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic code example", \
"Subsubsection",ExpressionUUID->"2408923d-35a7-42e2-8c14-fecd0b69cc1e"],

Cell["The model is defined like this:", \
"Text",ExpressionUUID->"36c19a3f-b6e5-47cb-914e-bbd730dd187a"],

Cell[BoxData[
 RowBox[{"normalModel", " ", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "data"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", "distNormal"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "0", ",", "\[Infinity]"}], "}"}]}], "}"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "100"}], "]"}], ",", " ", 
       RowBox[{"ExponentialDistribution", "[", 
        FractionBox["1", "100"], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[249]:=",ExpressionUUID->"1dd52159-c8c1-45a0-bcd2-e2d300eaf736"],

Cell[TextData[{
 "The nested sampling algorithm is applied directly to the generated ",
 StyleBox["inferenceObject",
  FontWeight->"Bold"],
 ":"
}], "Text",ExpressionUUID->"a3060586-1c10-4756-a601-7935d68e7996"],

Cell[BoxData[{
 RowBox[{"resultNormal", "=", 
  RowBox[{"nestedSampling", "[", 
   RowBox[{"normalModel", ",", 
    RowBox[{"\"\<MinMaxAcceptanceRate\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.9"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"resultNormal", "[", "\"\<LogEvidence\>\"", "]"}]}], "Input",
 CellLabel->
  "In[238]:=",ExpressionUUID->"a76c04e2-1c1a-431f-ae8e-31c1e1a526a4"],

Cell["\<\
The histogram of the data suggest that the data has heavy tails, so perhaps a \
Cauchy distribution is more appropriate. Let\[CloseCurlyQuote]s compare the \
models:\
\>", "Text",ExpressionUUID->"ed09b86e-baf1-49e7-9667-089377fdab3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"distCauchy", " ", "=", 
   RowBox[{"CauchyDistribution", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cauchyModel", " ", "=", 
   RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "data"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", "distCauchy"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "0", ",", "\[Infinity]"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "100"}], "]"}], ",", " ", 
        RowBox[{"ExponentialDistribution", "[", 
         FractionBox["1", "100"], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{"resultCauchy", "=", 
  RowBox[{
  "nestedSampling", "[", "cauchyModel", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"resultCauchy", "[", "\"\<LogEvidence\>\"", "]"}]}], "Input",
 CellLabel->
  "In[245]:=",ExpressionUUID->"fd76c0f0-eef8-40b7-ae81-5dc0553ce531"],

Cell[TextData[{
 "As you can see, the Cauchy model beats the normal model by about 5 points \
of logevidence or a factor of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Exp", "[", "5", "]"}], "\[Equal]", 
    FormBox["148.4131591025766`",
     TraditionalForm]}], TraditionalForm]],ExpressionUUID->
  "d474e952-2d91-4ef6-88df-bf471da1eb33"],
 "."
}], "Text",ExpressionUUID->"d07c7de5-6f28-42b8-a104-648b0d3014fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Brief explanation of the algorithm with interactive animation\
\>", "Subsubsection",ExpressionUUID->"3d147c61-b591-4dea-89b4-471c8bfd6168"],

Cell["\<\
The code below creates an animation visualising the process of generating \
samples from the posterior with the nested sampling algorithm:\
\>", "Text",ExpressionUUID->"084e5d42-fd8b-4900-9ef2-d11b793ee308"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"CauchyDistribution", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "25"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"obj", " ", "=", 
   RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
      RowBox[{"CauchyDistribution", "[", 
       RowBox[{"a", ",", " ", 
        RowBox[{"Exp", "[", "logb", "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"logb", ",", 
          RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<LocationParameter\>\"", ",", " ", "\"\<LocationParameter\>\""}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"result", " ", "=", 
   RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
    RowBox[{"obj", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "100"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<MinMaxAcceptanceRate\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.9"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]}], "Input",ExpressionUUID->"0e261c2d-c370-45cb-922f-a24f8673dc4d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "nestedSamplingAnimation", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nestedSamplingAnimation", "[", 
    RowBox[{"result_", ",", " ", 
     RowBox[{"numberOfSlides", " ", ":", "_Integer", " ", ":", " ", "100"}], 
     ",", " ", "opts___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"samples", "=", 
        RowBox[{"Values", "/@", 
         RowBox[{"Values", "@", 
          RowBox[{"Part", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"KeySort", "@", 
             RowBox[{"result", "[", "\"\<Samples\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", "All", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Point\>\"", ",", "\"\<LogLikelihood\>\""}], "}"}]}],
            "]"}]}]}]}], ",", "\[IndentingNewLine]", "subset", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"nLiveSamples", "=", 
        RowBox[{"result", "[", "\"\<SamplePoolSize\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"logLikelihood", " ", "=", " ", 
        RowBox[{"result", "[", "\"\<LogLikelihoodFunction\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"params", " ", "=", " ", 
        RowBox[{
         RowBox[{"result", "[", "\"\<Parameters\>\"", "]"}], "/.", 
         RowBox[{
          RowBox[{"DirectedInfinity", "[", "sign_", "]"}], "\[RuleDelayed]", 
          RowBox[{"sign", " ", "*", " ", "10"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"subset", "=", 
         RowBox[{"TakeDrop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"SortBy", "[", "Last", "]"}], "@", 
            RowBox[{"Take", "[", 
             RowBox[{"samples", ",", 
              RowBox[{"UpTo", "[", "n", "]"}]}], "]"}]}], ",", 
           RowBox[{"-", "nLiveSamples"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logLikelihood", "[", 
           RowBox[{"result", "[", "\"\<ParameterSymbols\>\"", "]"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"result", "[", "\"\<Parameters\>\"", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "opts", ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", "\"\<Text\>\"", ",", "16"}], "]"}], "&"}], 
             ")"}], "/@", 
            RowBox[{"result", "[", "\"\<ParameterSymbols\>\"", "]"}]}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", " ", 
               RowBox[{"Point", "[", 
                RowBox[{"Rest", "@", 
                 RowBox[{"subset", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}],
                ",", 
               RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"samples", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"n", "+", "1"}], ",", "1"}], "]"}], "]"}], "]"}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"n", ">", "nLiveSamples"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Black", ",", 
                 RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"Most", "@", 
                   RowBox[{"subset", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "All", ",", "1"}], "]"}], "]"}]}], 
                  "]"}], ",", 
                 RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"Last", "@", 
                   RowBox[{"subset", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "All", ",", "1"}], "]"}], "]"}]}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", "Nothing"}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Contours", "\[Rule]", 
           RowBox[{"subset", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "All", ",", "2"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "10"}]}], "]"}], ",", 
                 "\"\<Alive\>\""}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "10"}]}], "]"}], ",", 
                 "\"\<Dead\>\""}], "}"}]}], "}"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", "nLiveSamples", ",", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"nLiveSamples", "+", "numberOfSlides"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"result", "[", "\"\<Samples\>\"", "]"}], "]"}], "-", 
            "1"}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"36a9657d-bf90-4014-a040-93baef7e2b0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"slides", " ", "=", " ", 
   RowBox[{"nestedSamplingAnimation", "[", 
    RowBox[{"result", ",", "50"}], "]"}]}], ";"}], "\n", 
 RowBox[{"ListAnimate", "[", "\[IndentingNewLine]", 
  RowBox[{"slides", ",", "\[IndentingNewLine]", 
   RowBox[{"AnimationRate", "\[Rule]", "1"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",ExpressionUUID->"1093ff36-2c0a-44d2-8bb7-df0b62828884"],

Cell["The new sample generated in each step is obtained by:", \
"Text",ExpressionUUID->"2769c6ab-061d-427a-acab-479a8d536c68"],

Cell[CellGroupData[{

Cell["\<\
Picking one of the living samples at random. This already approximately \
samples the prior distribution if the living samples represent the prior \
well. Which they should, because the whole algorithm relies on that \
assumption.\
\>", "ItemNumbered",ExpressionUUID->"abf6b29f-f52c-4b2d-bfcf-32e4930505b3"],

Cell["\<\
Use Markov chain Monte Carlo (MCMC) to evolve the point and generate a new \
sample from a constrained version of the prior distribution. In simple terms, \
the prior density is set to zero wherever the loglikelihood function is less \
than the value of the worst currently living point. \
\>", "ItemNumbered",ExpressionUUID->"a14a4e3e-dd10-44a1-a415-c278dea6d329"]
}, Open  ]],

Cell["\<\
What you see in the animation is a contour plot of the loglikelihood \
function. Only the contours corresponding to dead samples are drawn, so the \
bright area in the center is the area where the likelihood is high enough to \
allow new samples to be drawn. 

In this animation you can clearly see the shells corresponding to \
(approximately) constant loglikelihood values. The evidence is estimated by \
estimating the volume of the prior contained in each of these shells. To put \
it into cooking terms: instead of integrating the posterior by dicing the \
domain into squares (like most integration methods do) and multiplying the \
volume of each square with the function value, the nested sampling algorithm \
works by peeling off the loglikelihood function like an onion. The volume of \
each onion peel cannot be derived exactly; it\[CloseCurlyQuote]s only known \
statistically. This is why the logevidence is reported with a standard error. \
\>", "Text",ExpressionUUID->"e153981e-9883-45b4-b647-ed0a85cf0a03"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["defineInferenceProblem and inferenceObject", \
"Subsection",ExpressionUUID->"941b4198-1153-45c4-baa9-2e7f28efe817"],

Cell["\<\
Here\[CloseCurlyQuote]s a typical usage example of defineInferenceProblem \
corresponding to the problem of inferencing the parameters of a normal \
distribution:\
\>", "Text",ExpressionUUID->"7d895088-c675-4a34-9786-255340e35a3d"],

Cell[BoxData[
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", "100"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"mu", ",", " ", "sigma"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mu", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sigma", ",", "0", ",", "\[Infinity]"}], "}"}]}], "}"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"ProductDistribution", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "100"}], "]"}], ",", 
       RowBox[{"ExponentialDistribution", "[", 
        RowBox[{"1", "/", "100"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[209]:=",ExpressionUUID->"229db5bd-6b08-495b-a533-454eca497c0b"],

Cell["\<\
Note the tooltip on the inferenceObject that gives a summary of its contents. \
The inferenceObject is basically just a wrapper for an Association that holds \
all relevant information. It\[CloseCurlyQuote]s important to note, though, \
that due to its typesetting you cannot copy-paste it in a notebook:\
\>", "Text",ExpressionUUID->"42e4b42e-e8f4-47c1-9b38-32b73edcffb1"],

Cell["\<\
This is intentional: if it was possible to copy-paste the object, it would be \
necessary to store potentially large amounts of data in the notebook, which \
would be slow.\
\>", "Text",ExpressionUUID->"c679e254-e3a8-4a9c-8027-42b5bc0098c5"],

Cell["\<\
This is how you check what properties are contained in the object:\
\>", "Text",ExpressionUUID->"8a107e1f-20c4-4c1f-a3b4-1f1117951021"],

Cell[BoxData[
 RowBox[{"obj", "[", "\"\<Properties\>\"", "]"}]], "Input",
 CellLabel->
  "In[210]:=",ExpressionUUID->"1e145958-b914-454b-a4d0-b89e59878fb4"],

Cell["\<\
You can add information manually, even properties that are just for your own \
convenience:\
\>", "Text",ExpressionUUID->"3e698b44-f3af-47d5-90d7-a19c9f1bdeb1"],

Cell[BoxData[{
 RowBox[{"obj", " ", "=", " ", 
  RowBox[{"Append", "[", 
   RowBox[{"obj", ",", " ", 
    RowBox[{"\"\<Name\>\"", "\[Rule]", " ", "\"\<Example\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"obj", "[", "\"\<Properties\>\"", "]"}]}], "Input",
 CellLabel->
  "In[213]:=",ExpressionUUID->"ed2efe4d-31b0-4c57-9f4f-22709228e942"],

Cell["\<\
To see what possible inputs there are for defining your problem, evaluate:\
\>", "Text",ExpressionUUID->"7ceccd37-8804-46d2-aa8a-15d95a9bbbc8"],

Cell[BoxData[
 RowBox[{"defineInferenceProblem", "[", "]"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"97ccfc1b-d4e2-4e95-8d8d-ec1689c8fe9c"],

Cell["\<\
To run the nested sampling algorithm, we ultimately need to define the \
following properties:\
\>", "Text",ExpressionUUID->"79403abe-c914-4632-ac0e-c951f7a23119"],

Cell[CellGroupData[{

Cell["\<\
Parameters: A list specifying the parameters that are to be estimated and \
their limits (which are allowed to be infinite)\
\>", "Item",ExpressionUUID->"dedcbaac-08fb-440d-b792-4027247452f6"],

Cell["\<\
LogLikelihoodFunction: a function (preferably compiled) that evaluates the \
loglikelihood at a given point in the parameter space\
\>", "Item",ExpressionUUID->"7efc1576-57dc-4682-90c3-ea03125e110e"],

Cell["\<\
LogPriorPDFFunction: The logPDF function (preferably compiled) of the prior \
distribution (does not need to be normalised, but the computed evidence \
depends on its normalisation constant)\
\>", "Item",ExpressionUUID->"15133744-1b1f-4243-bf81-39dde16d063c"],

Cell["\<\
StartingPoints: A set of samples from the prior to use as a starting point\
\>", "Item",ExpressionUUID->"0cc6ffc5-a45a-4f5b-8cf3-0f0af5457e1e"]
}, Open  ]],

Cell["\<\
The role of defineInferenceProblem is to construct these properties from the \
properties supplied by the user. However, the you can forego the use of \
defineInferenceProblem by simply creating an association with the 4 required \
items and wrapping inferenceObject around it.\
\>", "Text",ExpressionUUID->"2578b9b2-508a-44a5-b9d5-a8478630ed22"],

Cell[TextData[{
 "The convention that is used throughout this package, is that the ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "fe7357b8-dd27-4c63-9566-f76f793669ad"],
 " estimation parameters from an vector in ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "1878f550-b5e8-4bc6-948b-f3d82df18183"],
 "D space. For example, if the loglikelihood function is a function of 2 \
parameters, it should be of the form:"
}], "Text",ExpressionUUID->"298e3973-90b4-4529-99cc-49a8f76d6537"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"logLikelihood", "[", "paramVector_List", "]"}], ":=", " ", 
   RowBox[{"numericFunctionOf", "[", 
    RowBox[{
     RowBox[{"paramVector", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"paramVector", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"c63d85dc-a2d5-4209-9209-239524ab9c44"],

Cell[BoxData["$MachineLogZero"], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"abfea12f-767a-4206-963b-247dd18fc1e9"],

Cell[TextData[{
 "Furthermore, the code works best if we stay within the realm of machine \
numbers. However, since the log of zero cannot be represented in machine \
numbers, the package uses a value called ",
 StyleBox["$MachineLogZero",
  FontWeight->"Bold"],
 " instead:"
}], "Text",ExpressionUUID->"a22373cc-f058-4f76-82b5-12e0599b268c"],

Cell[BoxData["$MachineLogZero"], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"1e065af1-1a03-447e-8db1-714257167fc6"],

Cell["\<\
This value should be returned whenever the point in parameter space is \
outside of the support of the prior or loglikelihood. If you use \
defineInferenceProblem to create the loglikelihood and logprior PDF, this is \
handled automatically:\
\>", "Text",ExpressionUUID->"571b30ca-5609-4682-ae0e-d2ce69f3e8d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"-", "1"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obj", "[", "\"\<LogLikelihoodFunction\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"-", "1"}]}], "}"}], "]"}]}], "Input",
 CellLabel->
  "In[221]:=",ExpressionUUID->"3bc9806e-4e55-4877-be73-33e722b5db3c"],

Cell[CellGroupData[{

Cell["Known issues:", \
"Subsubsection",ExpressionUUID->"0729daee-49c4-4576-8f19-0a1bafc498cd"],

Cell["\<\
Please note that if you specify an explicit PriorDistribution, the limits \
specified by the parameters will cut off the prior without adjusting the \
normalisation constant of the prior PDF:\
\>", "Text",ExpressionUUID->"299b2284-7d50-4983-9afd-e25b994ae4d2"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"obj", "=", 
       RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", "100"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"mu", ",", " ", "sigma"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mu", ",", 
              RowBox[{"-", "lim"}], ",", "lim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sigma", ",", "0", ",", "lim"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
          RowBox[{"ProductDistribution", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "100"}], "]"}], ",", 
            RowBox[{"ExponentialDistribution", "[", 
             RowBox[{"1", "/", "100"}], "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Exp", "@", 
         RowBox[{
          RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"lim", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Infinity]", ",", "10"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[259]:=",ExpressionUUID->"f3198af2-e07d-4a59-83d2-d6241dab0731"],

Cell["\<\
When specifying the prior distribution as a list of distributions (in which \
case defineInferenceProblem will construct a ProductDistribution for you), \
the normalisation will be restored:\
\>", "Text",ExpressionUUID->"fd3663d4-f4e7-461a-9b0d-2c61859f0e61"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"obj", "=", 
       RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", "100"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"mu", ",", " ", "sigma"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mu", ",", 
              RowBox[{"-", "lim"}], ",", "lim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sigma", ",", "0", ",", "lim"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "100"}], "]"}], ",", 
            RowBox[{"ExponentialDistribution", "[", 
             RowBox[{"1", "/", "100"}], "]"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Exp", "@", 
         RowBox[{
          RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"lim", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Infinity]", ",", "10"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[261]:=",ExpressionUUID->"51c650e7-5220-49ba-b915-269eca8a7773"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General nested sampling problems", \
"Subsection",ExpressionUUID->"9c6d33f5-ad36-4bd4-aeec-91b49adb4607"],

Cell[CellGroupData[{

Cell["Fitting a Cauchy distribution", \
"Subsubsection",ExpressionUUID->"d999f0a5-3322-4d46-9a9d-41c72825f113"],

Cell["\<\
As a simple example, here is how you inference the parameters of a Cauchy \
distribution from some data. \
\>", "Text",ExpressionUUID->"525d5a1b-6599-4f60-a750-615a05128698"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"CauchyDistribution", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "25"}], "]"}]}], ";"}], "\n", 
 RowBox[{"obj", " ", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"CauchyDistribution", "[", 
      RowBox[{"a", ",", " ", "b"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "0.01", ",", "100"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\""}], 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<OriginalDistribution\>\"", " ", "\[Rule]", " ", "dist"}]}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "an", " ", "optional", " ", "property", " ", 
     "that", " ", "we", " ", "attach", " ", "for", " ", "convenience"}], " ", 
    "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"89f371e4-4212-4849-8da4-bc154bf5086d"],

Cell["\<\
Note that the data has been transformed from a vector to a matrix as part of \
the standardisation process:\
\>", "Text",ExpressionUUID->"5d78d050-d9dc-499a-830a-46e8f3aafa1a"],

Cell[BoxData[{"testdata", "\[IndentingNewLine]", 
 RowBox[{"obj", "[", "\"\<Data\>\"", "]"}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"224b884a-511e-4a16-bf38-b70655db05e8"],

Cell["Run the algorithm with various options:", \
"Text",ExpressionUUID->"9c4464e2-9891-4e02-9d77-058970dec72a"],

Cell[CellGroupData[{

Cell["\<\
\[OpenCurlyDoubleQuote]MonteCarloSteps\[CloseCurlyDoubleQuote] determines how \
many MCMC steps to take to generate each new sample.\
\>", "Item",ExpressionUUID->"f6f25b18-9a75-484c-a926-863c57922e19"],

Cell["\<\
\"MinMaxAcceptanceRate\" determines the limits of the MCMC acceptance rate \
before the algorithm accepts a new sample. By default, no limits are imposed \
on the acceptance rate.\
\>", "Item",ExpressionUUID->"c8bc7da0-97aa-45a8-94d7-e409c07599c5"],

Cell["\<\
\"TerminationFraction\" determines how long the algorithm iterates before \
convergence is reached.\
\>", "Item",ExpressionUUID->"fc329690-1965-4b30-b23d-0dfe742e0b84"],

Cell["\<\
\[OpenCurlyDoubleQuote]MaxIterations\[CloseCurlyDoubleQuote] determines the \
maximum number of samples that will be generated.\
\>", "Item",ExpressionUUID->"6d70996d-94ab-4800-9bfa-2c408817d8a9"],

Cell["\<\
\[OpenCurlyDoubleQuote]MinIterations\[CloseCurlyDoubleQuote] specifies the \
minimum number of nested samples that will be generated. For loglikelihood \
functions that are sharply peaked, it may be necessary to increase this \
option value to make sure the algorithm finds the bulk of the posterior. \
\>", "Item",ExpressionUUID->"77316d2b-644a-4fba-8d49-fe53cae74570"],

Cell["\<\
\[OpenCurlyDoubleQuote]LogLikelihoodMaximum\[CloseCurlyDoubleQuote] allows \
the user to specify the maximum of the loglikelihood function if this is \
already known. Specifying this value will help the algorithm to determine \
when it should terminate.\
\>", "Item",ExpressionUUID->"ac030149-d506-4f53-b031-054ab7fcf768"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"result", " ", "=", 
  RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "100"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MinMaxAcceptanceRate\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.9"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"result", "[", "\"\<LogEvidence\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "[", "\"\<Properties\>\"", "]"}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"51cb9ac9-9a78-449e-b410-15d3a99a7df9"],

Cell[TextData[{
 "The standard error on the logevidence is obtained by Monte Carlo sampling \
of the ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "440e60b9-c886-4254-af8b-17dbd4ebb325"],
 "-axis values of the integral as described by Skilling in chapter 8 of his \
paper. The \[OpenCurlyDoubleQuote]PostProcessSamplingRuns\
\[CloseCurlyDoubleQuote] option controls how many such Monte Carlo samples \
are used to compute this standard error."
}], "Text",ExpressionUUID->"10d23ac1-6bb4-4ef2-a8c3-2e241dbd0d41"],

Cell[TextData[{
 "To speed up the computation, you can use ",
 StyleBox["parallelNestedSampling",
  FontWeight->"Bold"],
 " to divide the process over multiple kernels. Instead of having 100 living \
points, you can run 4 kernels with each 25 living points each (which each \
converge faster than 1 process with 100 points) for a comparable result:"
}], "Text",ExpressionUUID->"6c8c1185-8eeb-4ed2-80d9-b7f19eeb5501"],

Cell[BoxData[{
 RowBox[{"result", "=", 
  RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "25"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MinMaxAcceptanceRate\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.9"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"result", "[", "\"\<LogEvidence\>\"", "]"}]}], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"a47f8460-0e47-4cea-98c6-be14ffa00e40"],

Cell[TextData[{
 "Use the ",
 StyleBox["calculationReport",
  FontWeight->"Bold"],
 " function to get a quick overview of the result:"
}], "Text",ExpressionUUID->"b36a7a86-55b4-486c-80b8-7078d4f12129"],

Cell[BoxData[
 RowBox[{"calculationReport", "[", "result", "]"}]], "Input",
 CellLabel->
  "In[241]:=",ExpressionUUID->"eca11bcf-67d9-4333-b81f-c825f03583cd"],

Cell[TextData[{
 "Visualise the posterior distribution of the parameters ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "e252e61b-ed14-437e-aad4-042883d30c9b"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "32b510ec-e797-4af2-99a9-1ff625b8c58b"],
 ":"
}], "Text",ExpressionUUID->"cdc731db-c506-4ae3-980f-c094e1fa0c4c"],

Cell[BoxData[{
 RowBox[{"Mean", "[", 
  RowBox[{"result", "[", "\"\<EmpiricalPosteriorDistribution\>\"", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Covariance", "[", 
  RowBox[{"result", "[", "\"\<EmpiricalPosteriorDistribution\>\"", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"covarianceMatrixPlot", "[", "result", "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{"result", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ScalingFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", "\"\<Log\>\"", ",", "None"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PerformanceGoal", "\[Rule]", " ", "\"\<Speed\>\""}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[166]:=",ExpressionUUID->"c8472bdd-c686-473b-8a7a-7a4601c77970"],

Cell[TextData[{
 "Note that the bubble chart above is cluttered up with many samples with \
very small weights. You can use the function ",
 StyleBox["takePosteriorFraction",
  FontWeight->"Bold"],
 " to discard the samples with the smallest weights and retain the most \
important samples. In the example below, 1% of the posterior mass is \
discarded:"
}], "Text",ExpressionUUID->"0c599086-253a-4d81-a9d0-c03bba2b3217"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"truncatedResult", " ", "=", " ", 
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", "\[IndentingNewLine]", 
  RowBox[{"truncatedResult", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ScalingFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", "\"\<Log\>\"", ",", "None"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"5ea9102c-5b40-4d5d-b824-05ccb85bc18e"],

Cell[TextData[{
 "Plot the marginal PDFs of ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "47bba337-f3a4-4c06-8d56-087fcba77dc5"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "4fae5fe1-6ef6-4767-9b99-dcac6868dde7"],
 ":"
}], "Text",ExpressionUUID->"d534d4d8-9d1d-446f-9d9a-ed0c8ed8214d"],

Cell[BoxData[{
 RowBox[{"posteriorMarginalPDFPlot1D", "[", 
  RowBox[{"truncatedResult", ",", "a", ",", 
   RowBox[{"ScalingFunctions", "->", "\"\<Log\>\""}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}], ",", "All"}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorMarginalPDFPlot1D", "[", 
  RowBox[{"truncatedResult", ",", "b", ",", 
   RowBox[{"ScalingFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.01", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}], ",", "All"}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->
  "In[208]:=",ExpressionUUID->"48ab6113-e03d-46c6-b731-a97647066684"],

Cell["\<\
Compare the original distribution that generated the data with the Bayesian \
predictive distribution:\
\>", "Text",ExpressionUUID->"d1e714d7-a5a4-4948-bb3c-2eed94ddd266"],

Cell[BoxData[
 RowBox[{"LogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", "truncatedResult", "]"}], ",", 
        "x"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", 
         RowBox[{"truncatedResult", ",", "\"\<MaximumLikelihood\>\""}], "]"}],
         ",", " ", "x"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", 
         RowBox[{"truncatedResult", ",", "\"\<MAP\>\""}], "]"}], ",", " ", 
        "x"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"result", "[", "\"\<OriginalDistribution\>\"", "]"}], ",", 
        "x"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Posterior predictive PDF\>\"", ",", " ", 
      "\"\<PDF based on maximum likelihood estimate\>\"", ",", 
      "\"\<PDF based on maximum posterior (MAP) estimate\>\"", ",", " ", 
      "\"\<PDF of original distribution\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"7cf996e1-36e2-4b55-878a-616faeff539e"],

Cell["\<\
Compute the evidence of a competing model to see if it offers a better \
explanation of the data. In this case the evidence is significantly lower for \
model 2, so the Cauchy distribution explains the data better than a normal \
distribution:\
\>", "Text",ExpressionUUID->"4b312315-a2f6-44eb-928a-02983d3d8e6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obj2", " ", "=", 
   RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"a", ",", " ", "b"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "0.01", ",", "100"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\""}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{"result2", " ", "=", 
  RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj2", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"result2", "[", "\"\<LogEvidence\>\"", "]"}]}], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"2375529a-b224-4e04-8f0b-6cfce3e8ab9a"],

Cell[BoxData[
 RowBox[{"LogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", "result", "]"}], ",", "x"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", "result2", "]"}], ",", "x"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"result", "[", "\"\<OriginalDistribution\>\"", "]"}], ",", 
        "x"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Posterior predictive PDF model 1\>\"", ",", " ", 
      "\"\<Posterior predictive PDF model 2\>\"", ",", " ", 
      "\"\<PDF of original distribution\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"97f91a6a-ea1c-4c7f-9959-e4123be4dd17"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MCMC", \
"Subsubsection",ExpressionUUID->"6df0983c-1b1b-440c-a4c4-51b695ade390"],

Cell[TextData[{
 "You can also sample the posterior directly. First create a \
MarkovChainObject for this problem with ",
 StyleBox["createMCMCChain",
  FontWeight->"Bold"],
 ":"
}], "Text",ExpressionUUID->"24a082b4-e90d-4cdb-8922-95838712bba9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"CauchyDistribution", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "25"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"obj", " ", "=", 
   RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
      RowBox[{"CauchyDistribution", "[", 
       RowBox[{"a", ",", " ", "b"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "0.01", ",", "100"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\""}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<OriginalDistribution\>\"", " ", "\[Rule]", " ", "dist"}]}], 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "This", " ", "is", " ", "an", " ", "optional", " ", "property", " ", 
      "that", " ", "we", " ", "attach", " ", "for", " ", "convenience"}], " ",
      "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"chain", " ", "=", 
  RowBox[{"createMCMCChain", "[", 
   RowBox[{"obj", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{"starting", " ", "point"}], "*)"}], "]"}]}]}], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"c03cda6e-aab6-4f26-85db-e64f054d65ee"],

Cell["\<\
This function also accepts logPDF functions directly. Use compiled functions \
for the best performance:\
\>", "Text",ExpressionUUID->"678c55f5-37b9-4f0b-86a2-b780be6284ab"],

Cell[BoxData[
 RowBox[{"chain", "=", 
  RowBox[{"createMCMCChain", "[", 
   RowBox[{
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"pt", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
      RowBox[{"-", " ", 
       RowBox[{"pt", ".", " ", "pt"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"b3d93961-d5b6-494b-9730-45ac35e8bfff"],

Cell["\<\
The MCMC sampler uses an adaptive algorithm that tries to learn the \
covariance of the distribution. Use the options of createMCMCChain to \
influence this behaviour:\
\>", "Text",ExpressionUUID->"30a92aa7-4b1d-4ddd-91f2-d79bdd62eea1"],

Cell[BoxData[
 RowBox[{"Options", "[", "createMCMCChain", "]"}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"c2cbac19-e555-4e00-a2b2-24fb2aa3d0f9"],

Cell[TextData[{
 "Use ",
 StyleBox["iterateMCMC",
  FontWeight->"Bold"],
 " to sample the distribution. Note that this function changes the state of \
the chain:"
}], "Text",ExpressionUUID->"0db6235f-8c03-4840-a8a5-17e66708441c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"iterateMCMC", "[", 
    RowBox[{"chain", ",", "10000"}], "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Burn", " ", "it", " ", "in", " ", "first"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"samples", "=", 
   RowBox[{"iterateMCMC", "[", 
    RowBox[{"chain", ",", "1000"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"1786c3e3-853e-469c-9b62-b3fc5eb40963"],

Cell[BoxData[{
 RowBox[{"Mean", "[", "samples", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Covariance", "[", "samples", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SmoothDensityHistogram", "[", "samples", "]"}]}], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"00ce2e35-e314-41b4-8752-909a7ab05a94"],

Cell["\<\
The MCMC methods are implemented in the Statistics`MCMC` context, which \
should be available in Mathematica 11.3. \
\>", "Text",ExpressionUUID->"6d55541d-5b34-40b7-abae-bbda629dbfe0"],

Cell[TextData[{
 "View the methods available for ",
 StyleBox["Statistics`MCMC`BuildMarkovChain",
  FontWeight->"Bold"],
 ":"
}], "Text",ExpressionUUID->"9314c488-ac0c-4d85-aa01-826f3d49210b"],

Cell[BoxData[
 RowBox[{"Statistics`MCMC`MCMCData", "[", "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"963b3c26-6257-4333-bcd6-729d8890b084"],

Cell[TextData[{
 "This package uses the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"\"\<AdaptiveMetropolis\>\"", ",", "\"\<Log\>\""}], "}"}], 
   TraditionalForm]],ExpressionUUID->"a0555bb2-8794-47a8-800d-c6733c5f0501"],
 " method. Here\[CloseCurlyQuote]s how you view more detailed information \
about this method:"
}], "Text",ExpressionUUID->"7820ab27-db86-488c-9328-45ca405c0c04"],

Cell[BoxData[{
 RowBox[{"Statistics`MCMC`MCMCData", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<AdaptiveMetropolis\>\"", ",", "\"\<Log\>\""}], "}"}], ",", 
   "\"\<Usage\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Statistics`MCMC`MCMCData", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<AdaptiveMetropolis\>\"", ",", "\"\<Log\>\""}], "}"}], ",", 
   "\"\<Example\>\""}], "]"}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"3e742700-3633-46fe-9495-205d6d728fe8"],

Cell[TextData[{
 "Iteration of the Markov chain is done with ",
 StyleBox["Statistics`MCMC`MarkovChainIterate",
  FontWeight->"Bold"],
 ". It uses the following syntax:"
}], "Text",ExpressionUUID->"0fcf1a18-3c0c-4c5f-9060-4275e705bae3"],

Cell[BoxData[{
 RowBox[{"Statistics`MCMC`MarkovChainIterate", "[", 
  RowBox[{"MCobj", ",", 
   RowBox[{"num", " ", "of", " ", "samples"}]}], "]"}], "\n", 
 RowBox[{"Statistics`MCMC`MarkovChainIterate", "[", 
  RowBox[{"MCobj", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"num", " ", "of", " ", "samples"}], ",", " ", 
     RowBox[{
     "number", " ", "of", " ", "iterations", " ", "between", " ", "each", " ",
       "sample"}]}], "}"}]}], 
  "]"}]}], "Input",ExpressionUUID->"d8edc38a-393e-45f4-bb18-c9d7bf5709e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fitting Normal data with a SkewNormal distribution", \
"Subsubsection",ExpressionUUID->"016c2ace-24ef-40c8-bc76-9fa490bc7769"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "50"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"<|", "|>"}]}], ";"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"38adc9dc-eac0-479c-a54d-6998a43e56c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"SkewNormalDistribution", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "20"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"<|", "|>"}]}], ";"}]}], "Input",
 CellLabel->
  "In[274]:=",ExpressionUUID->"05405bfa-ea1b-4ef9-954c-3eed34b6cc52"],

Cell[BoxData[
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"SkewNormalDistribution", "[", 
         RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", "x"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->
  "In[127]:=",ExpressionUUID->"73c88b0a-8a29-44a0-a23f-749ae325f129"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "[", "\"\<Normal\>\"", "]"}], " ", "=", " ", 
  RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"a", ",", " ", "b"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "0.1", ",", "10"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\""}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<OriginalDistribution\>\"", " ", "\[Rule]", " ", "dist"}]}],
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "100"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "3000"}]}], 
   "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"d2028e80-3d63-4c29-8f38-87b677d35f29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], " ", "=", " ", 
  RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
       RowBox[{"SkewNormalDistribution", "[", 
        RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "0.1", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\"", ",", 
         " ", "\"\<LocationParameter\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<OriginalDistribution\>\"", " ", "\[Rule]", " ", "dist"}]}],
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "100"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "3000"}]}], 
   "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"b622be28-9d7d-492b-a5d5-2abcbde9e3af"],

Cell[BoxData[{
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{
     RowBox[{"result", "[", "\"\<Normal\>\"", "]"}], ",", "0.99"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{
     RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], ",", "0.99"}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{
     RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], ",", "0.99"}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"f1c4d1a3-c23d-4a42-a171-307b2577dd7d"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"testdata", ",", 
     RowBox[{"{", "0.1", "}"}], ",", "\"\<PDF\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PDF", "[", 
         RowBox[{
          RowBox[{"predictiveDistribution", "[", 
           RowBox[{"takePosteriorFraction", "[", 
            RowBox[{
             RowBox[{"result", "[", "\"\<Normal\>\"", "]"}], ",", "0.99"}], 
            "]"}], "]"}], ",", "x"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PDF", "[", 
         RowBox[{
          RowBox[{"predictiveDistribution", "[", 
           RowBox[{"takePosteriorFraction", "[", 
            RowBox[{
             RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], ",", 
             "0.99"}], "]"}], "]"}], ",", "x"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[126]:=",ExpressionUUID->"cb413159-1ef0-4b82-bad8-056199db4cb0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Regression", \
"Subsubsection",ExpressionUUID->"005ca54c-da34-48e2-8493-06b12e6078d3"],

Cell["\<\
Regression problems can be specified as well. First define some test data:\
\>", "Text",ExpressionUUID->"210f6c26-ff10-449b-a992-93605abe9f4e"],

Cell[BoxData[{
 RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SeedRandom", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"testdata", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{"#", "+", 
          RowBox[{"2", " ", 
           RowBox[{"RandomReal", "[", "]"}]}]}], ")"}]}], ")"}], "&"}], "/@", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "20"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"List", "@@@", "testdata"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "testdata"}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"eda63068-e7af-4003-bbc7-9d06cd13dced"],

Cell[TextData[{
 "Note that the data is specified as a list of rules or as a rule of lists (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in1", ",", " ", "in2", ",", " ", "..."}], "}"}], "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"out1", ",", " ", "out2", ",", " ", "..."}], "}"}]}], 
   TraditionalForm]],ExpressionUUID->"94b86c88-6243-4c65-9bd3-3e42dcf98f75"],
 ") just like in ",
 Cell[BoxData[
  TemplateBox[{
   StyleBox["\"Predict\"", "Text", Bold, StripOnInput -> False],
    "paclet:/ref/Predict"},
   "HyperlinkPaclet"]],ExpressionUUID->"bb40589d-ada4-4fb8-83d1-df5a5cb48876"],
 ". "
}], "Text",ExpressionUUID->"0bdd4ac7-ff0f-418c-87bb-4266a50cf842"],

Cell["\<\
The model is specified as a distribution that depends on an independent \
variable (note the standardisation of the data):\
\>", "Text",ExpressionUUID->"36901d8a-3775-4fb5-8a8e-528b395d42a4"],

Cell[BoxData[{
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"NormalDistribution", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ",", 
       "\[IndentingNewLine]", "sigma"}], "\[IndentingNewLine]", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sigma", ",", "0.1", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
     RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<LocationParameter\>\"", ",", "\"\<LocationParameter\>\"", ",", 
       " ", "\"\<ScaleParameter\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"obj", "[", "\"\<Data\>\"", "]"}]}], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"0bece909-f8bd-4067-914d-743675c6bff2"],

Cell[TextData[{
 "The functions ",
 StyleBox["predictiveDistribution",
  FontWeight->"Bold"],
 " and ",
 StyleBox["regressionPlot1D",
  FontWeight->"Bold"],
 " are useful helper functions to visualise the results:"
}], "Text",ExpressionUUID->"ab55195f-f51b-4a91-8906-e1197ad6bbbb"],

Cell[BoxData[{
 RowBox[{"result", "=", 
  RowBox[{"nestedSampling", "[", "obj", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"predictions", "=", 
   RowBox[{"predictiveDistribution", "[", 
    RowBox[{
     RowBox[{"takePosteriorFraction", "[", 
      RowBox[{"result", ",", "0.99"}], "]"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2", ",", "0.1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"regressionPlot1D", "[", 
  RowBox[{"result", ",", "predictions"}], "]"}]}], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"d7c9dbb4-5f69-48f3-8a47-1d1c6af3ff80"],

Cell["\<\
You can visualise the different lines that are used in this result:\
\>", "Text",ExpressionUUID->"d4a4caf1-3ef6-48a0-8630-7c67f5267bd4"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"result", " ", "=", " ", 
     RowBox[{"takePosteriorFraction", "[", 
      RowBox[{"result", ",", "0.99"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", " ", "=", " ", 
        RowBox[{"Values", "@", 
         RowBox[{"result", "[", 
          RowBox[{
          "\"\<Samples\>\"", ",", " ", "All", ",", " ", "\"\<Point\>\""}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"weights", " ", "=", " ", 
        RowBox[{"Values", "@", 
         RowBox[{"Quiet", "@", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "-", 
              RowBox[{"Max", "[", "#", "]"}]}], "&"}], "@", 
            RowBox[{"result", "[", 
             RowBox[{
             "\"\<Samples\>\"", ",", " ", "All", ",", " ", 
              "\"\<LogPosteriorWeight\>\"", ",", "\"\<Mean\>\""}], "]"}]}], 
           "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"model", " ", "=", 
        RowBox[{"expressionToFunction", "[", 
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"\"\<GeneratingDistribution\>\"", ",", " ", "1"}], "]"}], 
          ",", 
          RowBox[{"result", "[", "\"\<ParameterSymbols\>\"", "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", " ", "@", " ", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"model", "[", "#1", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", 
                RowBox[{"Opacity", "[", "#2", "]"}]}], "]"}]}]}], "]"}], 
           "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"points", ",", "weights"}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"List", "@@", 
           RowBox[{"(", 
            RowBox[{"Flatten", "/@", 
             RowBox[{"result", "[", "\"\<Data\>\"", "]"}]}], ")"}]}], "]"}], 
         ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"e90d9225-d094-4f01-8a3d-3f19cf209db4"],

Cell["Compare 3 polynomial models of increasing order:", \
"Text",ExpressionUUID->"0bee3961-019b-413b-a42c-5880deccbcd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"variables", "[", "order_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sequence", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<c\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "order"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"s0", ",", "0.01", ",", "100"}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", "\[IndentingNewLine]", 
  RowBox[{"Association", "@", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"order", "->", " ", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"obj", "=", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"vars", " ", "=", " ", 
              RowBox[{"variables", "[", "order", "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
               RowBox[{"NormalDistribution", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vars", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}], ",", " ", "1"}], "]"}], "]"}], " ", 
                  ".", " ", 
                  RowBox[{"x", "^", 
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "order"}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<Parameters\>\"", "\[Rule]", "vars"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
               RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"\"\<LocationParameter\>\"", ",", 
                   RowBox[{"order", "+", "1"}]}], "]"}], ",", " ", 
                 "\"\<ScaleParameter\>\""}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
         RowBox[{"obj", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "25"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "3000"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"order", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
    "]"}]}]}]}], \
"Input",ExpressionUUID->"73cf2cba-512c-4d18-849a-9b6f2a7c28ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"regressionPlot1D", "[", 
    RowBox[{"#", ",", 
     RowBox[{"predictiveDistribution", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2", ",", "0.1"}], "]"}]}], "]"}]}], "]"}], 
   "&"}], "/@", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"takePosteriorFraction", "[", 
      RowBox[{"#", ",", "0.99"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
    "result"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[178]:=",ExpressionUUID->"094fb4a8-d123-4687-a48b-7234c6a1c4ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["Classification using logistic regression", \
"Subsubsection",ExpressionUUID->"ac22ddcf-98bb-4da9-82e5-29d2481ef699"],

Cell[TextData[{
 "The following example data comes from the ",
 Cell[BoxData[
  TemplateBox[{
   StyleBox["\"Wikipedia article on logistic regression\"", "Text", 
     StripOnInput -> False],
    "https://en.wikipedia.org/wiki/Logistic_regression#Probability_of_passing_\
an_exam_versus_hours_of_study"},
   "HyperlinkURL"]],ExpressionUUID->"3c3b88c2-45e8-4acf-8453-0908df4ef923"],
 ":"
}], "Text",ExpressionUUID->"8c606cf4-c3c2-425d-9915-bbeffe6d4990"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"classificationData", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.5", ",", " ", "0.75", ",", " ", "1", ",", " ", "1.25", ",", " ", 
      "1.5", ",", " ", "1.75", ",", " ", "1.75", ",", " ", "2", ",", " ", 
      "2.25", ",", " ", "2.5", ",", " ", "2.75", ",", " ", "3", ",", " ", 
      "3.25", ",", " ", "3.5", ",", " ", "4", ",", " ", "4.25", ",", " ", 
      "4.5", ",", " ", "4.75", ",", " ", "5", ",", " ", "5.5"}], "}"}], " ", 
    "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
      " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", "1", ",", " ", "0", 
      ",", " ", "1", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", 
      "1", ",", " ", "1", ",", " ", "1", ",", " ", "1", ",", " ", "1", ",", 
      " ", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"List", "@@", "classificationData"}], "]"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Data + fit from Wikipedia\>\""}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "+", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1.5046", " ", "t"}], "-", "4.0777"}], ")"}]}], "]"}]}]], 
     ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "6"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"c80e7c48-2a33-4ca8-8579-b93a4b22b8b9"],

Cell["\<\
The model can be defined by putting a logistic sigmoid inside of a  \
BernoulliDistribution:\
\>", "Text",ExpressionUUID->"bc37140c-e72e-4f34-83e9-220b9f605ea8"],

Cell[BoxData[
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "classificationData"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"BernoulliDistribution", "[", 
      RowBox[{"LogisticSigmoid", "[", 
       RowBox[{
        RowBox[{"a", " ", "t"}], " ", "+", " ", "b"}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}]}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
     RowBox[{"{", "t", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "50"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "50"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"6459ff03-11f9-4fb3-944d-805df792bd71"],

Cell[TextData[{
 "Note the strong negative correlation between ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "c02c783f-11f5-4979-921e-5871ec47cb19"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "a864b4eb-1e88-48ac-9e37-c7b8ea0fe574"],
 " in the posterior distribution:"
}], "Text",ExpressionUUID->"f027b807-daf4-4760-b58f-17698adf1f34"],

Cell[BoxData[{
 RowBox[{"result", " ", "=", " ", 
  RowBox[{"nestedSampling", "[", 
   RowBox[{"obj", ",", 
    RowBox[{"\"\<MinMaxAcceptanceRate\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.05", ",", "0.95"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"covarianceMatrixPlot", "[", "result", "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"e6908fe6-a985-4b86-bb2d-665582340f10"],

Cell[TextData[{
 "To plot the regression probabilities, we need to pull the ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "787b6bdb-befa-4296-b59f-f4582b758176"],
 " values out of the Bernoulli distributions that are combined in the \
predictions:"
}], "Text",ExpressionUUID->"e9954343-51e2-46ce-98c1-2e4126d1c94d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"predictions", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"EmpiricalDistribution", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"predictiveDistribution", "[", 
     RowBox[{
      RowBox[{"takePosteriorFraction", "[", 
       RowBox[{"result", ",", "0.99"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "6", ",", "0.25"}], "]"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"11c08d5b-373e-4092-81e6-773eef224a81"],

Cell["\<\
Plot the spread in the classification probabilities and compare with the \
maximum likelihood estimate:\
\>", "Text",ExpressionUUID->"6abcc83e-fd98-4843-9aa9-6287f115baf9"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"regressionPlot1D", "[", 
    RowBox[{"result", ",", "predictions"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"First", "/@", 
      RowBox[{"predictiveDistribution", "[", 
       RowBox[{"result", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "6", ",", "0.25"}], "]"}], ",", " ", 
        "\"\<MaximumLikelihood\>\""}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"bc0e54bd-2323-434a-b0b5-232386fef056"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Logistic classification with multi dimensional input and multiple classes\
\>", "Subsubsection",ExpressionUUID->"4310b3b0-fd31-4d00-808c-36e1c98af187"],

Cell["\<\
Load the Fisher iris  example dataset and put it in a more usable form:\
\>", "Text",ExpressionUUID->"0de519a0-2239-471b-a64b-9d29608e2979"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"dat", "  ", "=", 
      RowBox[{"ExampleData", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<FisherIris\>\""}], 
         "}"}], ",", "\"\<Data\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"classes", "=", 
      RowBox[{"Union", "@", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nclasses", "=", 
      RowBox[{"Length", "[", "classes", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{"NetEncoder", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<Class\>\"", ",", "classes"}], "}"}], "]"}], ",", "dat",
         ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nInputFeatures", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"367bec5b-76de-4b37-878c-8192777187c6"],

Cell["Normalise the input features:", \
"Text",ExpressionUUID->"ebc1c94c-e438-416c-9dbd-30f9b029a040"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"normalInputData", "=", 
   RowBox[{"normalizeData", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"normalInputData", "[", "\"\<NormalizedData\>\"", "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"cf8d7871-74f7-4660-9224-278062d09a98"],

Cell["\<\
The first thing to do, is to define a higher dimensional version of the \
BernoulliDistribution. We can do this with ProbabilityDistribution:\
\>", "Text",ExpressionUUID->"ce1046b2-16a1-470c-9679-a4ec3ce7d63a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "dist", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dist", "[", "pvector_List", "]"}], ":=", 
   RowBox[{"ProbabilityDistribution", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Total", " ", "@", " ", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"class", "\[Equal]", 
            RowBox[{"First", "[", "#2", "]"}]}], "]"}]}], "&"}], ",", 
        "pvector"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"class", ",", "1", ",", 
       RowBox[{"Length", "[", "pvector", "]"}], ",", "1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"82166071-81e9-4d88-9e7b-f88219d6d023"],

Cell[TextData[{
 "To map the 4 input features onto a probability vector of length 3, we first \
define a parameterised ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "4"}], TraditionalForm]],ExpressionUUID->
  "3090d54c-f530-4dde-ad38-eb6f8af87c80"],
 " matrix and a length-2 bias vector:"
}], "Text",ExpressionUUID->"a3840cad-60d4-4f85-a944-845810be4b38"],

Cell[BoxData[{
 RowBox[{"matrix", "=", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"ToString", "@", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<a`1``2`\>\"", ",", "#1", ",", "#2"}], "]"}]}], "]"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nclasses", "-", "1"}], ",", "nInputFeatures"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"biases", " ", "=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"ToString", "@", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<b`1`\>\"", ",", "#1"}], "]"}]}], "]"}], "&"}], ",", 
    RowBox[{"nclasses", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"inputCoord", " ", "=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"ToString", "@", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<x`1`\>\"", ",", "#1"}], "]"}]}], "]"}], "&"}], ",", 
    "nInputFeatures"}], "]"}]}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"6903f44e-0fb2-4560-b2ec-9f790fbc7859"],

Cell[TextData[{
 "Use a modified softmax operation to turn the 2D regression vector into a 3D \
probability vector (see ",
 Cell[BoxData[
  TemplateBox[{
   StyleBox["\"https://en.wikipedia.org/wiki/Multinomial_logistic_regression#\
As_a_log-linear_model\"", "Text", StripOnInput -> False],
    "https://en.wikipedia.org/wiki/Multinomial_logistic_regression#As_a_log-\
linear_model"},
   "HyperlinkURL"]],ExpressionUUID->"a54dd6e8-5e24-4492-8a8e-dfc48e70acf6"],
 "):"
}], "Text",ExpressionUUID->"bf60edd4-222e-48ec-83d1-cec43e1a95d1"],

Cell[BoxData[
 RowBox[{"model", "=", 
  RowBox[{"dist", "@", 
   RowBox[{"Normalize", "[", 
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"matrix", ".", "inputCoord"}], "+", "biases"}], "]"}], ",", 
       "1"}], "]"}], ",", "Total"}], "]"}]}]}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"4aabf11a-e9a5-4f8f-8df5-3fec07f2a3d5"],

Cell["\<\
Combine everything to define the inference problem and sample it:\
\>", "Text",ExpressionUUID->"14184c9a-5b58-404a-b178-889b87afb594"],

Cell[BoxData[
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "data"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", "\[Rule]", "model"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", " ", "\[Rule]", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sym", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sym", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"matrix", ",", "biases"}], "}"}], "]"}]}], "}"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"sym", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"matrix", ",", "biases"}], "}"}], "]"}]}], "}"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", "inputCoord"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"acf793f5-e047-415a-b3ed-5c1070fc9e07"],

Cell[BoxData[
 RowBox[{"result", "=", 
  RowBox[{"parallelNestedSampling", "[", "obj", "]"}]}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"7f13cc42-0dc3-4b28-8ba9-926f253b4e11"],

Cell["Generate the predicted probability vectors:", \
"Text",ExpressionUUID->"b5048ba9-88e8-4c66-b6a6-c7c9ae730cea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "distToProbabilityVector", "[", "dist_ProbabilityDistribution", "]"}], ":=", 
  RowBox[{"PDF", "[", 
   RowBox[{"dist", ",", 
    RowBox[{"Range", "@@", 
     RowBox[{"Rest", "[", 
      RowBox[{"dist", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"predictions", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"EmpiricalDistribution", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
       RowBox[{"distToProbabilityVector", "/@", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"predictiveDistribution", "[", 
     RowBox[{
      RowBox[{"takePosteriorFraction", "[", 
       RowBox[{"result", ",", "0.99"}], "]"}], ",", 
      RowBox[{"result", "[", 
       RowBox[{"\"\<Data\>\"", ",", "1"}], "]"}]}], "]"}]}]}], 
  ";"}]}], "Input",ExpressionUUID->"1269449d-1f1d-457f-b64e-2fd3e536a86a"],

Cell["\<\
Find out which examples have the greatest spread in classification \
probabilities:\
\>", "Text",ExpressionUUID->"14ca8532-fc82-429d-9d06-654b266f2ef4"],

Cell[BoxData[
 RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"InverseCDF", "[", 
        RowBox[{
         RowBox[{"MarginalDistribution", "[", 
          RowBox[{"#", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.05", ",", "0.5", ",", "0.9"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], "&"}], "/@", "predictions"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "@*", 
        RowBox[{"Apply", "[", "Subtract", "]"}], "@*", "MinMax"}], "/@", 
       "#"}], "]"}]}], "&"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[100]:=",ExpressionUUID->"ea1585c3-5c25-45e7-96b2-51f875050211"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gaussian process regression", \
"Subsubsection",ExpressionUUID->"264c8155-84ba-40b0-93fa-8bb915e32da9"],

Cell["\<\
The package contains helper functions to help construct the loglikelihood \
function of a Gaussian process (GP). This makes it possible to infer the \
model parameters of GPs in a Bayesian way with nested sampling.\
\>", "Text",ExpressionUUID->"279669c9-862f-4f76-aed4-28f7062b83a1"],

Cell["Construct a test dataset:", \
"Text",ExpressionUUID->"c7a41460-86d3-4e0b-a7d5-98b23eb81f25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "10"}], "}"}], ",", "20"}], "]"}]}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"x", "\[Rule]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"0.5", " ", "#"}], "]"}], "+", 
           RowBox[{"0.4", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "#"}], "]"}]}], "+", 
           RowBox[{"0.4", "#"}], "+", "1", "+", 
           RowBox[{"0.3", "*", 
            RowBox[{"RandomVariate", "[", 
             RowBox[{
              RowBox[{"NormalDistribution", "[", "]"}], ",", 
              RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "[", 
         RowBox[{"x", "+", 
          RowBox[{"0.2", "*", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{
             RowBox[{"NormalDistribution", "[", "]"}], ",", 
             RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"testdataPlot", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"List", "@@@", 
     RowBox[{"Thread", "[", "testdata", "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[350]:=",ExpressionUUID->"80d48443-5e1c-4a65-a617-ae2b51124942"],

Cell[TextData[{
 "To illustrate how a Gaussian process works, consider the Manipulate below. \
It uses ",
 StyleBox["predictFromGaussianProcess",
  FontWeight->"Bold"],
 " to create predictions from test data and the specified GP model functions. \
In this package, a GP is defined by 3 functions:"
}], "Text",ExpressionUUID->"d74b2588-b7e7-4618-8e9a-fe71791fd8e4"],

Cell[TextData[{
 "A covariance kernel function that accepts to ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "220bb9e8-8c30-4168-981c-b49bb6743b45"],
 "-values (note that our conventions stipulate that these are always lists, \
even for 1D regression) and produces a real number. A typical covariance \
kernel with tunable parameters is, for example:"
}], "Item",ExpressionUUID->"5e30a4d6-5d98-46fc-b136-9e6696ac23fc"],

Cell[BoxData[
 RowBox[{"kernel", " ", "=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{
     SuperscriptBox["\[Sigma]1", "2"], " ", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"x1", ",", " ", "x2"}], "]"}], "lengthScale"], ")"}], 
        "2"]}], "]"}]}]}], 
   "]"}]}]], "Input",ExpressionUUID->"d28b0bf5-0c60-4061-8335-368885a84516"],

Cell[TextData[{
 "A noise level function (sometimes also called \[OpenCurlyDoubleQuote]nugget\
\[CloseCurlyDoubleQuote]). This is a function from a single ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "ca0cc0d9-c107-4c1d-9a31-89dcdf4c68f2"],
 " value to a positive real number. To model a constant noise level, you \
simply specify a constant function:"
}], "Item",ExpressionUUID->"0ec2d0e2-64ad-4369-b04a-18835e213fd4"],

Cell[BoxData[
 RowBox[{"nugget", " ", "=", " ", 
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", 
    SuperscriptBox["\[Sigma]0", "2"]}], 
   "]"}]}]], "Input",ExpressionUUID->"b30d53f0-20da-468b-b670-f0a372202523"],

Cell[TextData[{
 "However, it\[CloseCurlyQuote]s not necessary to make the nugget constant: \
it can be any function of ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "519b2c18-6c24-4327-96c6-efb11cbddca3"],
 " that is deemed appropriate. The nugget is allowed to be zero, but usually \
the calculations are more numerically stable if there\[CloseCurlyQuote]s at \
least a little bit of noise incorporated into the model."
}], "Text",ExpressionUUID->"fa54513d-aa15-4c2d-85ef-78c140e06b18"],

Cell["\<\
A mean function. Essentially, this is a trend-removing function. Often, this \
function is just a constant, just like the nugget function, such as:\
\>", "Item",ExpressionUUID->"8df6a305-4708-4843-a12d-c7a24b9f2eb1"],

Cell[BoxData[
 RowBox[{"mean", " ", "=", " ", 
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", "\[Mu]"}], 
   "]"}]}]], "Input",ExpressionUUID->"76662d75-5dbb-414c-b23d-dca5fab8a93d"],

Cell[TextData[{
 "Any of these functions can be set to ",
 StyleBox["None",
  FontWeight->"Bold"],
 " in the code, in which case they get replaced by the zero function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "&"}], TraditionalForm]],ExpressionUUID->
  "d650dd3c-b3a3-401c-8323-9f7201504b23"],
 "."
}], "Text",ExpressionUUID->"37e4b6c5-4ee0-4ecd-8707-b045a4204c4a"],

Cell[TextData[{
 "As a small remark about the predictions made from the GP: we chose to \
incorporate the nugget variance into the prediction errors. Sometimes this \
isn\[CloseCurlyQuote]t done when the nugget is assumed to model measurement \
error, in which case the predictions are assumed to model the true response \
value at a given point ",
 StyleBox["x",
  FontSlant->"Italic"],
 " rather than the measurement result at a given point ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "88f1ac05-09f4-4cef-aa8f-da6fd055b58f"],
 ". In other words, the code in this package will always model the \
measurements. "
}], "Text",ExpressionUUID->"80a50f1d-aa64-47b7-92b4-2e59a8bb20bd"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Quiet", "@", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{"testdataPlot", ",", "\[IndentingNewLine]", 
      RowBox[{"regressionPlot1D", "[", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"predictFromGaussianProcess", "[", "\[IndentingNewLine]", 
         RowBox[{"testdata", ",", "\[IndentingNewLine]", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "10", ",", "0.1"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SuperscriptBox["s1", "2"], " ", 
            RowBox[{"fun", "@", 
             RowBox[{"Abs", "[", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"First", "[", 
                 RowBox[{"#1", "-", "#2"}], "]"}], "d"], ")"}], "]"}]}]}], 
           "&"}], ",", " ", 
          RowBox[{"(*", 
           RowBox[{"covariance", " ", "kernel", " ", "function"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           SuperscriptBox["s0", "2"], "&"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"noise", " ", "function"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"m", "&"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"mean", " ", "function"}], " ", "*)"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
     "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fun", ",", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          SuperscriptBox["#", "2"]}], "]"}], "&"}], ",", "\"\<Type\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SuperscriptBox["#", "2"]}], "]"}], "&"}], "\[Rule]", " ", 
        "\"\<Exp[-\!\(\*SuperscriptBox[\(d\), \(2\)]\)]\>\""}], ",", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "+", 
           SuperscriptBox["#", "2"]}]], "&"}], "\[Rule]", " ", 
        "\"\<\!\(\*FractionBox[\(1\), \(1 + \*SuperscriptBox[\(d\), \(2\)]\)]\
\)\>\""}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "\"\<Length scale\>\""}], "}"}], ",", "0.2",
      ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1", ",", "1", ",", "\"\<Covariance strength\>\""}], "}"}], 
     ",", "0.1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s0", ",", "0.5", ",", "\"\<Noise level\>\""}], "}"}], ",", 
     "0.1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "3", ",", "\"\<Mean\>\""}], "}"}], ",", "0", ",", 
     "5"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[352]:=",ExpressionUUID->"8aca103c-4e6e-4eee-a936-66dbbb668224"],

Cell[TextData[{
 "To perform GP regression, it\[CloseCurlyQuote]s usually a good idea to \
normalise the data first. The function ",
 StyleBox["normalizeData",
  FontWeight->"Bold"],
 " takes care of this and returns not only the normalised data but also the \
function (and inverse function) that was used for the normalisation:"
}], "Text",ExpressionUUID->"c15efe8d-9f7f-4bfc-a14c-fa782c404a77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"normalizeData", "[", "testdata", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"norm", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "\"\<NormalizedData\>\""}], "]"}], "]"}]}], "Input",
 CellLabel->
  "In[353]:=",ExpressionUUID->"dbd56840-4c5a-4f76-b312-8e0928231023"],

Cell["Reconstruct the original inputs:", \
"Text",ExpressionUUID->"95462184-e3c6-4a1c-8959-c7f8ded55dd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"norm", "[", 
   RowBox[{"\"\<Input\>\"", ",", "\"\<InverseFunction\>\""}], "]"}], "@", 
  RowBox[{"norm", "[", 
   RowBox[{"\"\<Input\>\"", ",", "\"\<NormalizedData\>\""}], "]"}]}]], "Input",
 CellLabel->
  "In[355]:=",ExpressionUUID->"14c3470f-5cb7-4576-bc02-2d6c52f6b5b2"],

Cell["Define a GP and perform nested sampling on it:", \
"Text",ExpressionUUID->"a2d8e085-6e62-4d7f-8966-7a5b6f263b7d"],

Cell[BoxData[
 RowBox[{"obj", "=", 
  RowBox[{"defineGaussianProcess", "[", "\[IndentingNewLine]", 
   RowBox[{"norm", ",", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "kernel", " ", "function", " ", "with", " ", "free", " ", 
       "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dsq", "=", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"First", "[", 
             RowBox[{"Subtract", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "l"], ")"}], "2"]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SuperscriptBox["s1", "2"], " ", "*", 
        RowBox[{"Boole", "[", 
         RowBox[{"dsq", "<", 
          SuperscriptBox["6", "2"]}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "dsq"}], "]"}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Use", " ", "a", " ", "truncated", " ", "kernel", " ", "to", " ", 
        "make", " ", "the", " ", "covariance", " ", "matrix", " ", "sparser", 
        " ", "for", " ", "small", " ", "values", " ", "of", " ", "l"}], " ", 
       "*)"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     SuperscriptBox["s0", "2"], "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "nugget", " ", "function", " ", "with", " ", "free", " ", "parameters"}],
      " ", "*)"}], "\[IndentingNewLine]", "None", ",", 
    RowBox[{"(*", " ", 
     RowBox[{
     "mean", " ", "function", " ", "with", " ", "free", " ", "parameters"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s1", ",", "0.05", ",", "20"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0.05", ",", " ", "30"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"s0", ",", "0.05", ",", "20"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"m", ",", " ", 
        RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<ScaleParameter\>\"", ",", " ", "\"\<ScaleParameter\>\"", ",", 
      "\"\<ScaleParameter\>\"", ",", " ", "\"\<LocationParameter\>\""}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<LogLikelihoodFunction\>\"", " ", "\[Rule]", " ", 
     "\"\<Compiled\>\""}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Setting", " ", "this", " ", "to", " ", "Automatic", " ", "will", " ", 
      "use", " ", "the", " ", "build"}], "-", 
     RowBox[{"in", " ", "functionality", " ", "of", " ", 
      RowBox[{"LogLikelihood", ".", " ", "You"}], " ", "can", " ", "also", 
      " ", "specify", " ", "a", " ", "function", " ", "explicitely"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"1aa21abf-8a3e-4e4e-9f6a-1625bab22d65"],

Cell[BoxData[
 RowBox[{"result", "=", 
  RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", " ", "\[Rule]", " ", "25"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "1000"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "10000"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[366]:=",ExpressionUUID->"3232c939-b35d-4150-930a-3d100c4211b3"],

Cell[BoxData[{
 RowBox[{"covarianceMatrixPlot", "[", "result", "]"}], "\n", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"s0", ",", "s1", ",", "l"}], "}"}]}], "]"}]}], "Input",
 CellLabel->
  "In[367]:=",ExpressionUUID->"93091536-6b82-464c-9ddd-e795673cb45c"],

Cell["Visualise the predictions:", \
"Text",ExpressionUUID->"ea5dd347-5301-4b01-a412-c61318e6a009"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"predictions", " ", "=", " ", 
   RowBox[{"predictFromGaussianProcess", "[", 
    RowBox[{
     RowBox[{"takePosteriorFraction", "[", 
      RowBox[{"result", ",", "0.99"}], "]"}], ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "2.5"}], ",", "2.5", ",", "0.2"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"regressionPlot1D", "[", 
  RowBox[{"result", ",", " ", "predictions"}], "]"}]}], "Input",
 CellLabel->
  "In[369]:=",ExpressionUUID->"18f7fd72-b160-4bdb-9712-01cd3a87a018"],

Cell[BoxData[
 RowBox[{"calculationReport", "[", "result", "]"}]], "Input",
 CellLabel->"In[371]:=",ExpressionUUID->"1ad9895f-d50c-4eb6-ab16-e35bc4035b66"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting with time series processes", \
"Subsection",ExpressionUUID->"2f0246ac-afdb-478c-bf4d-e3c48ef44673"],

Cell[CellGroupData[{

Cell["Data preparation", \
"Subsubsection",ExpressionUUID->"8b0280ad-78af-4fe3-951c-de8eb28a2767"],

Cell["Get some timeseries data:", \
"Text",ExpressionUUID->"8b95a3a6-9fba-44ab-a347-2f86ca9bf8d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"FinancialData", "[", 
    RowBox[{"\"\<AS:ASML\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Today", "-", 
        TemplateBox[{"3","\"mo\"","months","\"Months\""},
         "Quantity"]}], ",", "Today"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"DateListPlot", "[", "data", 
  "]"}]}], "Input",ExpressionUUID->"98599f55-defc-452c-803a-46d006653df6"],

Cell["Alternatively, you can use the following pre-cached data:", \
"Text",ExpressionUUID->"d756215f-7f43-4433-8003-450bf9d73c40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"Array",TagBox["List", "IconizedNameLight"],GridBox[{{
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"65", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["12536", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],Dynamic[
       Typeset`open]},
      "IconizedObject"]],
    {{{2018, 9, 18}, 160.26}, {{2018, 9, 19}, 161.04}, {{2018, 9, 20}, 
      161.92}, {{2018, 9, 21}, 161.68}, {{2018, 9, 24}, 162.14}, {{2018, 9, 
      25}, 162.26}, {{2018, 9, 26}, 161.54}, {{2018, 9, 27}, 162.44}, {{2018, 
      9, 28}, 160.9}, {{2018, 10, 1}, 164.9}, {{2018, 10, 2}, 165.72}, {{2018,
       10, 3}, 164.88}, {{2018, 10, 4}, 162.8}, {{2018, 10, 5}, 160.26}, {{
      2018, 10, 8}, 157.74}, {{2018, 10, 9}, 159.12}, {{2018, 10, 10}, 
      150.36}, {{2018, 10, 11}, 150.}, {{2018, 10, 12}, 149.38}, {{2018, 10, 
      15}, 150.18}, {{2018, 10, 16}, 155.}, {{2018, 10, 17}, 160.38}, {{2018, 
      10, 18}, 155.32}, {{2018, 10, 19}, 153.82}, {{2018, 10, 22}, 152.78}, {{
      2018, 10, 23}, 147.86}, {{2018, 10, 24}, 142.46}, {{2018, 10, 25}, 
      147.52}, {{2018, 10, 26}, 145.96}, {{2018, 10, 29}, 145.22}, {{2018, 10,
       30}, 147.74}, {{2018, 10, 31}, 150.92}, {{2018, 11, 1}, 151.96}, {{
      2018, 11, 2}, 152.9}, {{2018, 11, 5}, 150.28}, {{2018, 11, 6}, 
      154.48}, {{2018, 11, 7}, 154.74}, {{2018, 11, 8}, 153.64}, {{2018, 11, 
      9}, 152.22}, {{2018, 11, 12}, 148.9}, {{2018, 11, 13}, 153.16}, {{2018, 
      11, 14}, 153.02}, {{2018, 11, 15}, 152.3}, {{2018, 11, 16}, 147.74}, {{
      2018, 11, 19}, 143.96}, {{2018, 11, 20}, 141.28}, {{2018, 11, 21}, 
      145.3}, {{2018, 11, 22}, 142.74}, {{2018, 11, 23}, 144.5}, {{2018, 11, 
      26}, 146.66}, {{2018, 11, 27}, 148.58}, {{2018, 11, 28}, 149.86}, {{
      2018, 11, 29}, 151.24}, {{2018, 11, 30}, 149.1}, {{2018, 12, 3}, 
      154.04}, {{2018, 12, 4}, 153.16}, {{2018, 12, 5}, 149.32}, {{2018, 12, 
      6}, 143.56}, {{2018, 12, 7}, 141.56}, {{2018, 12, 10}, 140.64}, {{2018, 
      12, 11}, 142.94}, {{2018, 12, 12}, 146.36}, {{2018, 12, 13}, 144.72}, {{
      2018, 12, 14}, 144.08}, {{2018, 12, 17}, 144.48}},
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\n", 
 RowBox[{"DateListPlot", "[", "data", "]"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"0bda4f10-3ba8-4552-bd6d-66ab83e9556a"],

Cell["\<\
Transform the time axis and separate the starting point from the rest:\
\>", "Text",ExpressionUUID->"0a9177e6-89f4-4363-81ef-b2e9610208f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"N", "@", 
    RowBox[{"TimeSeriesRescale", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "-", "1"}]}], "}"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"start", ",", "ts"}], "}"}], " ", "=", " ", 
   RowBox[{"TakeDrop", "[", 
    RowBox[{"data", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", " ", "=", 
   RowBox[{"start", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ts", " ", "=", 
   RowBox[{"TimeSeries", "[", "ts", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"04cb4d59-e2ca-461f-b8cd-032e5c08c094"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplest method: fitting the points independently", \
"Subsubsection",ExpressionUUID->"7d98a901-af68-401a-a6e7-6a76a0b851b7"],

Cell[TextData[{
 "Define the inference problem. Note that this works because ",
 StyleBox["GeometricBrownianMotionProcess",
  FontWeight->"Bold"],
 " evaluates symbolically to a ",
 StyleBox["LogNormalDistribution",
  FontWeight->"Bold"],
 ":"
}], "Text",ExpressionUUID->"0710e344-8102-4209-83df-4ba39210f3b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"process", " ", "=", " ", 
    RowBox[{"GeometricBrownianMotionProcess", "[", 
     RowBox[{"mu", ",", " ", 
      RowBox[{"Exp", "[", "logsigma", "]"}], ",", " ", "start"}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"using", " ", 
    RowBox[{"Exp", "[", "logsigma", "]"}], " ", "makes", " ", "it", " ", 
    "easier", " ", "to", " ", "search", " ", "for", " ", "sigma", " ", 
    "values", " ", "over", " ", "a", " ", "large", " ", "range", " ", "of", 
    " ", "values"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "ts"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"process", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mu", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"logsigma", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}]}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
     RowBox[{"{", "t", "}"}]}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"ebe34a11-9469-4498-adf5-59279e84fbae"],

Cell["\<\
This is a simple way to do it, but the data are now modeled independently of \
each other (they are all modeled as realisations of a lognormal \
distribution). Compare the following:\
\>", "Text",ExpressionUUID->"30708932-1b66-4c86-b1fb-0676f1627921"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mu", "=", "0"}], ",", 
     RowBox[{"logsigma", "=", 
      RowBox[{"-", "4"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "@", 
     RowBox[{
      RowBox[{"obj", "[", "\"\<LogLikelihoodFunction\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"mu", ",", "logsigma"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "@", 
     RowBox[{"LogLikelihood", "[", 
      RowBox[{
       RowBox[{"GeometricBrownianMotionProcess", "[", 
        RowBox[{"mu", ",", " ", 
         RowBox[{"Exp", "[", "logsigma", "]"}], ",", " ", "start"}], "]"}], 
       ",", "ts"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"a5242e2d-8945-4de1-94e0-6d0f5ce6a88b"],

Cell["\<\
In the next section it will be shown how to use the process loglikelihood \
instead.\
\>", "Text",ExpressionUUID->"afe11739-1269-4240-ab2f-e1aee2b4e0f8"],

Cell["Run the sampler:", \
"Text",ExpressionUUID->"fe1859aa-e3b7-42f3-b0d9-b5f991cafad4"],

Cell[BoxData[{
 RowBox[{"result", " ", "=", 
  RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "20"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.001"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mu", ",", "logsigma"}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"e9b8d4e8-ffe0-4ff4-a473-6b1f6f62fe58"],

Cell["\<\
Plot the error bands of the process when you run it from the starting date:\
\>", "Text",ExpressionUUID->"18d6227d-ad2c-4c09-a795-54140841b9bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"predictions", " ", "=", " ", 
   RowBox[{"predictiveDistribution", "[", 
    RowBox[{
     RowBox[{"takePosteriorFraction", "[", 
      RowBox[{"result", ",", "0.95"}], "]"}], ",", 
     RowBox[{"ts", "[", "\"\<Times\>\"", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"plot", "=", 
  RowBox[{"regressionPlot1D", "[", 
   RowBox[{"result", ",", "predictions"}], "]"}]}]}], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"782c4152-0131-4f06-8d27-f55a27d47c5e"],

Cell[BoxData[
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mu", ",", "logsigma"}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"1cdf66ec-b81a-454c-87e4-e8f4b3b315ee"],

Cell["Extrapolate from the last know data point:", \
"Text",ExpressionUUID->"eef90003-a712-42d3-bbad-645466f46ad4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extrapolations", " ", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"lastPoint", " ", "=", " ", 
       RowBox[{"Last", "@", 
        RowBox[{"Normal", "[", "ts", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"predictiveDistribution", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Append", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"takePosteriorFraction", "[", 
          RowBox[{"result", ",", "0.95"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", 
          RowBox[{
           RowBox[{"GeometricBrownianMotionProcess", "[", 
            RowBox[{"mu", ",", " ", 
             RowBox[{"Exp", "[", "logsigma", "]"}], ",", " ", 
             RowBox[{"lastPoint", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"t", " ", "-", " ", 
            RowBox[{"lastPoint", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], " ", 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lastPoint", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"lastPoint", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "20"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\n", 
 RowBox[{"regressionPlot1D", "[", 
  RowBox[{"result", ",", "extrapolations", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"5ee3e7e8-696f-499c-a254-6396784b205b"],

Cell["\<\
It\[CloseCurlyQuote]s instructive to compare these predictions with the \
point-estimate from the best sample found. This gives you a good idea wether \
or not you can approximate the posterior with a point-estimate:\
\>", "Text",ExpressionUUID->"d4906e52-6504-4da6-a000-fd0281460c5d"],

Cell[BoxData[{
 RowBox[{"estproc", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"GeometricBrownianMotionProcess", "[", 
     RowBox[{"#1", ",", " ", 
      RowBox[{"Exp", "[", "#2", "]"}], ",", " ", "start"}], "]"}], "&"}], "@@", 
   RowBox[{
    RowBox[{"First", "[", 
     RowBox[{"TakeLargestBy", "[", 
      RowBox[{
       RowBox[{"result", "[", "\"\<Samples\>\"", "]"}], ",", 
       RowBox[{"#LogLikelihood", "&"}], ",", "1"}], "]"}], "]"}], "[", 
    "\"\<Point\>\"", "]"}]}]}], "\n", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{"plot", ",", "\[IndentingNewLine]", 
   RowBox[{"regressionPlot1D", "[", 
    RowBox[{"result", ",", 
     RowBox[{"AssociationMap", "[", 
      RowBox[{"estproc", ",", 
       RowBox[{"ts", "[", "\"\<Times\>\"", "]"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"7b61917c-483f-49c3-90b3-1bdcf0a3d9b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Sequentially dependent loglikelihood using the built-in functionality of \
LogLikelihood\
\>", "Subsubsection",ExpressionUUID->"eeffe8a0-0540-445d-a90a-7f016a8e0f25"],

Cell[TextData[{
 "Taking the situations in the previous section as an example, it might occur \
that you want to use the built-in ",
 StyleBox["LogLikelihood",
  FontWeight->"Bold"],
 " function directly. This can be achieved with the following code, where we \
use ",
 StyleBox["expressionToFunction",
  FontWeight->"Bold"],
 " to create a function of the right form (one that accepts its arguments as \
a list):"
}], "Text",ExpressionUUID->"bd916e49-3630-4134-8237-ce5771909b4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"Array",TagBox["List", "IconizedNameLight"],GridBox[{{
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"65", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["12536", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],Dynamic[
       Typeset`open]},
      "IconizedObject"]],
    {{{2018, 9, 18}, 160.26}, {{2018, 9, 19}, 161.04}, {{2018, 9, 20}, 
      161.92}, {{2018, 9, 21}, 161.68}, {{2018, 9, 24}, 162.14}, {{2018, 9, 
      25}, 162.26}, {{2018, 9, 26}, 161.54}, {{2018, 9, 27}, 162.44}, {{2018, 
      9, 28}, 160.9}, {{2018, 10, 1}, 164.9}, {{2018, 10, 2}, 165.72}, {{2018,
       10, 3}, 164.88}, {{2018, 10, 4}, 162.8}, {{2018, 10, 5}, 160.26}, {{
      2018, 10, 8}, 157.74}, {{2018, 10, 9}, 159.12}, {{2018, 10, 10}, 
      150.36}, {{2018, 10, 11}, 150.}, {{2018, 10, 12}, 149.38}, {{2018, 10, 
      15}, 150.18}, {{2018, 10, 16}, 155.}, {{2018, 10, 17}, 160.38}, {{2018, 
      10, 18}, 155.32}, {{2018, 10, 19}, 153.82}, {{2018, 10, 22}, 152.78}, {{
      2018, 10, 23}, 147.86}, {{2018, 10, 24}, 142.46}, {{2018, 10, 25}, 
      147.52}, {{2018, 10, 26}, 145.96}, {{2018, 10, 29}, 145.22}, {{2018, 10,
       30}, 147.74}, {{2018, 10, 31}, 150.92}, {{2018, 11, 1}, 151.96}, {{
      2018, 11, 2}, 152.9}, {{2018, 11, 5}, 150.28}, {{2018, 11, 6}, 
      154.48}, {{2018, 11, 7}, 154.74}, {{2018, 11, 8}, 153.64}, {{2018, 11, 
      9}, 152.22}, {{2018, 11, 12}, 148.9}, {{2018, 11, 13}, 153.16}, {{2018, 
      11, 14}, 153.02}, {{2018, 11, 15}, 152.3}, {{2018, 11, 16}, 147.74}, {{
      2018, 11, 19}, 143.96}, {{2018, 11, 20}, 141.28}, {{2018, 11, 21}, 
      145.3}, {{2018, 11, 22}, 142.74}, {{2018, 11, 23}, 144.5}, {{2018, 11, 
      26}, 146.66}, {{2018, 11, 27}, 148.58}, {{2018, 11, 28}, 149.86}, {{
      2018, 11, 29}, 151.24}, {{2018, 11, 30}, 149.1}, {{2018, 12, 3}, 
      154.04}, {{2018, 12, 4}, 153.16}, {{2018, 12, 5}, 149.32}, {{2018, 12, 
      6}, 143.56}, {{2018, 12, 7}, 141.56}, {{2018, 12, 10}, 140.64}, {{2018, 
      12, 11}, 142.94}, {{2018, 12, 12}, 146.36}, {{2018, 12, 13}, 144.72}, {{
      2018, 12, 14}, 144.08}, {{2018, 12, 17}, 144.48}},
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", " ", "=", 
   RowBox[{"N", "@", " ", 
    RowBox[{"TimeSeriesRescale", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "-", "1"}]}], "}"}]}], 
     "]"}]}]}], 
  ";"}]}], "Input",ExpressionUUID->"b64e336b-3258-4367-9558-72ea9d31dacc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"start", ",", "ts"}], "}"}], " ", "=", " ", 
   RowBox[{"TakeDrop", "[", 
    RowBox[{"data", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"start", " ", "=", 
   RowBox[{"start", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ts", " ", "=", 
   RowBox[{"TimeSeries", "[", "ts", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"process", " ", "=", " ", 
   RowBox[{"GeometricBrownianMotionProcess", "[", 
    RowBox[{"mu", ",", 
     RowBox[{"Exp", "[", "logsigma", "]"}], ",", " ", "start"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"logLikeGBMProcess", " ", "=", 
  RowBox[{"ReleaseHold", "[", "\[IndentingNewLine]", 
   RowBox[{"expressionToFunction", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Hold", "[", "\[IndentingNewLine]", 
      RowBox[{"Replace", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"LogLikelihood", "[", 
          RowBox[{
           RowBox[{"GeometricBrownianMotionProcess", "[", 
            RowBox[{"mu", ",", " ", 
             RowBox[{"Exp", "[", "logsigma", "]"}], ",", " ", "start"}], 
            "]"}], ",", "ts"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Except", "[", 
          RowBox[{"_", "?", "NumericQ"}], "]"}], " ", "\[Rule]", " ", 
         "$MachineLogZero"}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"mu", ",", "logsigma"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   "]"}]}]}], "Input",ExpressionUUID->"ee0d5ec7-8d6b-4aa5-b883-abb26b9dcb53"],

Cell[TextData[{
 "Note the use of ",
 StyleBox["Hold",
  FontWeight->"Bold"],
 " and ",
 StyleBox["ReleaseHold",
  FontWeight->"Bold"],
 " to prevent the loglikelihood from evaluating symbolically as well as the \
use of ",
 StyleBox["Replace",
  FontWeight->"Bold"],
 " to make sure the returned result is always numeric even for input values \
where the loglikelihood may not be well-defined. The function ",
 StyleBox["directLogLikelihoodFunction",
  FontWeight->"Bold"],
 " automates this step for you:"
}], "Text",ExpressionUUID->"d1103b9f-5d45-4c06-a693-3b24b9e44af6"],

Cell["\<\
Define the inference problem with the pre-defined loglikelihood function:\
\>", "Text",ExpressionUUID->"db41a419-6d48-46e8-b543-cf7d8b9dd2da"],

Cell[BoxData[
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "\"\<LogLikelihoodFunction\>\"", "\[Rule]", " ", "logLikeGBMProcess"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "ts"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mu", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"logsigma", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}]}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
     RowBox[{"{", "t", "}"}]}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Regression", " ", "probems", " ", "should", " ", "always", " ", "have",
        " ", "in", " ", "independent", " ", "variable", " ", "defined"}], ",",
       " ", 
      RowBox[{"even", " ", "if", " ", "it", " ", 
       RowBox[{"doesn", "'"}], "t", " ", "appear", " ", "in", " ", "the", " ",
        "model", " ", "directly", " ", "or", " ", "if", " ", "the", " ", 
       "GeneratingDistribution", " ", "has", " ", "not", " ", "been", " ", 
       "defined"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"03fd6b5f-c647-4c58-96fb-b20d5b5ceeea"],

Cell["\<\
Run the sampler (this will take a while because the code runs without \
compilation):\
\>", "Text",ExpressionUUID->"1efab765-a352-402c-946d-78e60450bc12"],

Cell[BoxData[
 RowBox[{"result", " ", "=", 
  RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "20"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",ExpressionUUID->"c78ef708-4632-484a-877f-6c0f6f70726d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Creating a compiled version of the loglikelihood function", \
"Subsubsection",ExpressionUUID->"cfba4d89-3e91-4fca-88b6-19dd3e08b860"],

Cell["\<\
Since this is so slow, let\[CloseCurlyQuote]s do some manual labour to \
compile the loglikelihood function. The probability of each data point in the \
series depends on the value of the previous point and the time difference \
between them. So in a sense the problem becomes a regression problem with \
from a 2D input to a 1D output vector. Therefore, we need to transform the \
data into the following form:\
\>", "Text",ExpressionUUID->"58226dd1-6724-4d70-ac39-0c6bc5983b8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"Array",TagBox["List", "IconizedNameLight"],GridBox[{{
          RowBox[{
            TagBox["\"Dimensions: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox[
             RowBox[{"{", 
               RowBox[{"65", ",", "2"}], "}"}], "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["12536", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],Dynamic[
       Typeset`open]},
      "IconizedObject"]],
    {{{2018, 9, 18}, 160.26}, {{2018, 9, 19}, 161.04}, {{2018, 9, 20}, 
      161.92}, {{2018, 9, 21}, 161.68}, {{2018, 9, 24}, 162.14}, {{2018, 9, 
      25}, 162.26}, {{2018, 9, 26}, 161.54}, {{2018, 9, 27}, 162.44}, {{2018, 
      9, 28}, 160.9}, {{2018, 10, 1}, 164.9}, {{2018, 10, 2}, 165.72}, {{2018,
       10, 3}, 164.88}, {{2018, 10, 4}, 162.8}, {{2018, 10, 5}, 160.26}, {{
      2018, 10, 8}, 157.74}, {{2018, 10, 9}, 159.12}, {{2018, 10, 10}, 
      150.36}, {{2018, 10, 11}, 150.}, {{2018, 10, 12}, 149.38}, {{2018, 10, 
      15}, 150.18}, {{2018, 10, 16}, 155.}, {{2018, 10, 17}, 160.38}, {{2018, 
      10, 18}, 155.32}, {{2018, 10, 19}, 153.82}, {{2018, 10, 22}, 152.78}, {{
      2018, 10, 23}, 147.86}, {{2018, 10, 24}, 142.46}, {{2018, 10, 25}, 
      147.52}, {{2018, 10, 26}, 145.96}, {{2018, 10, 29}, 145.22}, {{2018, 10,
       30}, 147.74}, {{2018, 10, 31}, 150.92}, {{2018, 11, 1}, 151.96}, {{
      2018, 11, 2}, 152.9}, {{2018, 11, 5}, 150.28}, {{2018, 11, 6}, 
      154.48}, {{2018, 11, 7}, 154.74}, {{2018, 11, 8}, 153.64}, {{2018, 11, 
      9}, 152.22}, {{2018, 11, 12}, 148.9}, {{2018, 11, 13}, 153.16}, {{2018, 
      11, 14}, 153.02}, {{2018, 11, 15}, 152.3}, {{2018, 11, 16}, 147.74}, {{
      2018, 11, 19}, 143.96}, {{2018, 11, 20}, 141.28}, {{2018, 11, 21}, 
      145.3}, {{2018, 11, 22}, 142.74}, {{2018, 11, 23}, 144.5}, {{2018, 11, 
      26}, 146.66}, {{2018, 11, 27}, 148.58}, {{2018, 11, 28}, 149.86}, {{
      2018, 11, 29}, 151.24}, {{2018, 11, 30}, 149.1}, {{2018, 12, 3}, 
      154.04}, {{2018, 12, 4}, 153.16}, {{2018, 12, 5}, 149.32}, {{2018, 12, 
      6}, 143.56}, {{2018, 12, 7}, 141.56}, {{2018, 12, 10}, 140.64}, {{2018, 
      12, 11}, 142.94}, {{2018, 12, 12}, 146.36}, {{2018, 12, 13}, 144.72}, {{
      2018, 12, 14}, 144.08}, {{2018, 12, 17}, 144.48}},
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", " ", "=", 
   RowBox[{"N", "@", " ", 
    RowBox[{"TimeSeriesRescale", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "-", "1"}]}], "}"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"827f9385-0c02-4d41-a019-d031a3421176"],

Cell[BoxData[
 RowBox[{"transformedData", " ", "=", " ", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}], 
     "\[Rule]", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "2", ",", 
      RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"3563e0cc-7249-457c-b352-34792b7965c9"],

Cell["The inference problem can now be defined like this:", \
"Text",ExpressionUUID->"2c55f640-7a66-4a47-936e-edda9ef298fd"],

Cell[BoxData[
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "transformedData"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"GeometricBrownianMotionProcess", "[", 
       RowBox[{"mu", ",", " ", 
        RowBox[{"Exp", "[", "logsigma", "]"}], ",", " ", "yprev"}], "]"}], 
      "[", "\[CapitalDelta]t", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mu", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"logsigma", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}]}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]t", ",", "yprev"}], "}"}]}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "10"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"88d8915a-1fab-424f-93d2-99cd9354ba09"],

Cell["\<\
Compare the constructed loglikelihood function with the built-in version to \
verify:\
\>", "Text",ExpressionUUID->"c0553513-ed39-484f-b217-b83dfc54083c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mu", "=", "0"}], ",", 
     RowBox[{"logsigma", "=", 
      RowBox[{"-", "4"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "@", 
     RowBox[{
      RowBox[{"obj", "[", "\"\<LogLikelihoodFunction\>\"", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"mu", ",", "logsigma"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "@", 
     RowBox[{"LogLikelihood", "[", 
      RowBox[{
       RowBox[{"GeometricBrownianMotionProcess", "[", 
        RowBox[{"mu", ",", " ", 
         RowBox[{"Exp", "[", "logsigma", "]"}], ",", " ", "start"}], "]"}], 
       ",", "ts"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"b7d25a44-4cb4-4d83-89e0-a10835a524b7"],

Cell["\<\
For the purpose of plotting the data later, we can restore the original data \
to the inference object since it will not be used after the definition step \
anymore (except for visualisation purposes)\
\>", "Text",ExpressionUUID->"5f858a07-edf2-4275-bd8a-301666164755"],

Cell[BoxData[
 RowBox[{
  RowBox[{"obj", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"obj", ",", " ", 
     RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
      RowBox[{"TimeSeries", "[", "data", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"a7862a70-e08c-4330-8b96-24262909d76d"],

Cell["Run the nested sampling algorithm:", \
"Text",ExpressionUUID->"fade880b-e3ed-4e37-8a3b-18cb31bfca1d"],

Cell[BoxData[{
 RowBox[{"result", " ", "=", 
  RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "25"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.001"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<MinIterations\>\"", "\[Rule]", "500"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}]}], "\[IndentingNewLine]",
    "]"}]}], "\n", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mu", ",", "logsigma"}], "}"}]}], "]"}]}], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"98bdcad8-4abc-47dc-ab76-bc02dffafef8"],

Cell[TextData[{
 "The first thing we can do is visualise the prediction errors at each data \
point using the input values we calculated in ",
 StyleBox["transformedData",
  FontWeight->"Bold"],
 ". This will visualise how well we can predict each next point from the \
previous (using the posterior knowledge of all data points):"
}], "Text",ExpressionUUID->"757379c3-576d-4d9b-a341-d322609e8fbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"truncatedResult", " ", "=", " ", 
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictions", "=", 
   RowBox[{"predictiveDistribution", "[", 
    RowBox[{"truncatedResult", ",", 
     RowBox[{"transformedData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;"}], ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"regressionPlot1D", "[", 
  RowBox[{"result", ",", "predictions", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"a18ca735-ef4d-4a2a-9db8-9c23d1a87ef2"],

Cell["\<\
We can also visualise how well our posterior knowledge could predict the \
future if we would only knew the starting point (and compare that with the \
maximum likelihood point-estimate):\
\>", "Text",ExpressionUUID->"76e58d76-3209-4fec-9de4-e037558d1295"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"predictions", "=", 
   RowBox[{
    RowBox[{"KeyMap", "[", "First", "]"}], "@", 
    RowBox[{"predictiveDistribution", "[", "\[IndentingNewLine]", 
     RowBox[{"truncatedResult", ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "start"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", ";;"}], ",", "1"}], "]"}], "]"}]}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"regressionPlot1D", "[", 
    RowBox[{"result", ",", "predictions", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"estproc", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"GeometricBrownianMotionProcess", "[", 
      RowBox[{"#1", ",", " ", 
       RowBox[{"Exp", "[", "#2", "]"}], ",", " ", "start"}], "]"}], "&"}], "@@", 
    RowBox[{
     RowBox[{"First", "[", 
      RowBox[{"TakeLargestBy", "[", 
       RowBox[{
        RowBox[{"result", "[", "\"\<Samples\>\"", "]"}], ",", 
        RowBox[{"#LogLikelihood", "&"}], ",", "1"}], "]"}], "]"}], "[", 
     "\"\<Point\>\"", "]"}]}]}], ";"}], "\n", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{"plot", ",", "\[IndentingNewLine]", 
   RowBox[{"regressionPlot1D", "[", 
    RowBox[{"result", ",", 
     RowBox[{"AssociationMap", "[", 
      RowBox[{"estproc", ",", 
       RowBox[{"ts", "[", "\"\<Times\>\"", "]"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[113]:=",ExpressionUUID->"dac5ac3d-c265-4916-b8d0-0a368d8c7465"],

Cell["Finally, we can also predict future values:", \
"Text",ExpressionUUID->"461565e4-6b5e-49ae-9876-ffb9b5a6f4f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"extrapolations", "=", 
   RowBox[{
    RowBox[{"KeyMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"First", "[", "#", "]"}], "+", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "&"}], "]"}], "@", 
    RowBox[{"predictiveDistribution", "[", "\[IndentingNewLine]", 
     RowBox[{"truncatedResult", ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "20"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n", 
 RowBox[{"regressionPlot1D", "[", 
  RowBox[{"result", ",", "extrapolations", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellLabel->"In[128]:=",ExpressionUUID->"0be111c6-dd1a-415d-ab4d-ee0d72769c9f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bayesian neural networks", \
"Section",ExpressionUUID->"69be4aa7-9ba7-4661-b681-cf9eab5ddf15"],

Cell[TextData[{
 "This section implements ideas discussed in the following blog post: \n",
 Cell[BoxData[
  TemplateBox[{
   "\"https://blog.wolfram.com/2018/05/31/how-optimistic-do-you-want-to-be-\
bayesian-neural-network-regression-with-prediction-errors/\"",
    "https://blog.wolfram.com/2018/05/31/how-optimistic-do-you-want-to-be-\
bayesian-neural-network-regression-with-prediction-errors/"},
   "HyperlinkURL"]],ExpressionUUID->"d7342976-ce85-4f89-985a-63ad9b4c2fd8"],
 "\n\nSee also:\n",
 Cell[BoxData[
  TemplateBox[{
   "\"http://mlg.eng.cam.ac.uk/yarin/blog_3d801aa532c1ce.html\"",
    "http://mlg.eng.cam.ac.uk/yarin/blog_3d801aa532c1ce.html"},
   "HyperlinkURL"]],ExpressionUUID->"1e7cc187-4249-44c2-9f07-6304762f523e"],
 "\n",
 Cell[BoxData[
  TemplateBox[{
   "\"http://www.cs.ox.ac.uk/people/yarin.gal/website/thesis/thesis.pdf\"",
    "http://www.cs.ox.ac.uk/people/yarin.gal/website/thesis/thesis.pdf"},
   "HyperlinkURL"]],ExpressionUUID->"76368b2d-d6ee-49c2-a8c5-f92c076e8fea"],
 "\n",
 Cell[BoxData[
  TemplateBox[{
   "\"https://arxiv.org/pdf/1703.02914.pdf\"",
    "https://arxiv.org/pdf/1703.02914.pdf"},
   "HyperlinkURL"]],ExpressionUUID->"5e00a2b4-81ca-488e-9e05-50f4e0132705"]
}], "Text",ExpressionUUID->"77a94626-02b2-45f3-bdc6-326f466cf0fc"],

Cell["First make some test data:", \
"Text",ExpressionUUID->"39ecf318-a556-4c1d-8a2a-467d4ca11ea7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SeedRandom", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"testdata", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{"#", "+", 
          RowBox[{"2", " ", 
           RowBox[{"RandomReal", "[", "]"}]}]}], ")"}]}], ")"}], "&"}], "/@", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "20"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"List", "@@@", "testdata"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "testdata"}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"0a4ea69c-a0dd-470a-adba-67d36efc72f4"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAUD8YAhxQ5D8WZTY5Tbv8Pzi7g0eA
3ui/4ImPieaf4L841ZIJmIfiP4yKxM8MEvM/VPOzggj7478kWCGQkpbpPxxD
j7qKjeC/MO3fwIDj0D+cIXWo78rrv7wI/TNor+g/wCTpWlmhtT/4LkNCuobn
P2C6T7rDNOG/ZLx6BDbD5D9QUbtuWJ/Kv6zJrXTCi+o/QN2S+B+p2T8wFE/1
q6XnP+Q84XJxceK/+JTe1yCa1z+QgvIa/dPfP6owSxWh5ABAIBj+UQ/Aw7/w
M1c0abjAv5yJkKYLKeC/QJDMx5t6wD/wFdBt+4nuPxY/j2eIRQRAeFy+N3jP
5D90MZKdt5PlP/w7N3q1N+s/5vpyzTAh+j9QRRHsfPvDPyDjcjvDLvE/aH47
lT6D2r8EZ/CiFxzgP+CjN5ZKr+K/AJua+lfg6z/bhKt6
      "]]}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-0.8685224809824379, 0.9543435234815529}, {-0.5195191084606527,
    2.533951577242884}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[3]=",ExpressionUUID->"68248fb2-52ec-4aea-8a4c-24e27bd372e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.6347789803421424`", "\[Rule]", "1.7957279429304598`"}], ",", 
   RowBox[{
    RowBox[{"-", "0.7771607777375271`"}], "\[Rule]", 
    RowBox[{"-", "0.5195191084606527`"}]}], ",", 
   RowBox[{"0.5790519892677031`", "\[Rule]", "1.1919067493369395`"}], ",", 
   RowBox[{
    RowBox[{"-", "0.6243937065879472`"}], "\[Rule]", "0.7996304335636109`"}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.5172780650846991`"}], "\[Rule]", "0.26388567767544924`"}],
    ",", 
   RowBox[{
    RowBox[{"-", "0.8685224809824379`"}], "\[Rule]", "0.7714119925879213`"}], 
   ",", 
   RowBox[{"0.08449324101924827`", "\[Rule]", "0.7351962370098297`"}], ",", 
   RowBox[{
    RowBox[{"-", "0.5376909865279451`"}], "\[Rule]", "0.6488294684876448`"}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.20798783690282585`"}], "\[Rule]", "0.8295604971775012`"}],
    ",", 
   RowBox[{"0.4009475638844897`", "\[Rule]", "0.7389735976399887`"}], ",", 
   RowBox[{
    RowBox[{"-", "0.576348041891745`"}], "\[Rule]", "0.36878224450113306`"}], 
   ",", 
   RowBox[{"0.4973137629658959`", "\[Rule]", "2.111635366780395`"}], ",", 
   RowBox[{
    RowBox[{"-", "0.15429870132010226`"}], "\[Rule]", 
    RowBox[{"-", "0.1306277757234109`"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.505010438271984`"}], "\[Rule]", "0.12874171500982534`"}], 
   ",", 
   RowBox[{"0.9543435234815529`", "\[Rule]", "2.533951577242884`"}], ",", 
   RowBox[{"0.6503258789770276`", "\[Rule]", "0.674281890636435`"}], ",", 
   RowBox[{"0.8505504023577255`", "\[Rule]", "1.633103182349879`"}], ",", 
   RowBox[{"0.15611230398875842`", "\[Rule]", "1.0739166567056557`"}], ",", 
   RowBox[{
    RowBox[{"-", "0.414260526404155`"}], "\[Rule]", "0.5034292395023106`"}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.5838978704388147`"}], "\[Rule]", 
    "0.8711357016189538`"}]}], "}"}]], "Output",
 CellLabel->"Out[4]=",ExpressionUUID->"ba9cc445-1d06-42d0-8c12-af7bb744812e"]
}, Open  ]],

Cell[TextData[{
 "The main function used for constructing Bayesian-style regression neural \
networks is ",
 StyleBox["regressionLossNet",
  FontWeight->"Bold"],
 ". "
}], "Text",ExpressionUUID->"9c658337-cd49-4f76-95e5-769affde9f61"],

Cell[CellGroupData[{

Cell[TextData[{
 "The first argument can take one of two values: ",
 Cell[BoxData[
  FormBox["\"\<HeteroScedastic\>\"", TraditionalForm]],ExpressionUUID->
  "bea30636-a0cf-48bd-95ce-3457cf0756bc"],
 " (default value if omitted) or ",
 Cell[BoxData[
  FormBox["\"\<HomoScedastic\>\"", TraditionalForm]],ExpressionUUID->
  "cc61c8ca-42cd-47fd-8c08-b4a25c14ff23"],
 ". A heteroscedastic will allow the predicted variance of the network to be \
dependent on the network inputs whereas a homoscedastic network will predict \
a constant variance."
}], "Item",ExpressionUUID->"a3d4bf0a-4bf5-44ff-8d04-b0dfaf5456fb"],

Cell["\<\
There are several options for specifying the network architecture:\
\>", "Item",ExpressionUUID->"c2c05efc-7154-4d7e-aa72-d735750e66f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "regressionLossNet", "]"}]], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"c7a8439a-c034-4629-8294-e9071eb9fd22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"NetworkDepth\"\>", "\[Rule]", "4"}], ",", 
   RowBox[{"\<\"LayerSize\"\>", "\[Rule]", "100"}], ",", 
   RowBox[{"\<\"ActivationFunction\"\>", "\[Rule]", "\<\"SELU\"\>"}], ",", 
   RowBox[{"\<\"DropoutProbability\"\>", "\[Rule]", "0.25`"}], ",", 
   RowBox[{"\<\"BatchNormalization\"\>", "\[Rule]", "False"}], ",", 
   RowBox[{"\<\"Input\"\>", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"\<\"LossModel\"\>", "\[Rule]", "Automatic"}]}], "}"}]], "Output",
 CellLabel->"Out[129]=",ExpressionUUID->"99bde496-c519-46d9-b214-3af890c2954c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox["\"\<NetworkDepth\>\"", TraditionalForm]],ExpressionUUID->
  "daf8139a-f34e-4761-bf17-ae0b219e9f2e"],
 " and ",
 Cell[BoxData[
  FormBox["\"\<LayerSize\>\"", TraditionalForm]],ExpressionUUID->
  "41c7005a-6589-42e3-b8b9-fe77124f0c9e"],
 " specify the complexity of the network."
}], "Subitem",ExpressionUUID->"30007450-bbd6-44c0-9e96-55ebe189e856"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["\"\<ActivationFunction\>\"", TraditionalForm]],ExpressionUUID->
  "4f6dd36b-787d-4f92-b6cf-b159f79ed4a1"],
 " specifies the nonlinearity used in the ",
 Cell[BoxData[
  FormBox[
   StyleBox["ElementWiseLayer",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "e77f2e69-7e9b-40d4-ac51-6ffa90b629f2"],
 "s in the network. The default is the ",
 Cell[BoxData[
  FormBox["\"\<ScaledExponentialLinearUnit\>\"", TraditionalForm]],
  ExpressionUUID->"b90239da-6171-45cd-899b-616ceea413d0"],
 " activation."
}], "Subitem",ExpressionUUID->"ad705557-4b5d-499d-ba61-eff0e1a5e1c8"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["\"\<DropoutProbability\>\"", TraditionalForm]],ExpressionUUID->
  "ab333745-8bd0-425d-bafd-9e45538ccfb9"],
 " specifies the dropout probability in the ",
 Cell[BoxData[
  FormBox[
   StyleBox["DropoutLayer",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "15a5769e-cf9b-4ed2-98ca-74009d65d768"],
 "s. Default value is 0.25. Setting ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\"\<DropoutProbability\>\"", "\[Rule]", " ", "None"}], 
   TraditionalForm]],ExpressionUUID->"6586ff77-6d00-4c9f-a12b-1232fd549ec8"],
 " leaves them out completely. "
}], "Subitem",ExpressionUUID->"b46ccdb9-3a05-4763-8366-22e3d481ad17"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["\"\<BatchNormalization\>\"", TraditionalForm]],ExpressionUUID->
  "10b8e83f-7293-464e-82a7-bdbad31dfebc"],
 " takes the values ",
 Cell[BoxData[
  FormBox["True", TraditionalForm]],ExpressionUUID->
  "dbdfcf62-1b39-4d97-8675-522fa2e8812e"],
 " or ",
 Cell[BoxData[
  FormBox["False", TraditionalForm]],ExpressionUUID->
  "8115adf0-b74d-4390-b57a-cd405092b089"],
 " (default). If ",
 Cell[BoxData[
  FormBox["True", TraditionalForm]],ExpressionUUID->
  "abfee3b5-82e7-4c85-97e8-17607a7a1209"],
 ", ",
 Cell[BoxData[
  FormBox[
   StyleBox["BatchNormalizationLayer",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "460fe206-3b97-44c7-8920-bfd493267d89"],
 "s will be used in the network."
}], "Subitem",ExpressionUUID->"9935db16-b335-4ccf-8c88-3d0a15cbbc40"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["\"\<Input\>\"", TraditionalForm]],ExpressionUUID->
  "19e1e0c1-9e0f-4671-a628-51d310e78a80"],
 " specifies the dimensions of the input data."
}], "Subitem",ExpressionUUID->"ba0527e9-136b-449f-9131-6a2658fcb14f"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["\"\<LossModel\>\"", TraditionalForm]],ExpressionUUID->
  "e6425219-dc07-463b-9977-785cce91a3c8"],
 " is used to specify the network loss. There are 2 possible values:"
}], "Subitem",ExpressionUUID->"08380044-4614-4c14-b13a-e04511a43862"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   StyleBox["Automatic",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "7a022632-e52f-4ed8-b403-3a29a3183164"],
 " (default). This value uses the Gaussian negative loglikelihood as the loss \
function"
}], "Subsubitem",ExpressionUUID->"00945322-d3cb-40b7-b1e4-d974f49fa411"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"\"\<AlphaDivergence\>\"", ",", 
     RowBox[{"\"\<Alpha\>\"", "\[Rule]", " ", "\[Alpha]"}], ",", 
     RowBox[{"\"\<SampleNumber\>\"", "\[Rule]", "n"}]}], "}"}], 
   TraditionalForm]],ExpressionUUID->"0cf8fbec-1840-49be-b308-70376c87b01b"],
 " uses the alpha-divergence loss developed by Li and Gal (",
 Cell[BoxData[
  TemplateBox[{
   "\"https://arxiv.org/abs/1703.02914\"","https://arxiv.org/abs/1703.02914"},
   "HyperlinkURL"]],ExpressionUUID->"e2ad5a44-5c7e-432b-bbba-19d7cb464827"],
 "). The default values are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "=", "0.5"}], TraditionalForm]],ExpressionUUID->
  "1d5751c5-5448-4b37-ae65-8d69a0314c02"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "10"}], TraditionalForm]],ExpressionUUID->
  "4b560515-5268-4a66-ba46-a97d332ffebe"],
 ". The larger the value of ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "820864df-b6e9-44d8-9e59-0a7168f2f72d"],
 ", the less the network will be penalized for occasionally producing wrong \
predictions when sampled with dropout layers active. Thus, a network trained \
at a higher value of ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "0088f8e7-3863-400d-a8b6-5bcbafddc8e3"],
 " will produce predictions with greater variance and is therefore more \
conservative/pessimistic in its estimates. Special values for ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "17e54da3-638b-418b-9d99-8fc86ca4e2e9"],
 " are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "\[Infinity]"}], TraditionalForm]],ExpressionUUID->
  "acd87e23-e224-4499-909a-5c40abe68cd1"],
 ", 0 and ",
 Cell[BoxData[
  FormBox["\[Infinity]", TraditionalForm]],ExpressionUUID->
  "a0898aaa-fa96-4422-b1b2-14606b645709"],
 ". The function ",
 Cell[BoxData[
  FormBox[
   StyleBox["alphaDivergenceLoss",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "587b1d02-80bc-4ab8-8c64-b31a3704d5e0"],
 " is used to produce the loss layer for the alpha-divergence:"
}], "Subsubitem",ExpressionUUID->"0e852ddb-81a2-4ac5-8af0-0e91f83ff723"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"alphaDivergenceLoss", "[", 
  RowBox[{"0.5", 
   RowBox[{"(*", "Alpha", "*)"}], ",", "20"}], 
  RowBox[{"(*", "SampleNumber", "*)"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"alphaDivergenceLoss", "[", 
  RowBox[{
   RowBox[{"-", "Infinity"}], ",", "20"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"alphaDivergenceLoss", "[", 
  RowBox[{"0", ",", "20"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"alphaDivergenceLoss", "[", 
  RowBox[{"Infinity", ",", "20"}], "]"}]}], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"9d118393-997e-4879-a46e-5894c7106b74"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["NetGraph", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open = True), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.0149], {
                 RGBColor[0.729, 0.729, 0.729], 
                 Thickness[0.03], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 37.}, {18., 37.}, {
                  18.5, 27.5}, {35., 27.}}}, CurveClosed -> {0}], 
                 
                 JoinedCurveBox[{{{1, 4, 3}}}, {{{50., 37.}, {50., 37.}, {
                  49.5, 27.5}, {33., 27.}}}, CurveClosed -> {0}], 
                 
                 JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 16.}, {18., 16.}, {
                  18.5, 25.5}, {35., 26.}}}, CurveClosed -> {0}]}, {
                 FaceForm[
                  RGBColor[0.631, 0.8160000000000001, 0.498]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5, 
                  40.5}, {22.5, 40.5}, {22.5, 33.5}, {15.5, 33.5}}}]}, {
                 FaceForm[
                  RGBColor[0.40800000000000003`, 0.627, 0.196]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 41.}, {15., 41.}, {15., 
                  33.}, {23., 33.}}, {{22., 34.}, {16., 34.}, {16., 40.}, {
                  22., 40.}}}]}, {
                 FaceForm[
                  RGBColor[0.38, 0.753, 0.89]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5, 
                  19.5}, {22.5, 19.5}, {22.5, 12.5}, {15.5, 12.5}}}]}, {
                 FaceForm[
                  RGBColor[0.24300000000000002`, 0.608, 0.71]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 20.}, {15., 20.}, {15., 
                  12.}, {23., 12.}}, {{22., 13.}, {16., 13.}, {16., 19.}, {
                  22., 19.}}}]}, {
                 FaceForm[
                  RGBColor[0.584, 0.51, 0.8390000000000001]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{30.5, 
                  30.5}, {37.5, 30.5}, {37.5, 23.5}, {30.5, 23.5}}}]}, {
                 FaceForm[
                  RGBColor[0.4, 0.396, 0.659]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 31.}, {30., 31.}, {30., 
                  23.}, {38., 23.}}, {{37., 24.}, {31., 24.}, {31., 30.}, {
                  37., 30.}}}]}, {
                 FaceForm[
                  RGBColor[0.8270000000000001, 0.41200000000000003`, 0.133]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{45.5, 
                  40.5}, {52.5, 40.5}, {52.5, 33.5}, {45.5, 33.5}}}]}, {
                 FaceForm[
                  RGBColor[0.647, 0.259, 0.08600000000000001]], 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{53., 41.}, {45., 41.}, {45., 
                  33.}, {53., 33.}}, {{52., 34.}, {46., 34.}, {46., 40.}, {
                  52., 40.}}}]}}, ImageMargins -> 0, 
               ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Input\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"20\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Output\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"real\"", "SummaryItem"]}, {
                 StyleBox[
                  
                  TemplateBox[{"\"Number of layers\"", "\":\""}, 
                   "RowDefault"], "SummaryItemAnnotation"], 
                 StyleBox["8", "SummaryItem"]}}, BaselinePosition -> {2, 1}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, BaselinePosition -> {1, 3}],
           True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open = False), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.0149], {
                 RGBColor[0.729, 0.729, 0.729], 
                 Thickness[0.03], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 37.}, {18., 37.}, {
                  18.5, 27.5}, {35., 27.}}}, CurveClosed -> {0}], 
                 
                 JoinedCurveBox[{{{1, 4, 3}}}, {{{50., 37.}, {50., 37.}, {
                  49.5, 27.5}, {33., 27.}}}, CurveClosed -> {0}], 
                 
                 JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 16.}, {18., 16.}, {
                  18.5, 25.5}, {35., 26.}}}, CurveClosed -> {0}]}, {
                 FaceForm[
                  RGBColor[0.631, 0.8160000000000001, 0.498]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5, 
                  40.5}, {22.5, 40.5}, {22.5, 33.5}, {15.5, 33.5}}}]}, {
                 FaceForm[
                  RGBColor[0.40800000000000003`, 0.627, 0.196]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 41.}, {15., 41.}, {15., 
                  33.}, {23., 33.}}, {{22., 34.}, {16., 34.}, {16., 40.}, {
                  22., 40.}}}]}, {
                 FaceForm[
                  RGBColor[0.38, 0.753, 0.89]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5, 
                  19.5}, {22.5, 19.5}, {22.5, 12.5}, {15.5, 12.5}}}]}, {
                 FaceForm[
                  RGBColor[0.24300000000000002`, 0.608, 0.71]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 20.}, {15., 20.}, {15., 
                  12.}, {23., 12.}}, {{22., 13.}, {16., 13.}, {16., 19.}, {
                  22., 19.}}}]}, {
                 FaceForm[
                  RGBColor[0.584, 0.51, 0.8390000000000001]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{30.5, 
                  30.5}, {37.5, 30.5}, {37.5, 23.5}, {30.5, 23.5}}}]}, {
                 FaceForm[
                  RGBColor[0.4, 0.396, 0.659]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 31.}, {30., 31.}, {30., 
                  23.}, {38., 23.}}, {{37., 24.}, {31., 24.}, {31., 30.}, {
                  37., 30.}}}]}, {
                 FaceForm[
                  RGBColor[0.8270000000000001, 0.41200000000000003`, 0.133]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{45.5, 
                  40.5}, {52.5, 40.5}, {52.5, 33.5}, {45.5, 33.5}}}]}, {
                 FaceForm[
                  RGBColor[0.647, 0.259, 0.08600000000000001]], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{53., 41.}, {45., 41.}, {45., 
                  33.}, {53., 33.}}, {{52., 34.}, {46., 34.}, {46., 40.}, {
                  52., 40.}}}]}}, ImageMargins -> 0, 
               ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
              GridBox[{{
                 
                 DynamicModuleBox[{
                  NeuralNetworks`Private`NetGraph`selection = None}, 
                  GridBox[{{
                    TagBox[
                    GraphicsBox[{{
                    GrayLevel[0.7], {
                    
                    LineBox[{{-9., 5.51091059616309*^-16}, {-8., 
                    4.898587196589413*^-16}}], 
                    
                    LineBox[{{-8., 
                    4.898587196589413*^-16}, {-7., -0.9999999999999996}}], 
                    LineBox[CompressedData["
1:eJxTTMoPSmViYGBQBWIQDQEKB9hjRIzVlh20WZH+5tHX8/IHbHMupS7vPmgT
sYTH5u4s+QOVd57Pjcs7aMOzLYF7W4L8gV1rQm57+x20OTTnRUCDovwBxrsS
cvnaB23qwBrkDvjlmqSdYD1oY/9yst3LyXIHFsQu3xx+94ANs//2Z+2ucgd+
rC1kk910wOZsJx+rxCfZA+Fxk+MkWg7YzJoJArIHduXx7PEMPmDzAqTdTvaA
vL6hjJjiARvLvscWfY9lDvDdX/3jyN39Nl0dICBz4E781x2xlfttbjTpApHM
gWUP7Cq/iey30ai9pF57SfpAUWKHZf+GfTYV5SAgfcD+0cWf6j77bE4Uyhwv
lJE+wJMsvevA8702EjkHxXIOSh248TilKrJ5L9Q9kgeKjgW/5rTdY7Muc6oQ
v4PkAdX1K1cxz87Z7/vU7l7VS4kDRzaC+D37K3mm/bkzVeKAc8l/fiPxBft1
78/KNXWVOJC1CSS/Zn92rK9hy3fxA8WTQ+5KRW7bb9K+1v3kGvEDuWD1B/Z3
xOzewJIqfmDbm5Xn1j07uj/9blmOmYL4gclg/Wf2n+d8UBV3T+wAc/L/QAmp
S/ubni8L2JQjdmB/+8Svt0xu7t87+zkTN7PYAWmXtov+5+/vr1dbNDFjoegB
7jPvinZ/ebT/SPu1P6fcRQ9cP+gtueLg0/2T9re4GH0TOVDCfOt2rt+L/U/O
rsmYt0bkwL0JM3fxzH61f88mv0z+bJEDklldW1uWv9kvnZfl1moockClf82Z
q8Xv9kPSj8iBv/9B4P1+AH2HKkE=
                    "]], 
                    LineBox[CompressedData["
1:eJxTTMoPSmViYGAwB2IQDQEyB/78B4H3+59MnLqz6pz0gawdKyVFj33Y7+K7
cdqHKdIHPpyyWmq75uN+GaPg6YnB0gf6zDcvqtz0aX++Q/Xus5zSB5z/CQmd
vPF5v02FJrPpDqkDgvJRn7Xlv+5vuhmbNz1O6sCPmR1ui1q/7XdKkfj75Y/k
gW9587h1eH7sr5WIXO87WfIA77zZTic3/dxv8E2+daGi5AEb9YbXlZW/989Q
6px88r7EgRUnV3XNz/mzv2Kxi//vWRIH0g5pqWk5/91/piJoh1mwxIECQYZ9
kn//7p+2aNO5ag6JA8e2aQXlzfq3/4pC6qRTu8QPZG1a9Uhd+v/+js+ZzMpZ
4geiWRry3er/798kdVCxVUz8wIw1q36cPPZ/f9C0rLcf9osdUFmtVbfp4//9
s2aCgOiBf+Dw+b//5WQ7IBKFhtf//ZZ9jy36HovA5Ts7QEDkwH8o/2aT7o0m
XYS8Ru0l9dpLwnB+RTkIIPjHC2WACMEXzzkolnNQCM6HuEcQzn8Fdo8gmnsE
4PJdYPcIwN1zA+wehHzAryX+v5bww/kf3oEAH5wPNs4CwdcDG8AL5xuDATec
f1Ed5EEuuHuKQN45zgmXFxYEAU64ezawRgMRB5p72OH892D3sKG5hw3NPaxw
/hkwYIHz0948+npemgXunl+JE40+lDDD5VtAwXGDCe4eFv/tz9pdEfyqY3px
//cwooU3gg9WfooBzl9joG4lksAA1w/NYHA+AKZbSEY=
                    "]], 
                    
                    LineBox[{{-7., -0.9999999999999996}, {-6., \
-0.9999999999999997}}], 
                    
                    LineBox[{{-6., -0.9999999999999997}, {-5., \
-0.9999999999999997}}], 
                    
                    LineBox[{{-5., -0.9999999999999997}, {-4., \
-0.9999999999999998}}], 
                    
                    LineBox[{{-4., -0.9999999999999998}, {-3., \
-0.9999999999999998}}], 
                    
                    LineBox[{{-3., -0.9999999999999998}, {-2., \
-1.9999999999999998`}}], 
                    
                    LineBox[{{-2., -1.9999999999999998`}, \
{-1.0000000000000002`, -2.}}], 
                    
                    LineBox[{{-1.0000000000000002`, -2.}, \
{-1.2246467991473532`*^-16, -2.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> False]], {-8.4, 
                    5.143516556418883*^-16}, {-0.25, 0}, 
                    Offset[8], {1., -6.123233995736767*^-17}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-7.4, -0.5999999999999995}, {-0.25, 0}, 
                    Offset[8], {1., -1.}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-6.500723193132873, -0.0017459426695960155`}, \
{-0.25, 0}, 
                    Offset[8], {0.3763313915120339, -0.0034918853391928497`}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-5.266666666666667, -1.9999999999999993`}, \
{-0.25, 0}, 
                    Offset[8], {
                    0.08888888888888857, -4.440892098500626*^-16}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-6.4, -0.9999999999999996}, {-0.25, 0}, 
                    Offset[8], {1., -1.1102230246251565`*^-16}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-5.4, -0.9999999999999997}, {-0.25, 0}, 
                    Offset[8], {1., 0.}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-4.4, -0.9999999999999998}, {-0.25, 0}, 
                    Offset[8], {1., -1.1102230246251565`*^-16}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-3.4, -0.9999999999999998}, {-0.25, 0}, 
                    Offset[8], {1., 0.}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-2.4000000000000004`, -1.5999999999999996`}, \
{-0.25, 0}, 
                    Offset[8], {1., -1.}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-1.4000000000000001`, -2.}, {-0.25, 0}, 
                    Offset[8], {0.9999999999999998, -2.220446049250313*^-16}], 
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7], StripOnInput -> 
                    False]], {-0.4000000000000002, -2.}, {-0.25, 0}, 
                    Offset[8], {1., 0.}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-9., 5.51091059616309*^-16}, 
                    Offset[{2, 2}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"Input\"", Bold, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["Input", Bold]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 1), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-8., 4.898587196589413*^-16}], 
                    Offset[{10, 10}, {-8., 4.898587196589413*^-16}]]}, 
                    InsetBox[
                    BoxData[
                    FormBox[
                    GraphicsBox[
                    TagBox[
                    RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRIz
UFASiDWAmAWIU5OXNzBQD/hQ0SwwSEtd8R+GqWAc1d0HCj9kN1IYnlR3Hwwg
u5ECd9LMfTCA7k4StdPcfTBApjvp5j4QICNt0tV9MECCOwfEfTBARJwPqPtg
AI87B4X7YACLOweV+0AAOW16uJdRWr5jAz7UwCC3GRsFg90IwuZm0UupYC61
gQ+F5TutAdzPg9SdKHFC5bYHNQDWNDOI3Ik3TQ+COCcqzw2gO0kqEwbAnSSX
WXROm2SXqVRqvxMCFJf5NI5vqtVJg919MAAAKikBFQ==
                    "], {{0, 25}, {40, 0}}, {0, 255}, ColorFunction -> 
                    RGBColor], 
                    BoxForm`ImageTag[
                    "Byte", ColorSpace -> "RGB", ImageResolution -> 144, 
                    Interleaving -> True, Magnification -> Automatic], 
                    Selectable -> False], DefaultBaseStyle -> "ImageGraphics",
                     ImageSizeRaw -> {40, 25}, 
                    PlotRange -> {{0, 40}, {0, 25}}, ImageSize -> 20], 
                    TraditionalForm]], {-8., 4.898587196589413*^-16}]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"timesAlpha\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"ElementwiseLayer", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.5`"}], " ", 
                    RowBox[{"Slot", "[", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    "]"}]}], "&"}], ",", 
                    RowBox[{"\"Input\"", "\[Rule]", "20"}]}], "]"}], 
                    HoldForm], FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["timesAlpha", Bold], 
                    Style[
                    HoldForm[
                    ElementwiseLayer[
                    Shallow[(-0.5) #& , {4, 3}], "Input" -> 20]], FontFamily -> 
                    "Source Code Pro", ShowStringCharacters -> True]}], 
                    "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 2), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-7., -0.9999999999999996}], 
                    Offset[{10, 10}, {-7., -0.9999999999999996}]]}, 
                    InsetBox[
                    FormBox["\"A\"", TraditionalForm], 
                    Offset[{0, -1}, {-7., -0.9999999999999996}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"max\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"AggregationLayer", "[", 
                    RowBox[{"Max", ",", "1", ",", 
                    RowBox[{"\"Input\"", "\[Rule]", "20"}]}], "]"}], 
                    HoldForm], FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["max", Bold], 
                    Style[
                    HoldForm[
                    AggregationLayer[Max, 1, "Input" -> 20]], FontFamily -> 
                    "Source Code Pro", ShowStringCharacters -> True]}], 
                    "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 3), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-5., -0.9999999999999997}], 
                    Offset[{10, 10}, {-5., -0.9999999999999997}]]}, 
                    InsetBox[
                    BoxData[
                    FormBox[
                    StyleBox[
                    "\"\[NegativeVeryThinSpace]\[NegativeVeryThinSpace]#\"", 
                    14, Bold, Italic, FontColor -> 
                    RGBColor[0.2627450980392157, 0.5372549019607843, 
                    0.34509803921568627`], FontFamily -> "Source Code Pro", 
                    StripOnInput -> False], 
                    TraditionalForm]], {-5., -0.9999999999999997}]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"sub\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"ThreadingLayer", "[", 
                    RowBox[{"Subtract", ",", 
                    RowBox[{"\"Inputs\"", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "20"}], "}"}]}]}], "]"}], HoldForm], 
                    FontFamily -> "Source Code Pro", ShowStringCharacters -> 
                    True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["sub", Bold], 
                    Style[
                    HoldForm[
                    ThreadingLayer[Subtract, "Inputs" -> {20, 20}]], 
                    FontFamily -> "Source Code Pro", ShowStringCharacters -> 
                    True]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 4), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-2., -1.9999999999999998`}], 
                    Offset[{10, 10}, {-2., -1.9999999999999998`}]]}, 
                    InsetBox[
                    BoxData[
                    FormBox[
                    StyleBox[
                    "\"\[NegativeVeryThinSpace]\[NegativeVeryThinSpace]#\"", 
                    14, Bold, Italic, FontColor -> 
                    RGBColor[0.2627450980392157, 0.5372549019607843, 
                    0.34509803921568627`], FontFamily -> "Source Code Pro", 
                    StripOnInput -> False], 
                    TraditionalForm]], {-2., -1.9999999999999998`}]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"logplusmax\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"ThreadingLayer", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Slot", "[", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    "]"}], "+", 
                    RowBox[{"Log", "[", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    "]"}]}], "&"}], ",", 
                    RowBox[{"\"Inputs\"", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"Real\"", ",", "\"Real\""}], "}"}]}]}], "]"}], 
                    HoldForm], FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["logplusmax", Bold], 
                    Style[
                    HoldForm[
                    ThreadingLayer[
                    Shallow[#2 + Log[#]& , {4, 3}], 
                    "Inputs" -> {"Real", "Real"}]], FontFamily -> 
                    "Source Code Pro", ShowStringCharacters -> True]}], 
                    "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 5), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-6., -0.9999999999999997}], 
                    Offset[{10, 10}, {-6., -0.9999999999999997}]]}, 
                    InsetBox[
                    FormBox[
                    StyleBox[
                    "\"\[VerticalEllipsis]\"", 10, StripOnInput -> False], 
                    TraditionalForm], 
                    Offset[{0, -1}, {-6., -0.9999999999999997}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"rep\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"ReplicateLayer", "[", 
                    RowBox[{"20", ",", 
                    RowBox[{"\"Input\"", "\[Rule]", "\"Real\""}]}], "]"}], 
                    HoldForm], FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["rep", Bold], 
                    Style[
                    HoldForm[
                    ReplicateLayer[20, "Input" -> "Real"]], FontFamily -> 
                    "Source Code Pro", ShowStringCharacters -> True]}], 
                    "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 6), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-4., -0.9999999999999998}], 
                    Offset[{10, 10}, {-4., -0.9999999999999998}]]}, 
                    InsetBox[
                    BoxData[
                    FormBox[
                    GraphicsBox[
                    TagBox[
                    RasterBox[CompressedData["
1:eJzNlzELgkAYho9qaGxtbOsXVGtTBU5GU5PWKS0GGkVb/Ziof1n3gRdfh11q
3935wKuo8PnwHic4CPd+1GKMZV1x8IPTNE2D87InLlZJtosTvl0kBx7zdBK2
xc2+yFCkw8jxKIbwzf0S8ccTQjEPQeoHZ4p5CBI/2V0T/Qx2B/ztZ7A74C8/
w90Btf3wnm2yn0E3oJafwe+dSi0/C+sqqexnaV0llfwsrquktJ+l/apSys+R
G/DTz6EboPVz7AYU+mEvh27Ahx94qJ05dAO8Ii/Hnb0Zj9a3JnmpPc1nR+te
0gEH94Mj+zPx/m/v1AU75+NI/j8wsCa6QCdqco+iXDXP6oQR73ny/l69KDKd

                    "], {{0, 25}, {40, 0}}, {0, 255}, ColorFunction -> 
                    RGBColor], 
                    BoxForm`ImageTag[
                    "Byte", ColorSpace -> "RGB", ImageResolution -> 144, 
                    Interleaving -> True, Magnification -> Automatic], 
                    Selectable -> False], DefaultBaseStyle -> "ImageGraphics",
                     ImageSizeRaw -> {40, 25}, 
                    PlotRange -> {{0, 40}, {0, 25}}, ImageSize -> 20], 
                    TraditionalForm]], {-4., -0.9999999999999998}]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"expAlph\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"ElementwiseLayer", "[", 
                    RowBox[{"Exp", ",", 
                    RowBox[{"\"Input\"", "\[Rule]", "20"}]}], "]"}], 
                    HoldForm], FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["expAlph", Bold], 
                    Style[
                    HoldForm[
                    ElementwiseLayer[Exp, "Input" -> 20]], FontFamily -> 
                    "Source Code Pro", ShowStringCharacters -> True]}], 
                    "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 7), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-3., -0.9999999999999998}], 
                    Offset[{10, 10}, {-3., -0.9999999999999998}]]}, 
                    InsetBox[
                    FormBox["\"A\"", TraditionalForm], 
                    Offset[{0, -1}, {-3., -0.9999999999999998}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"average\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"AggregationLayer", "[", 
                    RowBox[{"Mean", ",", "1", ",", 
                    RowBox[{"\"Input\"", "\[Rule]", "20"}]}], "]"}], 
                    HoldForm], FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["average", Bold], 
                    Style[
                    HoldForm[
                    AggregationLayer[Mean, 1, "Input" -> 20]], FontFamily -> 
                    "Source Code Pro", ShowStringCharacters -> True]}], 
                    "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 8), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], 
                    RectangleBox[
                    Offset[{-10, -10}, {-1.0000000000000002`, -2.}], 
                    Offset[{10, 10}, {-1.0000000000000002`, -2.}]]}, 
                    InsetBox[
                    BoxData[
                    FormBox[
                    GraphicsBox[
                    TagBox[
                    RasterBox[CompressedData["
1:eJzNlb8OgjAQhxt1cHR1dHPWxdVJTZggPgBoIS6YgNG4+Tb6ltojOYMEBNrr
ny85Ehiaj/u111l09uMBYywfi4cf3tZZFt6DiXjZp/kpSflxl154wrNVNBQf
p6LmokaiYv56QzEaPKJ1vqAfkSe5H1J25IfnQ3IZbX4AeCn2UqsfopC5ET9E
InOjfkDPzI37IR0zt+aHtGRu3Q/400sn/JAaT6f8gPL52W6uKrO9CY+iwG25
CApHKKJ1qfGI73Nqin+uzkwNmcvyk4mDvazdMw55Nu5pRzJvPXOWe9l5Jljy
7DWzLGQuNVMN9lJp5hvwVL6TyplTCFUguzPR7wNxAgPv
                    "], {{0, 25}, {40, 0}}, {0, 255}, ColorFunction -> 
                    RGBColor], 
                    BoxForm`ImageTag[
                    "Byte", ColorSpace -> "RGB", ImageResolution -> 144, 
                    Interleaving -> True, Magnification -> Automatic], 
                    Selectable -> False], DefaultBaseStyle -> "ImageGraphics",
                     ImageSizeRaw -> {40, 25}, 
                    PlotRange -> {{0, 40}, {0, 25}}, ImageSize -> 20], 
                    TraditionalForm]], {-1.0000000000000002`, -2.}]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"invalpha\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    TagBox[
                    RowBox[{"ElementwiseLayer", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Times", "[", 
                    RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], 
                    "]"}]}], "&"}], ",", 
                    RowBox[{"\"Input\"", "\[Rule]", "\"Real\""}]}], "]"}], 
                    HoldForm], FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["invalpha", Bold], 
                    Style[
                    HoldForm[
                    ElementwiseLayer[
                    Shallow[Minus[2 #]& , {4, 3}], "Input" -> "Real"]], 
                    FontFamily -> "Source Code Pro", ShowStringCharacters -> 
                    True]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 9), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-1.2246467991473532`*^-16, -2.}, 
                    Offset[{2, 2}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"Output\"", Bold, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"]], Annotation[#, 
                    Column[{
                    Style["Output", Bold]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 10), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]]}}, {
                    StyleBox[{{
                    InsetBox[
                    FormBox["\"Input\"", TraditionalForm], 
                    Offset[{0, -7}, {-9., 5.51091059616309*^-16}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"timesAlpha\"", TraditionalForm], 
                    Offset[{0, -13}, {-8., 4.898587196589413*^-16}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"max\"", TraditionalForm], 
                    Offset[{0, -13}, {-7., -0.9999999999999996}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"sub\"", TraditionalForm], 
                    Offset[{0, -13}, {-5., -0.9999999999999997}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"logplusmax\"", TraditionalForm], 
                    Offset[{0, -13}, {-2., -1.9999999999999998`}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"rep\"", TraditionalForm], 
                    Offset[{0, -13}, {-6., -0.9999999999999997}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"expAlph\"", TraditionalForm], 
                    Offset[{0, -13}, {-4., -0.9999999999999998}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"average\"", TraditionalForm], 
                    Offset[{0, -13}, {-3., -0.9999999999999998}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"invalpha\"", TraditionalForm], 
                    Offset[{0, -13}, {-1.0000000000000002`, -2.}], {0, 1.}, 
                    Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"Output\"", TraditionalForm], 
                    Offset[{0, -7}, {-1.2246467991473532`*^-16, -2.}], {
                    0, 1.}, Automatic, {1, 0}]}}, FontColor -> GrayLevel[0.5],
                     StripOnInput -> False], 
                    StyleBox[{
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{"\[Cross]", "\"\[Cross]\"", "\"20\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    
                    Offset[{3.367778697655222*^-16, 5.5}, {-8.4, 
                    5.143516556418883*^-16}], {0., -0.17}, Automatic, {
                    1., -6.123233995736767*^-17}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{"\[Cross]", "\"\[Cross]\"", "\"20\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    
                    Offset[{3.889087296526011, 
                    3.889087296526011}, {-7.4, -0.5999999999999995}], {
                    0., -0.17}, Automatic, {
                    0.7071067811865475, -0.7071067811865475}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{"\[Cross]", "\"\[Cross]\"", "\"20\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    
                    Offset[{0.051030934720855216`, 
                    5.4997632534229615`}, {-6.500723193132873, \
-0.0017459426695960155`}], {0., -0.17}, Automatic, {
                    0.9999569551678111, -0.00927835176742822}], 
                    InsetBox[
                    FormBox["\"\[DoubleStruckCapitalR]\"", TraditionalForm], 
                    
                    Offset[{2.7478019859472725`*^-14, 
                    5.5}, {-5.266666666666667, -1.9999999999999993`}], {
                    0., -0.17}, Automatic, {1., -4.9960036108132226`*^-15}], 
                    InsetBox[
                    FormBox["\"\[DoubleStruckCapitalR]\"", TraditionalForm], 
                    
                    Offset[{6.106226635438361*^-16, 
                    5.5}, {-6.4, -0.9999999999999996}], {0., -0.17}, 
                    Automatic, {1., -1.1102230246251565`*^-16}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{"\[Cross]", "\"\[Cross]\"", "\"20\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    Offset[{0., 5.5}, {-5.4, -0.9999999999999997}], {
                    0., -0.17}, Automatic, {1., 0.}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{"\[Cross]", "\"\[Cross]\"", "\"20\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    
                    Offset[{6.106226635438361*^-16, 
                    5.5}, {-4.4, -0.9999999999999998}], {0., -0.17}, 
                    Automatic, {1., -1.1102230246251565`*^-16}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{"\[Cross]", "\"\[Cross]\"", "\"20\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    Offset[{0., 5.5}, {-3.4, -0.9999999999999998}], {
                    0., -0.17}, Automatic, {1., 0.}], 
                    InsetBox[
                    FormBox["\"\[DoubleStruckCapitalR]\"", TraditionalForm], 
                    
                    Offset[{3.889087296526011, 
                    3.889087296526011}, {-2.4000000000000004`, \
-1.5999999999999996`}], {0., -0.17}, Automatic, {
                    0.7071067811865475, -0.7071067811865475}], 
                    InsetBox[
                    FormBox["\"\[DoubleStruckCapitalR]\"", TraditionalForm], 
                    
                    Offset[{1.2212453270876724`*^-15, 
                    5.5}, {-1.4000000000000001`, -2.}], {0., -0.17}, 
                    Automatic, {1., -2.2204460492503136`*^-16}], 
                    InsetBox[
                    FormBox["\"\[DoubleStruckCapitalR]\"", TraditionalForm], 
                    Offset[{0., 5.5}, {-0.4000000000000002, -2.}], {
                    0., -0.17}, Automatic, {1., 0.}]}, FontColor -> 
                    GrayLevel[0.7], FontSize -> 8, FontWeight -> "Thin", 
                    StripOnInput -> False]}, {
                    FaceForm[None], 
                    EdgeForm[{
                    Dashing[{0, Small}], 
                    GrayLevel[0.5], 
                    Thickness[Large]}], 
                    PolygonBox[
                    Dynamic[
                    If[
                    Not[
                    IntegerQ[NeuralNetworks`Private`NetGraph`selection]], {}, 
                    GeneralUtilities`Graphics`PackagePrivate`makeOffsetSquare[
                    
                    Part[{{-9., 5.51091059616309*^-16}, {-8., 
                    4.898587196589413*^-16}, {-7., -0.9999999999999996}, \
{-5., -0.9999999999999997}, {-2., -1.9999999999999998`}, {-6., \
-0.9999999999999997}, {-4., -0.9999999999999998}, {-3., -0.9999999999999998}, \
{-1.0000000000000002`, -2.}, {-1.2246467991473532`*^-16, -2.}}, 
                    NeuralNetworks`Private`NetGraph`selection], 
                    3 + {0.5, 0.5} 
                    Part[{8, 20, 20, 20, 20, 20, 20, 20, 20, 8}, 
                    NeuralNetworks`Private`NetGraph`selection], {-0.5, 
                    0.5}]]]]}}, ImageSize -> {545.5, 151.}, AspectRatio -> 
                    Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{24., 26.5}, {26.99999999999999, 14.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {
                    TooltipBoxOptions -> {TooltipDelay -> 0.08}}], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = None), Method -> 
                    "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
                    True}]]}, {
                    DynamicBox[
                    If[
                    IntegerQ[NeuralNetworks`Private`NetGraph`selection], 
                    NeuralNetworks`Private`NetGraph`vpathInfo[
                    Part[{
                    NeuralNetworks`NetPath["Inputs", "Input"], 
                    NeuralNetworks`NetPath["Nodes", "timesAlpha"], 
                    NeuralNetworks`NetPath["Nodes", "max"], 
                    NeuralNetworks`NetPath["Nodes", "sub"], 
                    NeuralNetworks`NetPath["Nodes", "logplusmax"], 
                    NeuralNetworks`NetPath["Nodes", "rep"], 
                    NeuralNetworks`NetPath["Nodes", "expAlph"], 
                    NeuralNetworks`NetPath["Nodes", "average"], 
                    NeuralNetworks`NetPath["Nodes", "invalpha"], 
                    NeuralNetworks`NetPath["Outputs", "Output"]}, 
                    NeuralNetworks`Private`NetGraph`selection], 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{20}, NeuralNetworks`RealT]], 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]], 
                    Association[
                    "timesAlpha" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[
                    NeuralNetworks`Private`ScalarFunctionObject[{
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[2], 
                    Association[
                    NeuralNetworks`Private`ScalarSymbol[2] -> {Times, -0.5, 
                    NeuralNetworks`Private`ScalarSymbol[1]}]]], 
                    "$Dimensions" -> {20}], "Inputs" -> 
                    Association[
                    "Input" -> NeuralNetworks`TensorT[{20}, 
                    NeuralNetworks`RealT]], "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{20}, NeuralNetworks`RealT]]], 
                    "max" -> Association[
                    "Type" -> "Aggregation", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> Max, "Levels" -> 
                    NeuralNetworks`ValidatedParameter[1]], "Inputs" -> 
                    Association[
                    "Input" -> NeuralNetworks`TensorT[{20}, 
                    NeuralNetworks`RealT]], "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]]], "rep" -> 
                    Association[
                    "Type" -> "Replicate", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Specification" -> NeuralNetworks`ValidatedParameter[20], 
                    "Level" -> 1], "Inputs" -> 
                    Association[
                    "Input" -> NeuralNetworks`TensorT[{}, 
                    NeuralNetworks`RealT]], "Outputs" -> 
                    Association[
                    "Output" -> NeuralNetworks`TensorT[{20}, 
                    NeuralNetworks`RealT]]], "sub" -> 
                    Association[
                    "Type" -> "Threading", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> 
                    NeuralNetworks`ValidatedParameter[Subtract]], "Inputs" -> 
                    Association[
                    "1" -> NeuralNetworks`TensorT[{20}, NeuralNetworks`RealT],
                     "2" -> NeuralNetworks`TensorT[{20}, 
                    NeuralNetworks`RealT]], "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{20}, NeuralNetworks`RealT]]], 
                    "expAlph" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Exp], 
                    "$Dimensions" -> {20}], "Inputs" -> 
                    Association[
                    "Input" -> NeuralNetworks`TensorT[{20}, 
                    NeuralNetworks`RealT]], "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{20}, NeuralNetworks`RealT]]], 
                    "average" -> 
                    Association[
                    "Type" -> "Aggregation", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> Mean, "Levels" -> 
                    NeuralNetworks`ValidatedParameter[1]], "Inputs" -> 
                    Association[
                    "Input" -> NeuralNetworks`TensorT[{20}, 
                    NeuralNetworks`RealT]], "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]]], 
                    "logplusmax" -> 
                    Association[
                    "Type" -> "Threading", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[
                    NeuralNetworks`Private`ScalarFunctionObject[{
                    NeuralNetworks`Private`ScalarSymbol[1], 
                    NeuralNetworks`Private`ScalarSymbol[2]}, 
                    NeuralNetworks`Private`ScalarSymbol[4], 
                    Association[
                    NeuralNetworks`Private`ScalarSymbol[3] -> {Log, 
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[4] -> {Plus, 
                    NeuralNetworks`Private`ScalarSymbol[2], 
                    NeuralNetworks`Private`ScalarSymbol[3]}]]]], "Inputs" -> 
                    Association[
                    "1" -> NeuralNetworks`TensorT[{}, NeuralNetworks`RealT], 
                    "2" -> NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]]], 
                    "invalpha" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[
                    NeuralNetworks`Private`ScalarFunctionObject[{
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[3], 
                    Association[
                    NeuralNetworks`Private`ScalarSymbol[2] -> {Times, 2., 
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[3] -> {Minus, 
                    NeuralNetworks`Private`ScalarSymbol[2]}]]], 
                    "$Dimensions" -> {}], "Inputs" -> 
                    Association[
                    "Input" -> NeuralNetworks`TensorT[{}, 
                    NeuralNetworks`RealT]], "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]]]], 
                    Association[]], 
                    GridBox[{{
                    ItemBox[
                    StyleBox["Inputs", Bold], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]], 
                    ItemBox[
                    StyleBox[
                    
                    GraphicsBox[{}, ImageSize -> {1, 11}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline)], 
                    "CacheGraphics" -> False], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]], 
                    ItemBox["", Frame -> {{False, False}, {False, 
                    GrayLevel[0.85]}}], 
                    ItemBox["", Frame -> {{False, False}, {False, 
                    GrayLevel[0.85]}}], 
                    ItemBox[
                    StyleBox["Outputs", Bold], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]], 
                    ItemBox[
                    StyleBox[
                    
                    GraphicsBox[{}, ImageSize -> {1, 11}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline)], 
                    "CacheGraphics" -> False], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]]}, {
                    StyleBox[
                    TemplateBox[{"\"Input\"", "\":\""}, "RowDefault"], 
                    "SummaryItemAnnotation"], 
                    StyleBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"20\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    "SummaryItem"], "", "", 
                    StyleBox[
                    TemplateBox[{"\"Output\"", "\":\""}, "RowDefault"], 
                    "SummaryItemAnnotation"], 
                    StyleBox["\"real\"", "SummaryItem"]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}]], 
                    TrackedSymbols :> {
                    NeuralNetworks`Private`NetGraph`selection}]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}], 
                  Initialization :> {NetGraph}]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], BaselinePosition -> 
        Baseline, 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("NetGraph[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[35]=",ExpressionUUID->"7c09858b-ecf1-4d49-8ebe-ac9e773432da"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["AggregationLayer", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open = True), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.557, 0.557, 0.557], 
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["Max", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Levels\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"All\"", "SummaryItem"]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, BaselinePosition -> {1, 3}],
           True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open = False), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.557, 0.557, 0.557], 
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 ItemBox[
                  StyleBox["Parameters", Bold]], 
                 ItemBox[""]}, {
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["Max", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Levels\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"All\"", "SummaryItem"]}, {
                 ItemBox[
                  StyleBox["Ports", Bold], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]], 
                 ItemBox[
                  StyleBox[
                   
                   GraphicsBox[{}, ImageSize -> {1, 11}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline)], 
                   "CacheGraphics" -> False], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]]}, {
                 StyleBox[
                  TemplateBox[{"\"Input\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"array\"", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Output\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"array\"", "SummaryItem"]}}, 
               BaselinePosition -> {2, 1}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, 
            BaselinePosition -> {1, 3}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], BaselinePosition -> 
        Baseline, 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("AggregationLayer[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[36]=",ExpressionUUID->"78ed486e-6a1b-45a6-bf84-08156d2cfcf6"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["AggregationLayer", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open = True), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.557, 0.557, 0.557], 
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["Mean", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Levels\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"All\"", "SummaryItem"]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, BaselinePosition -> {1, 3}],
           True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open = False), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.557, 0.557, 0.557], 
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 ItemBox[
                  StyleBox["Parameters", Bold]], 
                 ItemBox[""]}, {
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["Mean", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Levels\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"All\"", "SummaryItem"]}, {
                 ItemBox[
                  StyleBox["Ports", Bold], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]], 
                 ItemBox[
                  StyleBox[
                   
                   GraphicsBox[{}, ImageSize -> {1, 11}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline)], 
                   "CacheGraphics" -> False], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]]}, {
                 StyleBox[
                  TemplateBox[{"\"Input\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"array\"", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Output\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"array\"", "SummaryItem"]}}, 
               BaselinePosition -> {2, 1}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, 
            BaselinePosition -> {1, 3}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], BaselinePosition -> 
        Baseline, 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("AggregationLayer[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[37]=",ExpressionUUID->"b260169e-00b3-4ded-805e-9d6d2771efcf"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["AggregationLayer", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open = True), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], Alignment -> 
               {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.557, 0.557, 0.557], 
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["Min", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Levels\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"All\"", "SummaryItem"]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, BaselinePosition -> {1, 3}],
           True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open = False), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.557, 0.557, 0.557], 
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 ItemBox[
                  StyleBox["Parameters", Bold]], 
                 ItemBox[""]}, {
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["Min", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Levels\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"All\"", "SummaryItem"]}, {
                 ItemBox[
                  StyleBox["Ports", Bold], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]], 
                 ItemBox[
                  StyleBox[
                   
                   GraphicsBox[{}, ImageSize -> {1, 11}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline)], 
                   "CacheGraphics" -> False], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]]}, {
                 StyleBox[
                  TemplateBox[{"\"Input\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"array\"", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Output\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"array\"", "SummaryItem"]}}, 
               BaselinePosition -> {2, 1}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, 
            BaselinePosition -> {1, 3}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], BaselinePosition -> 
        Baseline, 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("AggregationLayer[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[38]=",ExpressionUUID->"9a9db825-5f7f-44b5-b55c-0af28ee23f34"]
}, Open  ]],

Cell["Examples of networks:", \
"Text",ExpressionUUID->"8d01aa2c-2061-403b-b03f-1cea07e2fd6d"],

Cell[BoxData[{
 RowBox[{"regressionLossNet", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"regressionLossNet", "[", "\"\<HomoScedastic\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"regressionLossNet", "[", 
  RowBox[{"\"\<LossModel\>\"", "\[Rule]", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<AlphaDivergence\>\"", ",", 
     RowBox[{"\"\<Alpha\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<SampleNumber\>\"", "\[Rule]", "20"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellLabel->
  "In[262]:=",ExpressionUUID->"4f1625ea-9991-4d52-8151-f0cb8c2abbac"],

Cell[TextData[{
 "Train a network (note the necessity of specifying ",
 Cell[BoxData[
  FormBox[
   RowBox[{"LossFunction", "\[Rule]", "\"\<Loss\>\""}], TraditionalForm]],
  ExpressionUUID->"b2da59fb-16f0-4ba1-93f3-0e30db353384"],
 ")"
}], "Text",ExpressionUUID->"e3757f65-227a-4e69-825b-25547efa52c1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lambda2", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"trainedNet", "=", 
  RowBox[{"NetTrain", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"regressionLossNet", "[", 
     RowBox[{"\"\<HeteroScedastic\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<NetworkDepth\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<LayerSize\>\"", "\[Rule]", "100"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ActivationFunction\>\"", "\[Rule]", "\"\<SELU\>\""}], ",", 
      RowBox[{"\"\<DropoutProbability\>\"", "\[Rule]", "0.25"}], ",", 
      RowBox[{"\"\<BatchNormalization\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<LossModel\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<AlphaDivergence\>\"", ",", 
         RowBox[{"\"\<Alpha\>\"", "\[Rule]", " ", "0.5"}], ",", 
         RowBox[{"\"\<SampleNumber\>\"", "\[Rule]", "20"}]}], "}"}]}]}], 
     "]"}], ",", "\[IndentingNewLine]", "testdata", ",", 
    "\[IndentingNewLine]", "All", ",", "\[IndentingNewLine]", 
    RowBox[{"LossFunction", "\[Rule]", "\"\<Loss\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<ADAM\>\"", ",", 
       RowBox[{"\"\<L2Regularization\>\"", "\[Rule]", " ", "lambda2"}]}], 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"TimeGoal", "\[Rule]", "60"}], ",", "\[IndentingNewLine]", 
    RowBox[{"TargetDevice", "\[Rule]", "\"\<GPU\>\""}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"fb8c9bd9-41c6-4a8f-badf-513f11fe307d"],

Cell[BoxData[
 FrameBox[GridBox[{
    {
     ItemBox[
      FrameBox[
       StyleBox["\<\"NetTrain Results\"\>", "SuggestionsBarText",
        StripOnInput->False,
        FontSize->12],
       FrameMargins->{{10, 5}, {-4, 2}},
       FrameStyle->None,
       StripOnInput->False],
      Alignment->{Left, Bottom},
      Background->RGBColor[0.96, 0.96, 0.96],
      Frame->{{False, False}, {True, False}},
      FrameStyle->Opacity[0.1],
      ItemSize->{Automatic, 1},
      StripOnInput->False]},
    {
     ItemBox[
      TagBox[
       FrameBox[
        TagBox[GridBox[{
           {
            TemplateBox[{TemplateBox[{5}, "Spacer1"],StyleBox["\"summary\"", 
               GrayLevel[0.4], StripOnInput -> False]},
             "RowDefault"], 
            
            TemplateBox[{
             ",","\",\"",
              TemplateBox[{"\[ThinSpace]", "\" \"", "\"batches:\"", "9574"}, 
               "RowWithSeparators"],
              TemplateBox[{"\[ThinSpace]", "\" \"", "\"rounds:\"", "9574"}, 
               "RowWithSeparators"],
              TemplateBox[{
               "\[ThinSpace]", "\" \"", "\"time:\"", "\"1.0min\""}, 
               "RowWithSeparators"],
              TemplateBox[{
               "\[ThinSpace]", "\" \"", "\"examples/s:\"", "3191"}, 
               "RowWithSeparators"]},
             "RowWithSeparators"]},
           {
            TemplateBox[{TemplateBox[{5}, "Spacer1"],StyleBox["\"data\"", 
               GrayLevel[0.4], StripOnInput -> False]},
             "RowDefault"], 
            
            TemplateBox[{
             ",","\",\"",
              TemplateBox[{
               "\[ThinSpace]", "\" \"", "\"training examples:\"", "20"}, 
               "RowWithSeparators"],
              TemplateBox[{
               "\[ThinSpace]", "\" \"", "\"processed examples:\"", "191480"}, 
               "RowWithSeparators"],
              TemplateBox[{
               "\[ThinSpace]", "\" \"", "\"skipped examples:\"", "0"}, 
               "RowWithSeparators"]},
             "RowWithSeparators"]},
           {
            TemplateBox[{TemplateBox[{5}, "Spacer1"],StyleBox["\"method\"", 
               GrayLevel[0.4], StripOnInput -> False]},
             "RowDefault"], 
            
            TemplateBox[{
             ",","\",\"",
              TemplateBox[{
               "\[ThinSpace]", "\" \"", "\"ADAM\"", "\"optimizer\""}, 
               "RowWithSeparators"],
              TemplateBox[{"\[ThinSpace]", "\" \"", "\"batch size\"", "20"}, 
               "RowWithSeparators"],"\"GPU\""},
             "RowWithSeparators"]},
           {
            TemplateBox[{TemplateBox[{5}, "Spacer1"],StyleBox["\"round\"", 
               GrayLevel[0.4], StripOnInput -> False]},
             "RowDefault"], 
            TemplateBox[{",","\",\"",TemplateBox[{"\[ThinSpace]", "\" \"", 
                TagBox[
                 TooltipBox["\"loss:\"", 
                  TagBox[
                   GridBox[{{
                    
                    TemplateBox[{"\"Measurement: \"", "\"loss\""}, 
                    "RowDefault"]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"]], Annotation[#, 
                  Column[{
                    Row[{"Measurement: ", "loss"}]}], "Tooltip"]& ], 
                TagBox[
                 InterpretationBox[
                 "\"-1.09\"", -1.0852490305900573`, AutoDelete -> True], 
                 ScientificForm[#, 3]& ]}, "RowWithSeparators"]},
             "RowWithSeparators"]},
           {
            ItemBox[GridBox[{
               {"", 
                ItemBox["\<\"rounds\"\>",
                 DefaultBaseStyle->"LabeledLabel"]},
               {
                RotationBox[
                 ItemBox["\<\"loss\"\>",
                  DefaultBaseStyle->"LabeledLabel"],
                 BoxRotation->1.5708], 
                GraphicsBox[
                 {AbsoluteThickness[1.25], {
                   {Hue[0.083, 1., 1.], LineBox[CompressedData["
1:eJw1WHdYU2cXR7BFq3WAVqkTUJSqVIaKUOUKVK3iFhQXChpXUQpWcVAoCHWL
goW4QAIoGxICYYQTglUraRFtQW2pGCAh696Lo46qfO+B9+Mfnvvcd5zxG+fG
Nnjvym3mZmZmU/uYmeH///8ZIiPUw/J5L8Pdipf25gwjEGQvPZnWSp+XM/Uq
vx+DWu97bS7+mZ9hsZbZJhAE/Xewlr7fzEx3dZUsCtwG2XMmP88338oIhcIG
O2cF9K7fwVwSCj1fpNTBKPuP2BqLbxly5ZyjG+5B7/4w5qJQ6Njv0QNY2Pe7
fTvMw5nLQptN8gEP6Xn7mPlqf7fkfk1gceDJd13m+5nfVao3l5+20PMjGRdX
1737m55AjW7J3kMWh5jfVCrFzlst9L4j5L6YqP5JT+HghupvLfr+QN77Jecs
UNP7Y0i8NsXNFa1wcfvwGfPNf2ScXV2fs8PVNJ5YjD9ZvrgNXqWrJCfM45g+
ZjE3npa20fiOkvhtnJZNbIfVj+NcGszjGVWQ2PhFWRuNNwHrNT1+XxuIrT1L
rC1+YszNYn5Yo26n8R/DeI8Xqdtg8JJnX661OM5sFzjYHV3aTvM5Qc5/lDZn
UDuEJuQUXrY4if0ZKt7dQfM7xZDyR2sD2uEubJ721OI086G7e9qL0x003zPk
/FOxW5rbYdKbEfkT+54l52sqtoztoPknMqLKMYu0jR3gLSQFiE0k+yFvItnf
W49zTHd39Dj1eg10zahbvSb2HKknkzld0k7rc57EI4i68rAD0u+PTT4Ye56s
9xozIa6D1iuJ1Ddw8XCJBpbuPfTgUmwSxj//cj8trV8yiW+gpXeDBt4PaLKq
iU1G/Mx7r9HQel7AZ/N2oQbybzivbI29wLilL8mDeVpa35+ZrQKBp3OiBtZ9
ffqcedzPpN4ObTKthtY7BfHmy1tqoL+6896EuBSCH79FzHotrX8qOf9R2bXf
tSD7wXfIgrhUEp8m39taS/shZFQq1ULmgga2j0pftjNOiPX78JrE09ufi2S9
wydPErQwXPbfmZNxFxk3V9fxWbadtF+XyPpsy+xZWri5es3vBXGXGLX/hLEF
7zW0f5exXqHfx2khokv86b24y1jfwNynWtrPKyTegbf7cxqwPTNoybO4Kxif
sfillvb3KuJPapXTCfe+2HVq2NGriM9WF7mW9juNPDOWzIpOiL79S/3Mo2kE
f4rvg01a2v90Zoar6y+jSjphhDgxfqp3OvIlYH+wluIhnflz3e7TqQs7YU/M
3Kw5ynSSj2B31N5Oio9r2M/80YN18MtS482l3tcQb2/VY3UUL9cIPyNaj4zT
wZgxF9uDlD3P3TXiToqfDKIvKo/twTrYZ1jQ9zvvDDz/rX2ijuIpg+DbdXz4
806oJ+HGKjOYHYJsXjhXT/Elwn4erp6lA/tjIp8kbxFzJFa0LGCanuJNROoT
OClhog4OBawIyVSKsN4hcQk6ir9Mcp4g7M1NPTRO6I6VemeiHgx0u6ejeMxE
/WtOeKMDx+f5GbeUmcjXf8LNdBSfWdiP+1+90EJM7Tpls3cW4q1UX62jeM0i
eiKxi5+ph+az/dSdSlyffScgU0fxm81MvzXygcdyPXy5qazPW+9szNc3O6yT
4jkb6xEUn9sJCVO32g6ow/fP2zbl6Ci+r6P+dUQ+1kPL26HzRvtcR74cDavX
U7xfR3yWh4bqYMavBFB11zE+qe0FPcX/DdS3a7799XAqJTRmrs8N3O/s6G2g
fLiB+tWSuNII7dsIAepuMHNqG6dY/Kqj/MhB/E3yG2kATzdygU8O1schpEZP
+ZJD9MTr+NQOI5w3JwnX5WB+cUPuGCh/clHvdhdtMoD+HmmATy7Rf+H4W556
yqdc5Ge84rYB5qURQNTlkvgVhiJyXy+/8lB/Op7wRkgl4Wf55GH8kx2uGCjf
8hhHqyLxCnMD8J5Om8rq8ki+gS893hko//IJP8zC+5B4Fnzyd9Rtn3zCX4nX
/jVGysd85EPekXIDXH14/MrDunyST7T8MxJvLz8L8H3g5oUm+Dd7llznU4D6
cCx8mZHytQD188zgLAMs+b7j77d1BVif7OYRRsrfQiZVKCxh3xsg0yfp3QDf
Qibq12cL4jKMlM+FPfyuu2+Cd6S9Y24WErw6LPNzMlF+FyF+V5yIMcCqVtbT
ybcI8RtfVWaifC/CekX4PjVCbuHl9V43izBf3VA3E+V/Meb7UvjaCD8Sek+2
K0a9bvhri57qQTHiJbHd2QQFE4/8Nj0Yn2OmtH5kovpQzAwtspsXs18PDweu
2jg7o5hJEQbaZCuMVC/w/Od7RjUaoe8LR9M8dTHytanYjqX6UYL6ukm3zwTT
/zKLWmRXgnqQcGoiS/WkhOSnGRHgzsJ6ZfPAVcEliAe1+SwT1ZcSgn9J47FU
Dn4icFifUYL6d+LAXSPVmxL0e3lAqBEkJJ2t6hKm5TD36RlfluqPGOvbIvjc
BP8cIA2xE2N+JwZfZ6keiZE/04zhLHwS5Or3fTA+Czyu5ZmoPomxv2GT5CaY
OZ8AKENM9JUpVkk5qldiZpdAkBR00ARbpj3dnaDuWV8xgdzXq18Swi+NnV8t
C6eHEcDbSfD+1oxGE9UzCeLZ85c5JqggdEgJljBxokl3ppH69+pbz/rfZjUR
fqoJQTMkiC+rb+6zVO8k2N8cd56FIXe/yruhluC8kNXnrJHqXynBn80wXsbC
VyVEUOxKsT8zT1wyUT0sxf4nb1IZYXuq/m5FcCnu/+vJPpbqYyn27+xXq1lI
iiYCmFGKenXiwW0T1ctSxvvSx/mznI0AAnKAGve7Thq0i6X6KcX+HXCsZEFP
5OCBnRT753hyDUf1VIr9v320ioXPZpACB0uxn+mdHjzVVyneb+/+NQveo0nD
M6SYz9jZ2SzVWyneN4cfzUKoBQGgWop+Jx3Vn6X6W4Z8+ZB2lQUhSe+lXRmz
q0AaUO/FUT0uI/00M65qIHhsvPbNh+AyZqdAs9FyB0v1uYz0s/tT+RQWeFnk
o49FZXif7coXLNVrfB8d/mo1B6OJHA5uw/uEw63HcVS/yzH/HTnVBI8/ObwZ
YV+O/IwvfM1RPS/HerbIVSxE7Hl/bHxIOfZzfWeiiep7OZMUOfzpoWUspPn/
MdJRVE70zcZ22nmO6n051mNySgAL9aT9zm3liHf36scs1X8Zrk879BcH/9rH
unvYy7DeMx/Z89QPZD1+ISP52Q0IvOMdIsPz2h/356g/yJDfCw9b8rCU2MFi
kQz1b87QNJb6hYz051T0dHMeDj76uHNVm4xZFvbi7xQnnvpHBeYfXrWRgyxF
y4EN9hU9firayVE/qcD8lzRKWWi8Xmq5LQSfNa+Na1nqLxUYr3En8Zd3hB6h
ogqcJ4faPueo3/TsXxaxjoXJ+4Mn7W+rwHnA+oTKRP2nEr8nNpwrN8HqjbPL
f7CvxH6Fbu1iqR9VMgdv7FmTtIODaJLuTyGVqNf5O45x1J8qyfypafjHmoW8
Kdqms6JKnBds3OM46leViE+XKHcOmq1qBKltlVh/i11NJupfVcin+d7DeTB/
m/xvun0Vqff4VZGkXr1+VoX9bln40gRORD5yQnC9dezBqTz1tyrEU4JbPsHj
He/PxKIqZnnYi325hF+9fleF9RoE2RzEF9lkV7ZVoT44vZSYqP9V4/eXZQrJ
p4TAoc6+GvEb+SqFo35Yjf2refs5Dy1RxFBCqhEPd3Y3c9QfcX2E9IUND/22
XfX/Q1SN9fNfu5ylflmNeHGcwrDg5kcMsK2a1GfggBJPlvqnnCmQNnm0O/Ow
mchrh70c9TNrRgNH/VSO92f13cPDyc9JwCFyUo8I2yApT/1Vjv3OhbE8lPch
BRTJcV7Ze2wQT/1WzjSoVJGBjzloI3TpbpMjHv7dTvjW6781+D129l0kC4Pu
EYBNqMH5NXD8dzz1Y3z2KyyUceBRTgC/tYb5uHTn+A9OLPXnGuy3fx3pj4Ck
PzKzBvMfk/6OpX5dg/ie1sBzcI7Yj217Dc5vH3n24al/A/bfedEnHMi/JQI1
ARgLs5hXE3dx1M+BzEOBsETJgW4VEcytPevLPrPmqb8D6v+k0fE8DCNy4pkJ
RN8iRlhc4qnfA6mf34G0eyZg7IihtANzOFZkmejFUv9XIJ4tVgR2QdnRIhsH
KwX21+rCfo7OAwrEy6Y9eh78Xl/c8oWLAr8n3EddN9D5QIH42TBkOQdqAk+n
lQr83mFLBnTReaFnf0TONR5Qbl3Ce9a3tIo5Oj/gfcyQ32U8fErGh1nnMR6b
hI4qjs4TCubtP4ef+LtwILq18EdPsQK/z18d/8DS+UKB9VxrnsPDbA+3X73u
9zzvccvl6bzRs35Xy1wWGgrGDfV9hu8lGzJSeTp/1GK/M3ck8LDNdkDgQqta
nH9a5fU8nUdq8XvudDzpP9LTz6UW9XmoXm+i80kt6r/VPuIXicRulq+sZeKH
eIfNndxF55VazDfxCNFXB1IO/3C8z2+e7meezi+1iMe59aR/1ZwsMvA83m9T
W77cQOeZWsT/ge5MHlaGZCo2invOW+z7eRedb2pJvQIXhCZ3QWfT2X7B93G/
sMS/hqfzTs99Y7YRP4hadHi54Fkt+jto13F0/lEy7yfWj/Ml85M1kaddVkqc
R6SLo1k6Dynx+2BxUAILOcRu97goSTzGk+4ju+h8pES9fi9ZzIMXgUvESiWp
B4hn3eXpvKTE+V5sa8fDnyMdww6EKxE/4W/qeDo/KbEfZ76Zz8PuU8Nkh88r
UR9PjdLydJ5SIn5y7bx4wN+qYsR4nyB89kAe/geVsayC
                    "]]}, {}}, {
                   {Hue[0.59, 0.7, 0.75], LineBox[{}]}, 
                   {Hue[0.59, 0.7, 0.65], AbsolutePointSize[4.5], 
                    PointBox[{}]}}},
                 AspectRatio->Full,
                 Axes->None,
                 Background->GrayLevel[1],
                 
                 BaseStyle->{
                  FontFamily -> "Verdana", FontSize -> 8, FontColor -> 
                   GrayLevel[0.5], ScriptSizeMultipliers -> 0.2, 
                   ScriptMinSize -> 6},
                 Frame->True,
                 FrameStyle->GrayLevel[0.5],
                 FrameTicks->None,
                 GridLines->{{2000., 4000., 6000., 8000., 10000.}, {{-2., 
                    GrayLevel[0.8501]}, {-1.8, 
                    GrayLevel[0.8501]}, {-1.6, 
                    GrayLevel[0.8501]}, {-1.4, 
                    GrayLevel[0.8501]}, {-1.2, 
                    GrayLevel[0.8501]}, {-1., 
                    GrayLevel[0.8501]}, {-1., 
                    GrayLevel[0.8501]}, {-0.8, 
                    GrayLevel[0.8501]}, {-0.6, 
                    GrayLevel[0.8501]}, {-0.4, 
                    GrayLevel[0.8501]}, {-0.2, 
                    GrayLevel[0.8501]}, {0., 
                    GrayLevel[0.8501]}, {0., 
                    GrayLevel[0.8501]}, {0.2, 
                    GrayLevel[0.8501]}, {0.4, 
                    GrayLevel[0.8501]}, {0.6, 
                    GrayLevel[0.8501]}, {0.8, 
                    GrayLevel[0.8501]}, {1., 
                    GrayLevel[0.8501]}, {1., 
                    GrayLevel[0.8501]}, {1.2, 
                    GrayLevel[0.8501]}, {1.4, 
                    GrayLevel[0.8501]}, {1.6, 
                    GrayLevel[0.8501]}, {1.8, 
                    GrayLevel[0.8501]}, {2., 
                    GrayLevel[0.8501]}, {-2., 
                    GrayLevel[0.3001]}, {-1., 
                    GrayLevel[0.3001]}, {0., 
                    GrayLevel[0.3001]}, {1., 
                    GrayLevel[0.3001]}, {2., 
                    GrayLevel[0.3001]}}},
                 ImagePadding->1,
                 ImageSize->{302, 182.},
                 PlotRange->{{0, 9573.5}, {-1.6830000000000003`, 
                   1.6830000000000003`}},
                 PlotRangeClipping->True,
                 PlotRangePadding->None,
                 Prolog->{{
                    InsetBox[
                    FormBox["2000", TraditionalForm], 
                    Offset[{-2, -2}, {2000., 1.6830000000000003`}], {1., 1.}], 
                    InsetBox[
                    FormBox["4000", TraditionalForm], 
                    Offset[{-2, -2}, {4000., 1.6830000000000003`}], {1., 1.}], 
                    InsetBox[
                    FormBox["6000", TraditionalForm], 
                    Offset[{-2, -2}, {6000., 1.6830000000000003`}], {1., 1.}], 
                    InsetBox[
                    FormBox["8000", TraditionalForm], 
                    Offset[{-2, -2}, {8000., 1.6830000000000003`}], {1., 1.}], 
                    InsetBox[
                    FormBox["10000", TraditionalForm], 
                    Offset[{-2, -2}, {10000., 1.6830000000000003`}], {1., 
                    1.}]}, {
                    InsetBox[
                    FormBox[
                    TagBox[
                    InterpretationBox["\"-1.\"", -1., AutoDelete -> True], 
                    ScientificForm], TraditionalForm], 
                    Offset[{3, 0}, {0, -1.}], {-1, -1.}], 
                    InsetBox[
                    FormBox[
                    TagBox[
                    InterpretationBox["\"0.\"", 0., AutoDelete -> True], 
                    ScientificForm], TraditionalForm], 
                    Offset[{3, 0}, {0, 0.}], {-1, -1.}], 
                    InsetBox[
                    FormBox[
                    TagBox[
                    InterpretationBox["\"1.\"", 1., AutoDelete -> True], 
                    ScientificForm], TraditionalForm], 
                    Offset[{3, 0}, {0, 1.}], {-1, -1.}]}},
                 ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztXH1snVUZf3c/etvuq2WMlTFlGDGDqQzkY4DgIl8TBkxDZAQ/tqBYDEgD
Mwwy06sDGtkfWzKXksxYE4gNGaOEEfvHphMIqcmMFZaszAWrqabqdDUWUqXq
6+95fs8579u7e2233oPbct90d+ec97zP93k+znnvvXXd+tavPrBu/X33rFt8
00Pr2lrvu+fhxTc++BCGsjOiaMZ3oyg62hKhHaOl/+R6Cv+iKCPNYrHYgX8z
dCTKckQ6q+Ujy440byvp3z7J/WvwMaMG+f8E+dChQ1GMjyfw7/TgqAa5BrkG
+XSFXPNXNcg1yDXIpwrkmr86XSBfqP14cJ/1m4JhusBj2twizeZgmGYS09hI
PD4mzYXykZPOtiVxexQf7g2HO+dxA9HONa4/0BP3tkkzw/7IoM2fzf6RAaog
yhPIvnZ5Hn89a+d46g90k87pU301sY4OT6RaxSXNhvJcDfcLSduWsF8nLKEP
3nCBg962Rj+vvyvFbdcKmTcy6J7D3E31ceeyuHu1NMbHlOtZcd8WmYdHIQu0
cUEOIAoYMLlKvF9FmoClowkSoMTVLpUR8l7v54sqIfjDvdI+0J0BhTCw3a1C
KVcNuVNg8Z4NYt3jY+S8IR7qk9v4AzpwjU/AwtTOZcoCkKNDnpVtPlcX71gu
goEcMR23D3SbhIgXdyEPGDMVAlGhq5qoioSuSFvH/s5Iec7SgHlLP6Ab1cpE
a1EedH634I1f64hMZmBIWZFRtLcsli6AsnG4l7znE9sHADydIzSumCMDDhpk
wFl4HPfQgGyoLgDHyjO9unmOKkrK+jPQPTE/cCWhQ7/QAZpzSTuM1blSzIUi
dfS1DlE+r74tblVgqGct6I3O9KuGsI1ycMK+zs+ZCaofUA2ofYB70ACOYQ3P
rJTGUF8uveoGelIWjYfxAIWvXhhCU/nWiRHRmiB+tT6V11xI0ggHODVcwQTN
oI2Z+zvlEfCni4O6yssMJYSWnfICutjpBWYJBNCAKYDJVUDdqPrQOCG9LI+d
f1XT0HgWFWyJOL3If46uBplLIyEbJBufqqmJlt9MaBQUJYBlq0IjtEZRgr9o
yRSZOkBb3UBE26X3HO5XPAXRCmmAnrha4CdMmxAJBNjbZlR/r3i/UQ0V0CvA
XoB8cwsmqxbgi6geoHCr+GzTP2MjGtAkjBCToArAJ25wtkMEaQ4ec/AJ2OSH
QN16zXok9AuzxW9wYYNriJEwIDJQiTbublsia2OibletWhW9LB/ZL372hkfv
uhKfUYP2n/rSJT+69yOfu+3maJb277z9plV6RfWuv33dx374lSWmrdY7Vtj9
rH584/PX4mHfL2D+41+4FE2MHn2sgGfQjTJy7wy0/vmtDHCj9+ZD83APXTTQ
ffubc9Dte7AFzww9MguDuLXzax/GI8Tz46+fiwkgPcpJvwFEvfLAwhdbzwMe
PLzjnqVogEz1PQASzd17/wfQATDMBxi0H77zavD61vpmjr+zMQ8kaAMWKcwR
L/5AiY40tt99BZ7506ON5AQEoOG7OqcJyMkLPiFPkM02GrgP6KQcTwE+EMu9
DMiLBAoEhj88gBtbvnwRRnCHaDIArFJvIiRcZAoiBCTQT77wSSQUElSidM3D
NHTBL8YxGePghvxSjZgAIaIBCqgWCPFY65mKZ2iKXdTSpe6s1+c8OX64aIRe
Bv/l6ZCZkDB2da2gRy3IKqLLwoLheoXPyHlvjSEsoyMDFtcY+Tn7mZW01jk+
sbHVjBWC5coGFiZA0FmYP84KFE2f+HydRQVcpKRnbcZHD6xYF/caLLeiO6Ir
pyQcJPXXhAHHQd+MhT82kpEkqV5G6B8YYHELmIf7lds5IkXMx+MEChYwh64Q
C57JHvzs5hbFNXuwfbEPd+ZwSR9YxjhrBMg5A19hXhr+D5IAHo0NJkmAdPlG
k+WhuEAYAaqgTUu4KFjyODpsMRRypup4i2QM9WVLrEP6J5YpWE7sc22FPMui
M3MkcoULXYzDoapYMvTjjD6QDGSCbEGfn2kxiPkP2+QfeMDDUB/nfUBGadLO
PiyKY5CmQ0P1lgnkTCiADcpk5EKbMWag5+liK60KhpMzOwH9/V1K7XzpMiRy
HBeoAw7GHZDmY5smA0mUwSeoNqvGwwxLlJFFSJfTbHO+3iAhulllQeOADKjr
/Z0FLn2qFbOJ1E9jgykbOAfaA91QneXmrOKI03mMnMVzXQO2ssGeK+iYCSDx
yNtaIQ+ofcyOGV7TuTDErZ8at/Pes0BsFAzVB803VLTBetJxcFfRX7sOmoc7
8monOtK8tsQyb6bMgN+lms8X7wCBM7mmIXd4AjCGNQQa6I1ITxxbYaLGk3gY
51JERl7Pu1tpiw1JPsRs3RuJy7QaRdaghdmbKkNu4wHQ2L06S9sgIRAiJIRx
8RAYb5YRZtl4hKmpcz1D7YukwUQFYOl6IFF90mXW4Gtfe86vLlo+cx/6ZhgL
KFOIKVug6Upu56SAi4ktjNCzqZmb2qz3BOapuVySCsXvDeTpPsAOoAAt/S+M
1VPUs9b8lCpQ4qJFHxKvJmaUajCgdzdr8SaLyR1N7kmfDY6PZTlCbajiCxyh
t9dpjRVtssGcHeyv89UjrmqsbI3LUpx47lPSKMSu4kp2SjJMkPWZ4fYWtwNR
Z5onI1ruqGznmZvDfC58zoGaWG/Tm1ECDLtk09UKeZmHIToXFzlV57iBp7Fe
qBv6G1fPNxhXMEDMgJH6rGG431mS+lBRxUBPHdnl6mdFxgAAL5IlfzAFlruE
OjpslabXO8TUs5aVwJlJZKSpUaS0bC4FYODKizWAUMbq+iz/wS3MAUWY1r2a
Ma3epvKifW2SwXyJZo1DIgTro8OZtK2plTZTuy50m3adzyeceRVtjbXXkVd3
dfprF2yOlxng9eXtDTyxgjd7A5W6QJ29QWEQqqta86Z71kPOg9SLcNCHJiAo
iATWBVEbn7NMk9QNxulE6DcYBcyHFsy3aqYkfAMs6iqzMjyDG4wGUD5FxR0E
2xOho3ZeVyARAxcBeFgQu1xkU/1A+xLHI92sW7P1Sa7I+IylAFp2rjHboz/i
BV47mmylw2TUsqIWjyUt2RJ70EwcwgVV5mf8vs9wv1kD/QxmmG64GneuQZox
Va9TqvWlsatZSZvRwj2NOL1/u0lyQ2Ku83mgKdHiRF6sWecZXXnqQTeujBkm
9Nz7wDgk5HaANB4yaHnrwMgmsSaXBwAvIGEIeqZh6M6hYuGqpivxWRuXfpzs
lKXWzwLH++PFjdI8I2UNArfBr3V/gZKPltfehMwYYmNwVZsxuM41OJm6WDkN
7V2Ytgsnx1SEkjxR4zf3N+juuN0RxxZ4MYj0LJNEbG60ailhDpzbFM6/z7Y4
rsK3sohbaOjShUHEh3vJp2Z4TNkZo4leUwS33gApZX0zxQK4mUqhYvkBIL00
2qDWojwBgu+FJXIprTnq/bpmtsz55qORyVbWQD0laplkOb95oV+96n6cLXv9
gw2KG4YL6SBaWJbFHUbdqky8HfMj2jhEizzEKgDQSmlo2EBwT+o1hk4Iw+cq
ncsaSTeUy5UyPraAK8htx8qFNsiGHqYoPwZBcGDyIz5kA5Xlx2rv4K5Ohp/o
uhLIttfrsxxdK7OTfAUiod+kkXn/DRNxVY9uj3LPlAZBS+zbYnc7ZKfD4hSL
OC2cMymb6Gtf7s4ffDwDKs1zJu54lmq/gqSYH2ANLExbB/KfypIqrZtn+7XN
vtk86FONOkz+vvKzUOyOyX7sKinKjKJhzuFzZzoEhlBfgkHYTAt727Je77q0
na8DDaow289PzobipIrIGygKE5zfOInkzo+dLwA6QDlOSeXECmAqkMf+TqOT
3AK3ZW0uAstUl4s2JkQyVsBEcJvRaaBnQl3tPGyjpcv4UztMCnttW3T2dU3p
6aHCKPhNcBljCYzIPpmUpn7yPYs8kzuYjJogcPu9A9awB7rdGRt5ByVc1r1t
luNTis5UGG0LVJJPV8UkNMI6OfvtLvB0Vjn+6+Qp7u5TdEN9N1WN9wZaBDCA
ePztXGNelHoEZUxA9rWbL+Zppe7UZ9Cx/JHZJyXInSmuIu7ruao3a2EwycuY
4/gMY+qn5ZXfLrlVPrJvv/H6Ib2ijHzU/e715w656ze//Ok7T1+TeXf75VF2
dMf1R3oeppqFPwz+5zsF/OGG8rbgL8/fj2f+8JPtw72Smf39B7f88eUiGr//
2fd/+/MXMf9vz96FLhD8Y+sFeHBwfy/nYxCfaIMWUpHF1D+/9Jg0847KXx98
U5rvVXwfZlWs3sqH+ZFBucF9Ui4cmCMdE2RObdFVwepooNAL7Icn4gByuNdy
UK5NmrI7ec7briohIovLeg9ByVsfRQQz/3Orojl355j9To0IWjW4Pn21izgF
bkzaRg2j0Y7lLhfQlwlMRpCOnaPlbBwMjI/ZzoSPoz1rJ+znazZRuqd7ftV4
/iQhM+l3J2HNSUXjtvisXoAv4R4ZXWJH0zjqCU2MXPzlPnjMmtfHU5djpmqt
0uz8xHm4mJCBlvWveS1QwmqPjnvPhiRr5m4b61AeKYCfPRt0bzjLWdyi040O
ObHEXOYb0O1ZXhusrz9RNU6WknK/60Hiu1aYbFkNO+tqsKwY2Sl1wjoKJGuk
2NzC3Rst0s0X6qsu6ew3tf9mfT33kaZx6XexLqkal5aH85gjeePEb6ZDcVAK
iy6wCH5z9P2Ui6rFdl25Dx3rfjXWFJNTviswOsx1lH4f5taq8XCefGgFzDzF
bUQICSyi/Q4deGG3e7VSVBAOMJm6odKSSgkmjCWCnKc0a8xOQuuJ87IoduuH
My3r4Z4Z/RIWEgjRc612nqDkzT+58tVVwFjvupFs6z8YvZq1cMs6dkd7auRm
GdxxAQ88/eRS0dobzEitkwFHZwajscUwaOFsGyWwdqwmEKNRTS1azZtkmf5Z
+SJ//VAw2jTXyVsSjD/1Cqm9OqoURDEqYJ5uSqTetYPq0Q9HofkeLhsYm6T1
Ueq9O5omE4rdrbZS3ItKXJtB3hyeLx+NSKEgl7Fty5BqIQVDLid1fm8HsimM
yNvF91bMprRqrjO/5c+efYQHD8xqSr1t9WTb7Clot5eF6KeuDIaxiRj9Nh8P
hDuXXRUWo3tvK8lNWGvH7l2rgLzy/N4f242PheNV37LVKs+/BccDTHiZq4Nh
1Uq+3t6HZeTmWSQixehwYLwFO9nmnwv6lsuGwGoVun89QANN9KnQ+FgfgT89
2wuPj3l9rFtwqG+C4+PWDa+xkYD47L167rYj1n06CCYNDvKRQxhAeQ5kUqpj
5JGK8cB2f6FgbuAP9YWhTTp2SsK9YbpiSD0wvtTpWEdT6Z5y1XFxf0eLpHC4
7C0Evi3K/brdrcfsl1cdH70PCw1UeIHxZe2lbFjIDcEw2akSs/dnVk66pzpt
TE6G4TG5L4iEx8RcA81wmOqIiRa/Z0M02f7vtDFxawZ6CoNJt2R1B5Sbr8ji
9VuBGyv6aaOL5w1ohpWAvB20MhiG5NSDZ//BMfFc4nBvQExWm7KqQa70mdCY
GK5Hh8Nj4ldW0AyOCckfvxcVHBO/KRMUk1XUzPngs24OjYk+C3lzcEzuVe/w
mFjZwcrDYEq+6/KLtvnvbMxLM8ZHO/79T7q8pQaXgLrIsJiSb9bSUm8Ji6mO
lvpKcVVRLnnfo/R963C5pZ3K798MCt741T6Zba9MWRMUTPbmxjSxF+KX7gb2
o3ay4d7YChfRDeuz1/2rWFfyamd4rNvOH9n0wfcda8fco08uTZSq+q021pke
q1z2vfXbO4tFb9bVzjcKEzByu+21Dp6Qh8LCU0dkwkGx+IgSBgvfe/jrc/cC
i7yNILn2tyfm2nUT6NGdr9LTumnSMhHDjuXxlsVBMeiL0OEwjI8x1Q2HgQFp
X3s4DNyK6u8Kh4EF/+C+cBi4dIb7w2HgBtrIYJUx5BMM+prOMfOrB19LmIDw
u1bICXo4+FsWy9l3GPhwg/9+Ys7ojuvVK26a6BVTNLCuDcSjW+qh4Luf+wgF
3zmSUPCdGwkF3zmRUPCdC6k2/JzBVwcy2bMnIWx1TIFgq1OqwU7Dfu+pc97d
frn4uccn+jmHWx1tIL5Cwu5ogikFgq2Ovwa7FPa+9hrsUth9W8LB7u+qwS6B
LWf8lX2ZJgzh+AoJe6gvHOyRwRrsUtjjY1WGnfWwQ/2CZzjIm+pDQUaNWIPs
IL+1vlnPWp4of9aCejcQR+Eg97ZF9t3QSX5PJtz5hp1vVvztkPcPc/Az3NMK
k/0WQOrb4+Fw8a2I5JvW4d6KOHl/vfn0gVz7RfEa5BrkGuRTBXLNX9Ugn4yQ
7VvckirLpQ9FBc2aYz9q73XYLwVMaTRXQgG/WefeNTo+WFPDcHHpLJkWAI++
AJdPoQnEzxLOKldTHfOs5tGFklEqOTpW59SFAGZ1pE/PL30lzJpTHYxKvymt
WM72Go+PB9jUMKgmFk2Ym2CbFqpSTBcRU5oVUQwfqyqmC5J1kthKUwV45UGW
Xef8tYTYKZ1w55eHNeXBYzSicsp6k6U3OUsQTg9RBc2XTi1WH9NF5TEdH9Ap
Yaqg+cm0ne6U1fylMdeht9fpEl5e6+nVkVonAfSeilYZ+ViQYK0mV4rrnJT/
DSS9UHq/TD5akvkBNHGO03TVFF5eC1m1XvVbGiXD+K1F5Q335F/lUltcLB+L
Dh3a29W1137wam9XcesL+6W1/4Wt1ko1pzp4hUBeKN3i1q1biw789GFmFaR0
o6z9zMO0gEaXeRkU00Jge1qgP67fLxZgcsmQ/rJXUwUI5YGUXaWatdalU+3U
dwOqmk9aBq6zwmSsiiGXTNp1MFT2nc6Kw/DCX0tKdourkXefivXhqQZZJC//
P+nvyOSnSlrRjP8CHsZghw==\
\>"]]}
              },
              
              BaseStyle->{
               FontFamily -> "Verdana", FontSize -> 8, FontColor -> 
                GrayLevel[0.4]},
              
              GridBoxAlignment->{
               "Columns" -> {{Center}}, "Rows" -> {{Center}}},
              GridBoxSpacings->{"Columns" -> {{0.5}}}],
             Alignment->Center,
             StripOnInput->False], "\[SpanFromLeft]"},
           {
            ItemBox["\<\"\"\>",
             Alignment->Center,
             StripOnInput->False], "\[SpanFromLeft]"}
          },
          AutoDelete->False,
          ColumnsEqual->False,
          
          GridBoxAlignment->{
           "Columns" -> {Right, {Left}}, "Rows" -> {{Baseline}}},
          GridBoxDividers->{"Columns" -> {False, {
               Opacity[0.15]}, False}},
          GridBoxItemSize->{"Columns" -> {8, {26}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], 
              Offset[1.1199999999999999`], {
               Offset[1.75]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.8]}, 
              Offset[0.2]}}],
         "Grid"],
        FrameMargins->{{10, 10}, {10, 5}},
        FrameStyle->None,
        StripOnInput->False],
       Deploy,
       DefaultBaseStyle->"Deploy"],
      Alignment->Center,
      BaseStyle->{
       FontWeight -> "Light", FontSize -> 11, FontFamily -> "Segoe UI", 
        NumberMarks -> False, Deployed -> False},
      StripOnInput->False]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.5599999999999999]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], 
       Offset[0.8], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Background->GrayLevel[1],
  FrameMargins->{{0, 0}, {0, 0}},
  FrameStyle->GrayLevel[0.85],
  RoundingRadius->5,
  StripOnInput->False]], "Output",
 CellLabel->"Out[42]=",ExpressionUUID->"47ab8232-82c4-4496-a656-a5ae7e0b6322"]
}, Open  ]],

Cell[TextData[{
 "Use the function ",
 Cell[BoxData[
  FormBox[
   StyleBox["extractRegressionNet",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "5fad6120-e460-439a-9f33-ae06c830a925"],
 " to get the regression net back out of the trained net. Note that the ",
 Cell[BoxData[
  FormBox[
   StyleBox["BatchNormalizationLayer",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "433fbc86-f54f-4fa8-8438-978c0339b3aa"],
 "s will be replaced by constant layers that perform the same operation \
because ",
 Cell[BoxData[
  FormBox["BatchNormalizationLayer", TraditionalForm]],ExpressionUUID->
  "ca32c7c1-2640-4041-891b-8cfec2f945c1"],
 " doesn\[CloseCurlyQuote]t work correctly when making predictions with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"NetEvaluationMode", "\[Rule]", " ", "\"\<Train\>\""}], 
   TraditionalForm]],ExpressionUUID->"13bb7a05-239c-4439-9992-4cf9d5c06fc8"],
 "."
}], "Text",ExpressionUUID->"26036e46-abc8-4e01-b89e-bdc31d25f7e6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"?", "batchnormToChain"}], "\n", 
 RowBox[{"extractRegressionNet", "[", "trainedNet", "]"}]}], "Input",
 CellLabel->
  "In[331]:=",ExpressionUUID->"9a7351d1-e7c7-4be7-ba03-fffa2cfb189c"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"batchnormToChain[net] replaces all instances of \
BatchNormalizationLayer with a NetChain consisting of ConstantPlusLayer and \
ConstantTimesLayer.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Definitions\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Definitions", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{
                    RowBox[{
                    "batchnormToChain", "[", 
                    "BayesianNeuralNetworks`Private`batch_\
BatchNormalizationLayer", "]"}], ":=", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "BayesianNeuralNetworks`Private`biases", ",", 
                    "BayesianNeuralNetworks`Private`scaling", ",", 
                    "BayesianNeuralNetworks`Private`movMean", ",", 
                    "BayesianNeuralNetworks`Private`movVar", ",", 
                    "BayesianNeuralNetworks`Private`eps", ",", 
                    "BayesianNeuralNetworks`Private`sigma"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "BayesianNeuralNetworks`Private`biases", ",", 
                    "BayesianNeuralNetworks`Private`scaling", ",", 
                    "BayesianNeuralNetworks`Private`movMean", ",", 
                    "BayesianNeuralNetworks`Private`movVar", ",", 
                    "BayesianNeuralNetworks`Private`eps"}], "}"}], "=", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"NetExtract", "[", 
                    RowBox[{"BayesianNeuralNetworks`Private`batch", ",", 
                    RowBox[{"List", "/@", 
                    RowBox[{"{", 
                    
                    RowBox[{"\<\"Biases\"\>", ",", "\<\"Scaling\"\>", 
                    ",", "\<\"MovingMean\"\>", ",", "\<\"MovingVariance\"\>", 
                    ",", "\<\"Epsilon\"\>"}], "}"}]}]}], "]"}], "]"}]}], ";", 
                    RowBox[{"BayesianNeuralNetworks`Private`sigma", "=", 
                    SqrtBox[
                    RowBox[{
                    "BayesianNeuralNetworks`Private`movVar", "+", 
                    "BayesianNeuralNetworks`Private`eps"}]]}], ";", 
                    RowBox[{"NetChain", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ConstantPlusLayer", "[", 
                    RowBox[{"\<\"Biases\"\>", "\[Rule]", 
                    RowBox[{"-", "BayesianNeuralNetworks`Private`movMean"}]}],
                     "]"}], ",", 
                    RowBox[{"ConstantTimesLayer", "[", 
                    RowBox[{"\<\"Scaling\"\>", "\[Rule]", 
                    
                    FractionBox["BayesianNeuralNetworks`Private`scaling", 
                    "BayesianNeuralNetworks`Private`sigma"]}], "]"}], ",", 
                    RowBox[{"ConstantPlusLayer", "[", 
                    
                    RowBox[{"\<\"Biases\"\>", "\[Rule]", 
                    "BayesianNeuralNetworks`Private`biases"}], "]"}]}], "}"}],
                     "]"}]}]}], "]"}]}]},
                    {
                    RowBox[{
                    RowBox[{"batchnormToChain", "[", 
                    RowBox[{"BayesianNeuralNetworks`Private`net", ":", 
                    RowBox[{"_NetGraph", "|", "_NetChain"}]}], "]"}], ":=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{
                    RowBox[{"NetReplace", "[", 
                    RowBox[{"BayesianNeuralNetworks`Private`net", ",", 
                    RowBox[{
                    "BayesianNeuralNetworks`Private`b_\
BatchNormalizationLayer", "\[RuleDelayed]", 
                    RowBox[{
                    "batchnormToChain", "[", 
                    "BayesianNeuralNetworks`Private`b", "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    StyleBox[
                    RowBox[{"NetReplace", "::", "norep"}], "MessageName"], 
                    "}"}]}], "]"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], \
"\<\"BayesianNeuralNetworks`batchnormToChain\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"batchnormToChain[net] replaces all instances of \
BatchNormalizationLayer with a NetChain consisting of ConstantPlusLayer and \
ConstantTimesLayer.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {3., 10.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{13., {3., 10.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "batchnormToChain[net] replaces all instances of BatchNormalizationLayer \
with a NetChain consisting of ConstantPlusLayer and ConstantTimesLayer.", 
    "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, BayesianNeuralNetworks`batchnormToChain, {
      BayesianNeuralNetworks`batchnormToChain[
         Pattern[BayesianNeuralNetworks`Private`batch, 
          Blank[BatchNormalizationLayer]]] :> 
       Block[{BayesianNeuralNetworks`Private`biases, 
          BayesianNeuralNetworks`Private`scaling, 
          BayesianNeuralNetworks`Private`movMean, 
          BayesianNeuralNetworks`Private`movVar, 
          BayesianNeuralNetworks`Private`eps, 
          BayesianNeuralNetworks`Private`sigma}, {
           BayesianNeuralNetworks`Private`biases, 
            BayesianNeuralNetworks`Private`scaling, 
            BayesianNeuralNetworks`Private`movMean, 
            BayesianNeuralNetworks`Private`movVar, 
            BayesianNeuralNetworks`Private`eps} = Normal[
            NetExtract[BayesianNeuralNetworks`Private`batch, 
             Map[
             List, {"Biases", "Scaling", "MovingMean", "MovingVariance", 
               "Epsilon"}]]]; 
         BayesianNeuralNetworks`Private`sigma = 
          Sqrt[BayesianNeuralNetworks`Private`movVar + 
            BayesianNeuralNetworks`Private`eps]; NetChain[{
            ConstantPlusLayer[
            "Biases" -> -BayesianNeuralNetworks`Private`movMean], 
            ConstantTimesLayer[
            "Scaling" -> 
             Divide[BayesianNeuralNetworks`Private`scaling, 
               BayesianNeuralNetworks`Private`sigma]], 
            ConstantPlusLayer[
            "Biases" -> BayesianNeuralNetworks`Private`biases]}]], 
       BayesianNeuralNetworks`batchnormToChain[
         Pattern[BayesianNeuralNetworks`Private`net, 
          Alternatives[
           Blank[NetGraph], 
           Blank[NetChain]]]] :> Quiet[
         NetReplace[
         BayesianNeuralNetworks`Private`net, 
          Pattern[BayesianNeuralNetworks`Private`b, 
            Blank[BatchNormalizationLayer]] :> 
          BayesianNeuralNetworks`batchnormToChain[
           BayesianNeuralNetworks`Private`b]], {
          MessageName[NetReplace, "norep"]}]}], "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> 
    "BayesianNeuralNetworks`batchnormToChain"], False]]], "Output",
 CellLabel->
  "Out[331]=",ExpressionUUID->"e52693c3-58c9-48f6-b2fb-99c6a5856c6d"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["NetChain", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"], 
                 ImageSizeCache -> {16., {0., 16.}}], Appearance -> None, 
                ButtonFunction :> (Typeset`open = True), Evaluator -> 
                Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014925373134328358`], {
                 RGBColor[0.729, 0.729, 0.729], 
                 Thickness[0.018686567164179105`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 91.5}, {30., 91.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.729, 0.729, 0.729], 
                 Thickness[0.018686567164179105`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{37., 91.5}, {44., 91.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.631, 0.8160000000000001, 0.498], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5, 
                  103.5}, {23.5, 103.5}, {23.5, 79.5}, {15.5, 79.5}}}]}, {
                 FaceForm[{
                   RGBColor[0.40800000000000003`, 0.627, 0.196], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{24., 104.}, {15., 104.}, {
                  15., 79.}, {24., 79.}}, {{23., 80.}, {16., 80.}, {16., 
                  103.}, {23., 103.}}}]}, {
                 FaceForm[{
                   RGBColor[0.38, 0.753, 0.89], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{29.5, 
                  103.5}, {37.5, 103.5}, {37.5, 79.5}, {29.5, 79.5}}}]}, {
                 FaceForm[{
                   RGBColor[0.24300000000000002`, 0.608, 0.71], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 104.}, {29., 104.}, {
                  29., 79.}, {38., 79.}}, {{37., 80.}, {30., 80.}, {30., 
                  103.}, {37., 103.}}}]}, {
                 FaceForm[{
                   RGBColor[0.584, 0.51, 0.8390000000000001], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{43.5, 
                  103.5}, {51.5, 103.5}, {51.5, 79.5}, {43.5, 79.5}}}]}, {
                 FaceForm[{
                   RGBColor[0.4, 0.396, 0.659], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{52., 104.}, {43., 104.}, {
                  43., 79.}, {52., 79.}}, {{51., 80.}, {44., 80.}, {44., 
                  103.}, {51., 103.}}}]}, {
                 FaceForm[{
                   RGBColor[0.549, 0.549, 0.549], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{28., 91.5}, {25.,
                   95.}, {25., 88.}}}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{42., 91.5}, {39.,
                   95.}, {39., 88.}}}]}}, ImageMargins -> 0, 
               ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Input\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"real\"", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Output\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"2\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}, {
                 StyleBox[
                  
                  TemplateBox[{"\"Number of layers\"", "\":\""}, 
                   "RowDefault"], "SummaryItemAnnotation"], 
                 StyleBox["25", "SummaryItem"]}}, BaselinePosition -> {2, 1}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            BaselinePosition -> {1, 3}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {
                Offset[0.], {
                 Offset[0.5599999999999999]}, 
                Offset[0.]}, "Rows" -> {
                Offset[0.], {
                 Offset[0.4]}, 
                Offset[0.]}}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"], 
                 ImageSizeCache -> {16., {0., 16.}}], Appearance -> None, 
                ButtonFunction :> (Typeset`open = False), Evaluator -> 
                Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014925373134328358`], {
                 RGBColor[0.729, 0.729, 0.729], 
                 Thickness[0.018686567164179105`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 91.5}, {30., 91.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.729, 0.729, 0.729], 
                 Thickness[0.018686567164179105`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{37., 91.5}, {44., 91.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.631, 0.8160000000000001, 0.498], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5, 
                  103.5}, {23.5, 103.5}, {23.5, 79.5}, {15.5, 79.5}}}]}, {
                 FaceForm[{
                   RGBColor[0.40800000000000003`, 0.627, 0.196], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{24., 104.}, {15., 104.}, {
                  15., 79.}, {24., 79.}}, {{23., 80.}, {16., 80.}, {16., 
                  103.}, {23., 103.}}}]}, {
                 FaceForm[{
                   RGBColor[0.38, 0.753, 0.89], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{29.5, 
                  103.5}, {37.5, 103.5}, {37.5, 79.5}, {29.5, 79.5}}}]}, {
                 FaceForm[{
                   RGBColor[0.24300000000000002`, 0.608, 0.71], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 104.}, {29., 104.}, {
                  29., 79.}, {38., 79.}}, {{37., 80.}, {30., 80.}, {30., 
                  103.}, {37., 103.}}}]}, {
                 FaceForm[{
                   RGBColor[0.584, 0.51, 0.8390000000000001], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{43.5, 
                  103.5}, {51.5, 103.5}, {51.5, 79.5}, {43.5, 79.5}}}]}, {
                 FaceForm[{
                   RGBColor[0.4, 0.396, 0.659], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{52., 104.}, {43., 104.}, {
                  43., 79.}, {52., 79.}}, {{51., 80.}, {44., 80.}, {44., 
                  103.}, {51., 103.}}}]}, {
                 FaceForm[{
                   RGBColor[0.549, 0.549, 0.549], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{28., 91.5}, {25.,
                   95.}, {25., 88.}}}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{42., 91.5}, {39.,
                   95.}, {39., 88.}}}]}}, ImageMargins -> 0, 
               ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
              GridBox[{{
                 
                 DynamicModuleBox[{
                  NeuralNetworks`Private`NetChain`assoc3 = 
                   Association[
                    "Type" -> "Chain", "Nodes" -> 
                    Association[
                    "1" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{100, 1}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {100}, "$OutputSize" -> 100, 
                    "$InputSize" -> 1, "$InputDimensions" -> {}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "2" -> Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "3" -> Association[
                    "Type" -> "ConstantTimes", "Arrays" -> 
                    Association[
                    "Scaling" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "4" -> Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "5" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[
                    NeuralNetworks`Private`ScalarFunctionObject[{
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[2], 
                    Association[
                    NeuralNetworks`Private`ScalarSymbol[2] -> {
                    "ScaledExponentialLinearUnit", 
                    NeuralNetworks`Private`ScalarSymbol[1]}]]], 
                    "$Dimensions" -> {100}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "6" -> Association[
                    "Type" -> "Dropout", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "DropoutProbability" -> 0.25, "Method" -> "Dropout"], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "7" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> 
                    NeuralNetworks`Private`DummyArray[{100, 100}], "Biases" -> 
                    NeuralNetworks`Private`DummyArray[{100}]], "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {100}, "$OutputSize" -> 100, 
                    "$InputSize" -> 100, "$InputDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "8" -> Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "9" -> Association[
                    "Type" -> "ConstantTimes", "Arrays" -> 
                    Association[
                    "Scaling" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "10" -> 
                    Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "11" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[
                    NeuralNetworks`Private`ScalarFunctionObject[{
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[2], 
                    Association[
                    NeuralNetworks`Private`ScalarSymbol[2] -> {
                    "ScaledExponentialLinearUnit", 
                    NeuralNetworks`Private`ScalarSymbol[1]}]]], 
                    "$Dimensions" -> {100}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "12" -> Association[
                    "Type" -> "Dropout", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "DropoutProbability" -> 0.25, "Method" -> "Dropout"], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "13" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> 
                    NeuralNetworks`Private`DummyArray[{100, 100}], "Biases" -> 
                    NeuralNetworks`Private`DummyArray[{100}]], "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {100}, "$OutputSize" -> 100, 
                    "$InputSize" -> 100, "$InputDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "14" -> Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "15" -> Association[
                    "Type" -> "ConstantTimes", "Arrays" -> 
                    Association[
                    "Scaling" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "16" -> Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "17" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[
                    NeuralNetworks`Private`ScalarFunctionObject[{
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[2], 
                    Association[
                    NeuralNetworks`Private`ScalarSymbol[2] -> {
                    "ScaledExponentialLinearUnit", 
                    NeuralNetworks`Private`ScalarSymbol[1]}]]], 
                    "$Dimensions" -> {100}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "18" -> Association[
                    "Type" -> "Dropout", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "DropoutProbability" -> 0.25, "Method" -> "Dropout"], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "19" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> 
                    NeuralNetworks`Private`DummyArray[{100, 100}], "Biases" -> 
                    NeuralNetworks`Private`DummyArray[{100}]], "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {100}, "$OutputSize" -> 100, 
                    "$InputSize" -> 100, "$InputDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "20" -> Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "21" -> Association[
                    "Type" -> "ConstantTimes", "Arrays" -> 
                    Association[
                    "Scaling" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "22" -> Association[
                    "Type" -> "ConstantPlus", "Arrays" -> 
                    Association[
                    "Biases" -> NeuralNetworks`Private`DummyArray[{100}]], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> {100}, "$ArrayDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "23" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[
                    NeuralNetworks`Private`ScalarFunctionObject[{
                    NeuralNetworks`Private`ScalarSymbol[1]}, 
                    NeuralNetworks`Private`ScalarSymbol[2], 
                    Association[
                    NeuralNetworks`Private`ScalarSymbol[2] -> {
                    "ScaledExponentialLinearUnit", 
                    NeuralNetworks`Private`ScalarSymbol[1]}]]], 
                    "$Dimensions" -> {100}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "24" -> Association[
                    "Type" -> "Dropout", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "DropoutProbability" -> 0.25, "Method" -> "Dropout"], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]]], 
                    "25" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{2, 100}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{2}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {2}, "$OutputSize" -> 2, 
                    "$InputSize" -> 100, "$InputDimensions" -> {100}], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{100}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{2}, NeuralNetworks`RealT]]]], 
                    "Edges" -> {
                    NeuralNetworks`NetPath["Nodes", "1", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "Input"], 
                    NeuralNetworks`NetPath["Nodes", "2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "1", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "3", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "2", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "4", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "3", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "5", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "4", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "6", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "5", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "7", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "6", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "8", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "7", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "9", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "8", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "10", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "9", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "11", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "10", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "12", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "11", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "13", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "12", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "14", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "13", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "15", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "14", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "16", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "15", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "17", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "16", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "18", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "17", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "19", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "18", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "20", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "19", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "21", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "20", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "22", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "21", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "23", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "22", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "24", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "23", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "25", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "24", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Outputs", "Output"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "25", "Outputs", "Output"]}, "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{2}, NeuralNetworks`RealT]]], 
                   NeuralNetworks`Private`NetChain`opart, 
                   NeuralNetworks`Private`NetChain`part, 
                   NeuralNetworks`Private`NetChain`selected = Null}, 
                  DynamicBox[
                   GridBox[{{
                    NeuralNetworks`Private`NetChain`MouseClickBoxes[
                    TagBox[
                    GridBox[{{
                    TagBox[
                    TagBox[
                    "\"\"", Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    "\"Input\"", 
                    Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    "\"real\"", 
                    Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"1\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"2\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"3\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantTimesLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"4\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"5\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox[
                    RowBox[{"\"ScaledExponentialLinearUnit\"", "[", 
                    StyleBox["\"x\"", Italic, StripOnInput -> False], "]"}], 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"6\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["DropoutLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"7\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "7"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "7"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "7"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"8\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "8"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "8"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "8"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"9\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "9"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantTimesLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "9"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "9"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"10\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "10"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "10"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "10"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"11\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "11"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox[
                    RowBox[{"\"ScaledExponentialLinearUnit\"", "[", 
                    StyleBox["\"x\"", Italic, StripOnInput -> False], "]"}], 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "11"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "11"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"12\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "12"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["DropoutLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "12"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "12"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"13\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "13"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "13"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "13"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"14\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "14"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "14"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "14"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"15\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "15"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantTimesLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "15"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "15"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"16\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "16"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "16"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "16"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"17\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "17"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox[
                    RowBox[{"\"ScaledExponentialLinearUnit\"", "[", 
                    StyleBox["\"x\"", Italic, StripOnInput -> False], "]"}], 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "17"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "17"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"18\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "18"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["DropoutLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "18"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "18"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"19\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "19"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "19"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "19"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"20\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "20"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "20"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "20"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"21\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "21"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantTimesLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "21"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "21"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"22\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "22"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ConstantPlusLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "22"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "22"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"23\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "23"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox[
                    RowBox[{"\"ScaledExponentialLinearUnit\"", "[", 
                    StyleBox["\"x\"", Italic, StripOnInput -> False], "]"}], 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "23"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "23"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"24\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "24"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["DropoutLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "24"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"100\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "24"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"25\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "25"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "25"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"2\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "25"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    "\"\"", Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    "\"Output\"", 
                    Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"2\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{1.1}}}], "Grid"], 
                    If[
                    ListQ[
                    NeuralNetworks`Private`NetChain`part = MouseAnnotation[]],
                     If[NeuralNetworks`Private`NetChain`opart === 
                    NeuralNetworks`Private`NetChain`part, 
                    NeuralNetworks`Private`NetChain`selected = Null; 
                    NeuralNetworks`Private`NetChain`opart = Null, 
                    NeuralNetworks`Private`NetChain`selected = 
                    Part[NeuralNetworks`Private`NetChain`assoc3, 
                    Apply[Sequence, NeuralNetworks`Private`NetChain`part]]; 
                    NeuralNetworks`Private`NetChain`opart = 
                    NeuralNetworks`Private`NetChain`part; Null]; Null]]}, 
                    NeuralNetworks`Private`NetChain`fmtSelected[
                    NeuralNetworks`Private`NetChain`selected, 
                    NeuralNetworks`Private`NetChain`part, 
                    NeuralNetworks`Private`GetSharedArrays[
                    NeuralNetworks`Private`NetChain`assoc3]]}, 
                    GridBoxSpacings -> {"Columns" -> {{1}}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridFrameMargins -> {{0, 0}, {0, 0}}], 
                   ImageSizeCache -> {385., {290., 298.}}, 
                   TrackedSymbols :> {
                    NeuralNetworks`Private`NetChain`selected}], 
                  Initialization :> {NetChain}]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            BaselinePosition -> {1, 1}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {
                Offset[0.], {
                 Offset[0.5599999999999999]}, 
                Offset[0.]}, "Rows" -> {
                Offset[0.], {
                 Offset[0.4]}, 
                Offset[0.]}}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}, BaselinePosition -> Baseline]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("NetChain[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[332]=",ExpressionUUID->"98f9c339-aa80-465b-b097-0cc90e93e1f6"]
}, Open  ]],

Cell[TextData[{
 "Generate predictions from the network in the range ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "\[Element]", 
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], TraditionalForm]],
  ExpressionUUID->"887e23dc-3076-4efc-9e46-fc8c4cea5ce4"],
 " by sampling each input 500 times with the ",
 Cell[BoxData[
  FormBox[
   StyleBox["DropoutLayer",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "53da635a-c75b-44d9-8b47-468eb1ac4be4"],
 "s active to account for the uncertainty in the network weights. In other \
words, the generated distributions account for both model variance and \
uncertainty in the network weights."
}], "Text",ExpressionUUID->"fb1721fa-0ff0-4417-adad-01b209b33eaf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleTrainedNet", "[", 
  RowBox[{"trainedNet", ",", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1", ",", "0.1"}], "]"}], ",", "500", ",", 
   RowBox[{"TargetDevice", "\[Rule]", " ", "\"\<GPU\>\""}]}], "]"}]], "Input",
 CellLabel->
  "In[267]:=",ExpressionUUID->"30872bf6-91d1-4bdc-bc93-5db995dbb405"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1.`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.46949253416061404`", ",", "0.9108457008825533`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.9`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.47095398300886154`", ",", "0.6948191373739746`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.8`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.46717259389162064`", ",", "0.5638803311489615`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.7`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.4676081262230873`", ",", "0.4075525623982654`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.6`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.4736355177164078`", ",", "0.32274085565301125`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.5`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.4511198916435242`", ",", "0.32107808029159296`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.3999999999999999`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.44389767318964`", ",", "0.3619245782318482`"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.29999999999999993`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.42535045075416567`", ",", "0.38740277100618503`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.19999999999999996`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.41626143342256544`", ",", "0.4470447594977138`"}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "0.09999999999999998`"}], "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.43108818650245667`", ",", "0.3889682832405467`"}], "]"}]}], 
   ",", 
   RowBox[{"0.`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.4919481552243233`", ",", "0.2317970979194363`"}], "]"}]}], 
   ",", 
   RowBox[{"0.10000000000000009`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0.7976320930719376`", ",", "0.037979759193043784`"}], "]"}]}], 
   ",", 
   RowBox[{"0.20000000000000018`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.0694218732118606`", ",", "0.23123510674107753`"}], "]"}]}], 
   ",", 
   RowBox[{"0.30000000000000004`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.263140240907669`", ",", "0.38507421127857766`"}], "]"}]}], 
   ",", 
   RowBox[{"0.40000000000000013`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.347756584405899`", ",", "0.4867598252684955`"}], "]"}]}], ",", 
   RowBox[{"0.5`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.480282357931137`", ",", "0.5646268906238577`"}], "]"}]}], ",", 
   RowBox[{"0.6000000000000001`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.56630179977417`", ",", "0.6453878763706178`"}], "]"}]}], ",", 
   RowBox[{"0.7000000000000002`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.6621956884860993`", ",", "0.7234156899754389`"}], "]"}]}], 
   ",", 
   RowBox[{"0.8`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.6815151307582856`", ",", "0.8102627852128913`"}], "]"}]}], 
   ",", 
   RowBox[{"0.9000000000000001`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.72944726729393`", ",", "0.8071727960336772`"}], "]"}]}], ",", 
   RowBox[{"1.`", "\[Rule]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"1.7928335908651352`", ",", "0.844182164961943`"}], "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[267]=",ExpressionUUID->"73ccc44c-b629-4271-a0e0-ab6fe4129699"]
}, Open  ]],

Cell["Plot the predictions:", \
"Text",ExpressionUUID->"b3abe12d-9a18-41e1-badb-19532ad54544"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xValues", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "1.5"}], ",", "1.5", ",", "0.05"}], "]"}]}], ",", 
     RowBox[{"quantiles", "=", 
      RowBox[{"{", 
       RowBox[{"0.95", ",", "0.5", ",", "0.05"}], "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
        RowBox[{"Values", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"InverseCDF", "[", 
            RowBox[{"#", ",", "quantiles"}], "]"}], "&"}], "/@", 
          RowBox[{"sampleTrainedNet", "[", 
           RowBox[{"trainedNet", ",", "xValues", ",", "500", ",", 
            RowBox[{"TargetDevice", "\[Rule]", " ", "\"\<GPU\>\""}]}], "]"}]}]
          , "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"MinMax", "[", "xValues", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"{", "2", "}"}]}], ",", 
          RowBox[{"3", "\[Rule]", 
           RowBox[{"{", "2", "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<`1`%\>\"", ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"Round", "[", 
           RowBox[{"100", " ", "*", " ", "quantiles"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"List", "@@@", "testdata"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"4bd2a018-736d-4078-9d9d-b73b51fe2755"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{}, 
      GraphicsComplexBox[CompressedData["
1:eJzt1mtQU1cCB/Dw7hZQBB15iA9cokUWA1KwYnuiVVtAKYLuBpauIIEFysOI
ijBgVcpCd7eKy0Oeiq52RR3FiBSU5UARCuVRCIEkPApJSHgKIYEkPCIbyT2n
Mzvj7Bdnp85wvzB37r3/e8495xf+m47H+IRok0ikaC0S6dVfzaGEfmRxaZux
DOxYOhTQpTBJpXVaBkKXDjl0Mp3f1HNRBvJyXx0zUE88aV8VJQMtza+OaVjR
IVrosZMBTd40tO8c3rlogPJkcLw55P0HTCmRJ4Wjsx90FnyE8qbgtVwnoatA
SuRJYMLD8sUt2ihPAl12X1NUcNDzE3Ai9SI9p0YKlm5vHoe/v0NfuatISrxv
DNKLAFP0jgwsxeeOwEu/dRT8xQjlDUOblH7pFgeUJ4Yj1t6XmLoobxCeeVZd
xT+M8oRQSjFtiVktJfL4sNk3okr81RSRNwAbZleP7No/RTzfC934ZYKktCmQ
s3Q/D17yfdQdUScB9KX3dUFF4fW4L8ymAGUpvwPumbUnf3tLQuS1Qe+b2r1r
yRLi+UZYv23zd+3q65r7a6F/XAD5oWASpC9dr4AFvHfcT5hJwPml82J479R9
sq0jyiORzkR5rcu8NgmKNNfBS0eHpG9/QOcVYIiiaKyPlICdmnyQLb+xZTJE
SlxvBK11EVY53tNofODHRp/Dt4ZmgLNm/IARb3R3m4UShGnmB6qaglXDoXOg
QDN/ULAjn2JlrQJtmu8DKspM5u8Nv0TfD5RHrg2oEZGomvv5wGbt7bGHn2pT
NflCEB1C+oRmp0Ml1ge09juUx32uS9W8Twz0JyeZpmN6VGJ9gfPM2ZBjcn0i
bwQcI33pGX3UgMgbA9N5h5JUNb+hasYzDkpjVwfsuv0ukTcB/OtLDLdeMSTy
JOC+/fpy1zQjaqtmf4JS3/2jlnRjKrF/waUWd673vDHxvBSky2eoK/tWEO+T
AZe9WSdnYkyIvGkQkw1aBopNiLxpYN5TrRWSuYrImwHKAv8kluEqIk8Optft
HS7ebErkKcDJq8q8nRmmRJ4SzFXShhYrzNA5DL/yojk8m4U9J1f/+LXP9Q7s
Wb41wMDGhY0961/Iig2LZGHPRZbbf2dY1II9fxlReXAb6MCebfUvRM2FsbDn
heKpm/b67djznXrP7XNH2dizWXK1hyy/HXu+/P3McLtxB/b871MZJ1aksrBn
t/7P2inOLOx5lOzILdregT3/pPBNznBqw56Pm9BmT23qwJ6t/enBC6o27Pnm
/jLDrZ4s7Fk9/9Sr5WzsOdNc98HLP7CxZynr0INuORt75iesvlsZx8ae/elu
/WSLTuw5J9o0Wf6Egz1/vSewpaGAjT2r12PjzI4u7Jn2QelC7dlu7PnWiQ+/
zzXqwZ7rNpY8TbnTjz2rX9cnCuJjz+r5WdF4Auz5iPD22ue3RNhzycmwdus/
jmLP6vXK+ipvAnsubTjTteH9Sez5T0/dnwssJ7Fn9fqv4VhJsGdRm01tMEeC
Pavn787kTWHPw/PF98z/IcWeea0KGDoiA8iz9zdXu2u80e+FEPzg6Xpa10iO
1geo1+dfcSkKgDzHhl1JGWMq0foCpa/QzcgS/Z6MAJ/y9e8V28wB5Fk9vxaz
ZwsAeWYWTs4zzqsA8hwoass7dh793khezXfQf+8iQJ7V+9fuxv1FtH+Bej2t
vvkzCXvuPDsijW0hYc9z5yKKd/RqYc/q/VN25KAW9hxjmhxhv08be1bPzzpK
rI09q/czvc9LB3ve97fIIE6gDvas/r6P7h3QxZ4PPvu5wDVFCJHn8XgK45GH
ECLPJ+dzd2f+JIDIs4Gnh9gsZhAiz2RL52BmyhBEnnvBGtuONgFEnssyPFRB
CwKIPPe6XzQwjhNB5Dk70uLq6Wg+RJ4He0pKA8IGIfI88OSA/s0b6PkJaJPP
oNmo85DnU4z4Qx8bofGPQaGF19/tBAKIPHsfXrEnQSyCyLN4NnS8excfIs/l
fLeKMEMhRJ69HJsY+TQ0fiEUMNJt0wd+hsizyfobhYXBfRB53run/BOXLT0Q
eXa8zHQ559QHkee0FK/7nwu5EHlm5vlxq/lsiDwrgmQqfT8eRJ4ZodsdTlPY
EHnmnv20PunjJog8D1gmph+l1ULkObCQzn2SfRkiz4lf2McaGj3Gnt+1Ggk/
4d2APR9+z41eq8PBnq8kC1Y86BViz9Ybqnrswoex5yY98zMrG0XYM5n/QpQY
KsCeC+L+SdL7cAB7tqOlbk7Y0PeL5yPRqbZ+3dgzTdeYsWaCiz3rrtLZsM2a
iz2HPcqIu0zlYs+VTt8xgow52HOmg1viIuBhz4FNhln1H3Vhz+vkPo9DrXnY
czpUjXeFd2HPiX75F5gNHOx58DPey0peF/a8UUmKr4znYM9pUQFBFu2d2DOF
eVzPaR8Le15I5E54XEPPS0E1d4hcN9EJkGfnZt8oYS0a3zQ4vy/dPMnrOUCe
S0YPmL9Q1qH/lyDtr0/17hb3AeSZdl1S5fqYBZBnSsK5Vu7jRoA8t40d2R2f
VYPOl/v2a/q283/17RzC89vat6sJz2+qb1P+R98uIjwv9+3lvv1r6NvIM+rb
yPPb2reR5zfVt5Hn1/Vt5Hm5by/37V9D30aeUd9Gnt/Wvo08v6m+jTy/rm9j
z8t9+//St/8DbIwjKg==
       "], {{{}, {}, {}, {}, {}, {}, {}, {}, {}, {
          EdgeForm[], 
          Directive[
           RGBColor[0.368417, 0.506779, 0.709798], 
           Opacity[0.2]], 
          GraphicsGroupBox[{
            
            PolygonBox[{{62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 
             75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 
             91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105,
              106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118,
              119, 120, 121, 122, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 
             50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 
             34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 
             18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 
             1}}]}]}, {}, {}, {}, {}, {
          EdgeForm[], 
          Directive[
           RGBColor[0.560181, 0.691569, 0.194885], 
           Opacity[0.2]], 
          GraphicsGroupBox[{
            
            PolygonBox[{{123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 
             133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 
             146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 
             159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 
             172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 122, 
             121, 120, 119, 118, 117, 116, 115, 114, 113, 112, 111, 110, 109, 
             108, 107, 106, 105, 104, 103, 102, 101, 100, 99, 98, 97, 96, 95, 
             94, 93, 92, 91, 90, 89, 88, 87, 86, 85, 84, 83, 82, 81, 80, 79, 
             78, 77, 76, 75, 74, 73, 72, 71, 70, 69, 68, 67, 66, 65, 64, 63, 
             62}}]}]}, {}, {}, {}}, {{}, {}, {}, {
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], 
          
          LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
           18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 
           51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61}]}, {
          Hue[0.9060679774997897, 0.6, 0.6], 
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]], 
          
          LineBox[{62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76,
            77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 
           93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107,
            108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 
           121, 122}]}, {
          Hue[0.1421359549995791, 0.6, 0.6], 
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.560181, 0.691569, 0.194885], 
           AbsoluteThickness[1.6]], 
          
          LineBox[{123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134,
            135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 
           148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 
           161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 
           174, 175, 176, 177, 178, 179, 180, 181, 182, 183}]}}, {{
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]]}, {
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]]}, {
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.560181, 0.691569, 0.194885], 
           AbsoluteThickness[1.6]]}}, {{
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]]}, {
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]]}, {
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.560181, 0.691569, 0.194885], 
           AbsoluteThickness[1.6]]}, {}, {}, {}, {}, {}, {}, {}}, {{
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]]}, {
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]]}, {
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.560181, 0.691569, 0.194885], 
           AbsoluteThickness[
           1.6]]}, {}, {}, {}, {}, {}, {}, {}}}], {{}, {}}}, {{}, {{{
         Directive[
          PointSize[0.012833333333333334`], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0, 0]], 
         PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAUD8YAhxQ5D8WZTY5Tbv8Pzi7g0eA
3ui/4ImPieaf4L841ZIJmIfiP4yKxM8MEvM/VPOzggj7478kWCGQkpbpPxxD
j7qKjeC/MO3fwIDj0D+cIXWo78rrv7wI/TNor+g/wCTpWlmhtT/4LkNCuobn
P2C6T7rDNOG/ZLx6BDbD5D9QUbtuWJ/Kv6zJrXTCi+o/QN2S+B+p2T8wFE/1
q6XnP+Q84XJxceK/+JTe1yCa1z+QgvIa/dPfP6owSxWh5ABAIBj+UQ/Aw7/w
M1c0abjAv5yJkKYLKeC/QJDMx5t6wD/wFdBt+4nuPxY/j2eIRQRAeFy+N3jP
5D90MZKdt5PlP/w7N3q1N+s/5vpyzTAh+j9QRRHsfPvDPyDjcjvDLvE/aH47
lT6D2r8EZ/CiFxzgP+CjN5ZKr+K/AJua+lfg6z/bhKt6
          "]]}}, {{
         Directive[
          PointSize[0.012833333333333334`], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0, 0]]}, {}}, {{
         Directive[
          PointSize[0.012833333333333334`], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0, 0]]}, {}}}, {{}, {}}}}, {
    PlotRange -> All, DisplayFunction -> Identity, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{-1.5, 1.5}, {-0.7350704133576229, 4.931640257636213}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{
       InterpretationBox[
       "\"\\!\\(\\*FormBox[\\\"95\\\", TraditionalForm]\\)%\"", 
        StringForm["`1`%", 95], Editable -> False], 
       InterpretationBox[
       "\"\\!\\(\\*FormBox[\\\"50\\\", TraditionalForm]\\)%\"", 
        StringForm["`1`%", 50], Editable -> False], 
       InterpretationBox[
       "\"\\!\\(\\*FormBox[\\\"5\\\", TraditionalForm]\\)%\"", 
        StringForm["`1`%", 5], Editable -> False]}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.560181`", ",", "0.691569`", ",", "0.194885`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellLabel->"Out[43]=",ExpressionUUID->"1f86f816-2bf8-4830-975c-c97cf9feefe9"]
}, Open  ]],

Cell[TextData[{
 "Compute the approximate Bayesian logevidence (also known as \
\[OpenCurlyDoubleQuote]marginal likelihood\[CloseCurlyDoubleQuote]) of the \
network model. It is given by ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     RowBox[{"marginal", " ", 
      RowBox[{"LogLikelihood", "[", "data", "]"}]}], " ", "-", " ", 
     RowBox[{"L2RegularizationLoss", "[", "net", "]"}]}],
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "378ecc3b-d04c-474a-9436-1183ce3243a4"],
 ". The higher the log evidence, the better the model represents the data."
}], "Text",ExpressionUUID->"f15c1f42-3b86-4a19-a074-83c194b8e491"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"networkLogEvidence", "[", 
  RowBox[{"trainedNet", ",", "testdata", ",", "lambda2", ",", 
   RowBox[{"TargetDevice", "\[Rule]", " ", "\"\<GPU\>\""}]}], "]"}]], "Input",
 CellLabel->"In[45]:=",ExpressionUUID->"1d3a5498-b2b0-4453-bb0e-6a7d8874e98b"],

Cell[BoxData["24.56480015898794`"], "Output",
 CellLabel->"Out[45]=",ExpressionUUID->"9121b3fd-6309-4156-9c77-6b3797c46220"]
}, Open  ]],

Cell["\<\
If you want to see how the logevidence depends on the regularisation \
coefficient, simply pass it as a symbol:\
\>", "Text",ExpressionUUID->"2a215e68-43dd-40a4-acff-670e1fd4d317"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"networkLogEvidence", "[", 
  RowBox[{"trainedNet", ",", "testdata", ",", "\[FormalLambda]", ",", 
   RowBox[{"TargetDevice", "\[Rule]", " ", "\"\<GPU\>\""}]}], "]"}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"e8a694d8-7ede-4a67-8a58-82b40ebf68d5"],

Cell[BoxData[
 RowBox[{"23.52951455116272`", "\[VeryThinSpace]", "-", 
  RowBox[{"21.844051693826838`", " ", "\[FormalLambda]"}]}]], "Output",
 CellLabel->"Out[44]=",ExpressionUUID->"a8a5644b-e8c4-404b-ae79-80397971e8a4"]
}, Open  ]],

Cell["\<\
Perform a comparative analysis of several networks. You can run the cell \
below several times to aggregate the results. Note that the L2Regularization \
can be interpreted as a prior on the length scale of the variations in the \
data, so we consider it as a parameter that either has to be fixed a-priori \
or determined by cross-validation.\
\>", "Text",ExpressionUUID->"94ef958d-f84b-48f8-aa9d-d58bda66ac1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "result", "]"}]}], ",", 
    RowBox[{"result", "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TakeLargestBy", "[", 
       RowBox[{"result", ",", 
        RowBox[{"#LogEvidence", "&"}], ",", 
        RowBox[{"UpTo", "[", "5", "]"}]}], "]"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{
       "retain", " ", "up", " ", "to", " ", "5", " ", "best", " ", "networks",
         " ", "from", " ", "previous", " ", "runs"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"config", "=", 
            RowBox[{"<|", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<ErrorModel\>\"", "\[Rule]", " ", 
               RowBox[{"RandomChoice", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<HomoScedastic\>\"", ",", "\"\<HeteroScedastic\>\""}], 
                 "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<L2Regularization\>\"", "\[Rule]", " ", "0.01"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<DropoutProbability\>\"", "\[Rule]", " ", "0.25"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<LayerSize\>\"", "\[Rule]", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "100"}], "}"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<NetworkDepth\>\"", "\[Rule]", " ", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<ActivationFunction\>\"", "\[Rule]", " ", 
               RowBox[{"RandomChoice", "[", 
                RowBox[{"{", 
                 RowBox[{"Ramp", ",", "\"\<SELU\>\"", ",", "Tanh"}], "}"}], 
                "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"net", "=", 
              RowBox[{"NetTrain", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"regressionLossNet", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"config", "[", "\"\<ErrorModel\>\"", "]"}], ",", 
                    "##", ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<LossModel\>\"", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<AlphaDivergence\>\"", ",", 
                    RowBox[{"\"\<Alpha\>\"", "\[Rule]", " ", "0.5"}], ",", 
                    RowBox[{"\"\<SampleNumber\>\"", "\[Rule]", "20"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], "@@", 
                 RowBox[{"FilterRules", "[", 
                  RowBox[{
                   RowBox[{"Normal", "[", "config", "]"}], ",", 
                   RowBox[{"Options", "[", "regressionLossNet", "]"}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", "testdata", ",", "All",
                 ",", "\[IndentingNewLine]", 
                RowBox[{"LossFunction", "\[Rule]", "\"\<Loss\>\""}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Method", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<ADAM\>\"", ",", 
                   RowBox[{"\"\<L2Regularization\>\"", "\[Rule]", " ", 
                    RowBox[{
                    "config", "[", "\"\<L2Regularization\>\"", "]"}]}]}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"TimeGoal", "\[Rule]", "60"}], ",", 
                RowBox[{"TargetDevice", "\[Rule]", "\"\<GPU\>\""}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TrainingProgressReporting", "\[Rule]", "None"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{"config", ",", "\[IndentingNewLine]", 
              RowBox[{"<|", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Network\>\"", "\[Rule]", " ", "net"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<LogEvidence\>\"", "\[Rule]", " ", 
                 RowBox[{"networkLogEvidence", "[", 
                  RowBox[{"net", ",", "testdata", ",", 
                   RowBox[{"config", "[", "\"\<L2Regularization\>\"", "]"}], 
                   ",", 
                   RowBox[{"TargetDevice", "\[Rule]", " ", "\"\<GPU\>\""}]}], 
                  "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "8", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DistributedContexts", "\[Rule]", "All"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
  ";"}]}], "Input",ExpressionUUID->"e5c67919-f82b-470e-ad58-dbb16adfb77c"],

Cell["\<\
View the hyperparameters corresponding to the highest logevidence:\
\>", "Text",ExpressionUUID->"a9b41a44-5591-40df-8fa9-c19d9f72ef52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "@", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"assocs", "=", 
      RowBox[{"TakeLargestBy", "[", 
       RowBox[{
        RowBox[{"KeyDrop", "[", 
         RowBox[{"result", ",", "\"\<Network\>\""}], "]"}], ",", 
        RowBox[{"#LogEvidence", "&"}], ",", 
        RowBox[{"UpTo", "[", "10", "]"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"Values", "[", "assocs", "]"}], ",", 
      RowBox[{"Keys", "[", 
       RowBox[{"First", "[", "assocs", "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"efcdd220-bda4-4eac-a853-26ab342e9bb4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"ErrorModel\"\>", "\<\"L2Regularization\"\>", \
"\<\"DropoutProbability\"\>", "\<\"LayerSize\"\>", "\<\"NetworkDepth\"\>", \
"\<\"ActivationFunction\"\>", "\<\"LogEvidence\"\>"},
    {"\<\"HeteroScedastic\"\>", "0.01`", "0.25`", "190", "5", "Ramp", 
     "62.68738495394587`"},
    {"\<\"HeteroScedastic\"\>", "0.01`", "0.25`", "68", "3", "Ramp", 
     "55.47378657221794`"},
    {"\<\"HomoScedastic\"\>", "0.01`", "0.25`", "127", "3", "Ramp", 
     "48.65793373463762`"},
    {"\<\"HeteroScedastic\"\>", "0.01`", "0.25`", "53", "4", "Ramp", 
     "47.865346357524395`"},
    {"\<\"HeteroScedastic\"\>", "0.01`", "0.25`", "76", "3", "Ramp", 
     "47.78667541503906`"},
    {"\<\"HeteroScedastic\"\>", "0.01`", "0.25`", "53", "5", "Ramp", 
     "46.127923229783775`"},
    {"\<\"HeteroScedastic\"\>", "0.01`", "0.25`", "88", "5", "Ramp", 
     "43.54472341388464`"},
    {"\<\"HeteroScedastic\"\>", "0.01`", "0.25`", "32", "2", "Ramp", 
     "43.387022392749785`"},
    {"\<\"HomoScedastic\"\>", "0.01`", "0.25`", "114", "4", "Ramp", 
     "41.501252913475035`"},
    {"\<\"HomoScedastic\"\>", "0.01`", "0.25`", "67", "3", "Ramp", 
     "40.564732768908144`"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[52]//TableForm=",ExpressionUUID->"199e5bb3-7210-4d6e-8f54-e17e548568a1"]
}, Open  ]],

Cell["Show the predictions of the top 5 networks together. ", \
"Text",ExpressionUUID->"c2eb2391-8033-40da-a9b2-565597da3993"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "@", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xValues", "=", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "1.5"}], ",", "1.5", ",", "0.05"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"quantiles", "=", 
       RowBox[{"{", 
        RowBox[{"0.95", ",", "0.5", ",", "0.05"}], "}"}]}], ",", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"results", " ", "=", " ", 
       RowBox[{"TakeLargestBy", "[", 
        RowBox[{"result", ",", 
         RowBox[{"#LogEvidence", "&"}], ",", 
         RowBox[{"UpTo", "[", "5", "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "minMaxEvidence"}], " ", "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"minMaxEvidence", " ", "=", " ", 
      RowBox[{"MinMax", "[", 
       RowBox[{"results", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "\"\<LogEvidence\>\""}], "]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Thread", "@", 
            RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
               RowBox[{"Values", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"InverseCDF", "[", 
                   RowBox[{"#", ",", "quantiles"}], "]"}], "&"}], "/@", 
                 RowBox[{"sampleTrainedNet", "[", 
                  RowBox[{"#Network", ",", "xValues", ",", "500", ",", 
                   RowBox[{"TargetDevice", "\[Rule]", " ", "\"\<GPU\>\""}]}], 
                  "]"}]}], "]"}], "\[IndentingNewLine]", "]"}], ",", 
              "\[IndentingNewLine]", "#LogEvidence"}], "\[IndentingNewLine]", 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"DataRange", "\[Rule]", 
            RowBox[{"MinMax", "[", "xValues", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Opacity", "[", 
             RowBox[{"Rescale", "[", 
              RowBox[{
               RowBox[{"#", "[", "\"\<LogEvidence\>\"", "]"}], ",", 
               "minMaxEvidence", ",", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"List", "@@@", "testdata"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "800"}]}], "\[IndentingNewLine]", 
        "]"}], "&"}], "/@", 
      RowBox[{"Reverse", "[", "results", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"79d0fd47-d8f8-4d3f-b997-d7def80083b8"],

Cell[BoxData[
 GraphicsBox[{{{{}, {{{}, {}, 
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1], 
          LineBox[CompressedData["
1:eJw10ntIU1EYAPDNpKc91JmaiQW5kqIUs8SM7yrZ7A/N1JaGNhWfLJTMSkSH
5iNLHBq5XGaEpKQmEcpyKh4l8FG+IF2JYYnmo825e/e4gprlved+cLkczvf9
vvM6mpARnmTF4/Eu/v+2/mysorgF95ZghQW8maCROWYz7U4oDclMWNCeIJ42
eJCGF8qtMKOpyhWZoo+G4aGtMCFDUqVdiIAG1jOhfFvvpPFpzjOiVcHt5bYF
C/YoJIpQvBVe4TwS6VISVzMHOM+A1hW1xTIR5xlQjiJ6IPUdV69Hde9dND3D
ZmDSh3Qo/PN0t1O7GffTonORj2pkdSZgeOUSoqczn63pjdhbRA89JrIT3I3Y
m0f9F4Rivi+FvTnUfrOv/+dTEnuzSFCad/ivG4m9GdRulrtGXSKx9wt9lxnC
jSdJXP8DRVw+/mA9mIRqJn8SNZh7R2vkJCQy/TSotkI1F1BFgifjf0UVRp2y
8zHnjSEbWhRXJaRw/SDKCRr6NpdM4fxPiBIXjWz2U1DBzKtRm6Rjb6GOgnxm
3Ihu3RdVhcZSwN3wvoweiWMTCa/Zeehw1jgE/V7BYzXIPdxF0Yf04Mv6sFG/
0Zx7w4TnByEwPl7sE2Li1gduqszWshQjnGXXD7lvHCXlahJS2f1Blqak5pU/
CS/Z/cMZTaeP9SQJY+z5gMrdpS3bvMadHyQGFlxrCLYi2PwZWKsvG5W6WRGs
PwthV7u7Yrz5BL4f8E+nZ7784RFsv3kwVC3dnTjGJ/D9QkCvGK7TfOwtgXNC
8WlPyTbsaSGMLyxo7rUm2PXowKtV3LzctB17elDx87Sqrp3YM4BevigNVe8m
Rtj3CX5ehdK5jzYEfr8wBXnCHL/9uJ4CxT1lyq7iA7ifEexPZdkVF9lizwSu
4tjzR3LssGcCWWR1tzjNHntmmChvKSl9IsCeBXRR0udl+Q7Yo+HEjrjmlfGD
2FuF9OHSD42XnYh/iq7WfA==
           "]]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1], 
          LineBox[CompressedData["
1:eJw1k31Ik3EQx+cw30LIFCsRXwoMlVLRXGZy0zITgjnpzQgSSTMrlZCofKll
c0iIy1xoKPnSPyZYGZlSebUK301JndLL3tSa82WbezMVel5+O3h4eLi7z919
757grIL0bC6Hw0mgHvrNmh3FemEZ11+F0YzZ8FJOjvX51BTmMGZFr7NxkYFX
JvBJPW0W5FUm5vJMfTgyTJsZi306FNdODyPLM2N2vDIC+9oJbxU9FK2GOxkd
wPJMODNqe11U+gpYnhGTMufSegLkwPIMGCjWO8nW+oHlGbAuf/tQ/sI3kr+M
3uUfQ0RnpoEJH16k/a5xiZPA1tPT/QY9TlEAg6/XIT71U9zfP014f+m+BMHe
vwhvnp6j/7ifkvBmsWB7eaz5t4rwtLQeh4rFasJT4wleZWjbuIbwVMgNl8jF
CVqS/xP3dTbqeTIN1DHxMzi++0dEQ60WLjL1ptC8OdFSfkELkQz/O+6NcpO6
7HLwxrB2p/PtsDw1yR+g+WGpWUoS/xkPKwUZMUtKkDL+HpT4ztS0jirhLvPd
hp8Gm2XCcypwbJjSd/BtlRqaWD9Q+5DHb9OQ7x441rUq8lmfg4MsH6h5K4Tr
K8Q/AM8KEzRR3gZHf9CS3BU/0roMMWz/EHq+Omm2UA+57HxQs1QikKl00MDO
D5cfLpUsGnUwxurD8PpiTQ79YKPNyK34YifxapDKLScl0XbC18ItXYhXGsfq
2A9Q+g65RVlIvXmg9PD8OmZx7BeOPrja7nLPRng6EMmOSEKG1ghPD0pBFU9f
vU76WQRK7xsVE5uEtwz/yvKCREEcPrk/ur5xj78Tf5S9TyiFAxvvpFw+uV86
PrPbw5nP5ptg8qbON9XszGfrrUJn48rKKdsWwjMDda8vmsCV8Mzw8nruWvi8
K+FZ4EPRo/c7hO6EZ6X17e1dcCc8G6R3BzRX/dlKeHag/r+UN8me/P9DINKs

           "]]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1], 
          LineBox[CompressedData["
1:eJw90ntIk1EUAPCpFEniI0pbCZlk+cihKGRinEXKpD9Co4fG8JkvCAUrNVsm
lCSZIuTKqVmp+EBLEc0k7SzU5UjNMpWhpGs2XXu4uU1H5iy/e+3Ax8flnvM7
93U4Ket8ii2LxTr179v6k7DgDdU7oVesnTiIiTV0jRRlK/g24lQmVrEkr+z0
tU2WuEq0FWY8btqMOTKwgaMjW2FCF7WgeMnHisQzYciOwJioagsSz4gl04k6
d1szEm8FM2Pd9uSxzUg8A845+TUMco3U0+Obbs8Itr2BenpsM/v4VSVrab0O
g2dziljhCmTSRzTofLQ1x8JR0n5qTIiadE3bkCPDi1SYEvakfiFujnpL2AS6
cF7WV+op0bHVWrp4aYh6C8i1z/DOvtNIPQUmVJzI58WLgHhyDGE3oPPkWyDe
PEYmdgsePxIDqZ/Fyv5UXs9AF1Qy+TI8lyFl2QWI4SrTbwrTJ5Xygw19EMD4
E9jRmTYQp3pJvXHkfr49zC9tQlIvxfG7EXttXw8hyR/AtlCFo3+JBMuZ+V4s
q8/0fOgzjIXMuAUtfP+NRTcx/r/iUceZingBviDzkBQt6ZdqxEDGvbBedP/W
854ZCCE+TBR+6WrhLdJ5KexmBc3yOxe31wc7Dz1wvpenhGCyfriStSx5lamA
dLI/COVo0rQ8OdSQ/cP1nOSy8cB5GCfnAx656MHRz2+fH8TXfhgqWFbRfDlE
Zzfvy4xaor4C6tProkf//en9ADqJGo375bSfEjheopT37T+otwS7vC93DPkq
qaeC2lFLkqxdRT01nAx9JrOGqOl6NFAs7PZNbtRQTwcr+viL/i466unBwVko
+7muhTHyPqGgeox9bEIP9P1CgKA9WNttoPUrsObA7bf2GWg/I+RLtDfPfDJQ
zwS/Er99t3E1Us8EH/O46gtGA/XMUFP9dDrsgJF6q6B3KK8Zad721qBu8PdU
7lkT9SwQ4C6M4fwxwl+i9eVK
           "]]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.1]},
         "47.78667541503906`"],
        Annotation[#, 47.78667541503906, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}}, {{}, {}}}, {{}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAUD8YAhxQ5D8WZTY5Tbv8Pzi7g0eA
3ui/4ImPieaf4L841ZIJmIfiP4yKxM8MEvM/VPOzggj7478kWCGQkpbpPxxD
j7qKjeC/MO3fwIDj0D+cIXWo78rrv7wI/TNor+g/wCTpWlmhtT/4LkNCuobn
P2C6T7rDNOG/ZLx6BDbD5D9QUbtuWJ/Kv6zJrXTCi+o/QN2S+B+p2T8wFE/1
q6XnP+Q84XJxceK/+JTe1yCa1z+QgvIa/dPfP6owSxWh5ABAIBj+UQ/Aw7/w
M1c0abjAv5yJkKYLKeC/QJDMx5t6wD/wFdBt+4nuPxY/j2eIRQRAeFy+N3jP
5D90MZKdt5PlP/w7N3q1N+s/5vpyzTAh+j9QRRHsfPvDPyDjcjvDLvE/aH47
lT6D2r8EZ/CiFxzgP+CjN5ZKr+K/AJua+lfg6z/bhKt6
        "]]}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}}, {{}, {}}}}, {{{}, {{{}, {}, 
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`], LineBox[CompressedData["
1:eJw10n8slHEYAPATjjvsajFhFhJa/aGxVJbn3UrSsi5FLpqxqIZSM5wkG8rQ
j6XhlKUyUm0Vs7q4PRuxM0dnfpRokebXiXvv3vuRFuV9v/ds7959932ez/N8
v+/rnXw5OmUDj8c78P9Zf3NhRjms9Zc56SGIDRO21xY0bFHoIJUNI5Y1hPu8
tTVArWw9DPjrieRuXLoe+lXrwaCuT301bEAPnMdg3mqL3bsTDPH0GFBvmPKO
ZIinQ5dWVXjwKkM8Ghk3pqw8hSGeFouibT91xTPE06IgajDAb6elfgnTH9Cp
YgEDbLpqEbOyI4RPPSz9NJifY+xob9IDy8vm0WFrifNhsWW+OZTOgvSKUE+8
GTT07/k9Hqgj3k+kFWPdxcs08aYxuXrEbzWPJt4UiqVmc+U2mniT6FxSXZd/
nCb1E7gg9sCzrjTUsPlj+NxVpVnzoOEc228Um1uirk8qaAhk/SFMdA1IqpJZ
PDV+1Kkl8kRLfS/2GH7cPi+z5HehJDS0qyJEB/fYfTnetM3Y3lZOQyG7bsaX
njbxubssHo938A51Zl+3Fuq5fRioiSv+M7xM1nJobfocUe9Ow17Oh80h/i6R
gway3wu+6X9n+UNGy3ygrNeczI81QjA3P2S+WpF37DbCBe58IBNYpc18N8Ej
7vwwIb3fNliwAmrufiCbp/TZcdSKIvcHYsahUpRgTXH5U5BTXLrm22JNcf40
eCU6hyXY21Dk+0DbXJqwUWFDcf1mQF64KC3LsiXeHIhH+0KDovnEm4fOwpUI
pYJPPA0Uebt3L0TZUdw8i/DCa6mussKOeEvwIcbv0Olse+JpQXlLcfGaUkAN
cP8nvP+y31TeKaDI/wuXOtycI0qFpF4HscNWGeXfHEg/PXhObVsZqXAkHgO5
5mONryVOxGPgyLOcUzWlTsQzgPDxDb6/SEQ8I2x6mOT4tUpEPBNkxoh6VOMi
4plBNvoGl3Ej9Q9nRdH8
           "]]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`], LineBox[CompressedData["
1:eJw1kntI01EUx3210ggWGYN0qUR/JT6YQlB6RmYiYZr6RwaZLB+JZhZShJRa
QaTOVhK2fK0iyVB7kKGinZyunJktNXU5dXNqifM93SZq/X6/e3fgx497zzmf
c+75Hh/J5dgUJwcHhxDmY//ErPhxZdNTkN6NIs4seErC72of7MJUztZQwj9z
I2JMhU/lrK2iYp9/m/NSC37vYc3M3muXVQokPDMeGLGFhl14BIS3gjch2E+x
5wMQ3jKOR0sts/FNQHhL6Db0IsB6rBMIbxHjjS9FYl8NEN4ituWUFn/dqaH5
8/jqy8myofA+4MJ7TGy/7rmVfbTeLFrjjK7t+T+Bw8tn8CCvQC70GKa8v5jR
mvOGrxuivGlUeb9VjvoPU94kFmX+KVe1/KY8I357Ft4a0K2nPAM7j9GapAnK
02Oue8P50pIJmq/DwB11JXrBBDzh4rWY/nDO+901AyRz9QYxtml/WniKAQI4
fj9qey2HEtbHKU+DR8ejhZ7CUZqvxhhp2Vb2fR2N78CkKU1DZNoYyDh/M8qU
q3UdYzrI5861eP1TtRJ4OrArzNQfCGTiFcQP5s0BWYxUT8/NkJaaetfj+RQc
Jnxg3judvWue+tUwYrtVqJUv2PuDH5a47W0P5iCI9A+MXtVOYSa4SN4HTP8+
WUEmqCDvh4pO76THwgXQkPkAo0fBiVizfX6s7vx/6jUab4ArIW5RnVIL5RtZ
/iWfYqtdHzb+dbuvjdabBmYeVZ8b1+36wvvKhY5zfhuUNwPMfskK6zcobxb6
oySTjU5btB8TMHp7CWq3KG8eGH3VeVEOYrp/cDb5yFXlaUdxL9lPEGh7y+/c
cxTT/WX78623OYpJ/jLrF0V7OYtJvRWQlmX5ZeY5U54ZjhdlZtSIXCjPDMz+
7B0IcaG8VQhObEkIvb2N8tagIcJgynXlUZ6FnY9rVSSP8qwgDk5c3/2LJ/4P
pvTXWw==
           "]]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`], LineBox[CompressedData["
1:eJw10n0s1GEcAPCbTGFhEsm8tfFHE7WshPq2ScnWxFrDTCWamTlutsQYvUgs
0ct13jbMVcRWxHZjvsPozpCXMXLk7ThHN/fqx5Ty+319t2e/PXu+38/3eZ7f
4x7Hj0gw4fF4F/+PvS8XDNZ3XHo3/HELz7KxieEtj+1lWgYfsGFE8acKXlD2
NpaX7YUBg57tmj3qN+LgwF7osTghqbrqpx45T4+1Pu2/Kzt15OnQn/GWN/Vp
yNOik/l0n1CnIU+DiSHCP+X1avI2sK0rPulakZK8DYz2sO59GqqkejX6xr0/
JxtQIJs+sI5VhTk8WZmC+q2haYV5atuQAlm+bBVX+LauMxYz5CnxqId9fl2a
nLxlDDNm3vl2f5K8JWx1Ef16HjJK3iLyWv6GNzl+IG8ebdK2gr1HWoDz5jDS
mOierGkBrl6Od9Mtt7wOfQERmz+Fc/zYkBuNQohn+00gT9hZ1OspxNOsP4ZX
drubK/sktL9h9HMMiYp+0YdcvQyZDEl6hrif8nvwZrAwFlylWMKuS5BxL31Y
viDFXHZej/m6msGeUBnu/+GdyMods+MSrObWIfeM/XhUdB1wcwkMbPtr151H
wY/zgT8eWBuWMUfrMkh2OhAsfjlP5x0Gh5iaQROFHHy5/UPxdKPQIXgSErnz
QcHtgCmXiBGo5M4POycvNFhljcIwdz8gOCU1qC5P7t8fyHvM1Fn8acqfB+n3
w8nb8lnyF+GHzdVOO+sFut8liCl5kpfSMU/9lkH0uvTNpKmCPCXkO79ya0hd
IW8VXKLEJ8xxhbw1CPzqlu01pqL9rEOOj+KglWCdPDXYCY9U3by+Qd4GjOcJ
DLZtGhji3iesNffmGkVaoPcLArv4Qs8JLdVroan9vMGjW0/9dMBUCHpNl/Tk
6cEl8Ng9fycjeXqItpQ1uS4byDMA+quiPqs2yTPCW2VXeQDDkLcJC6EWotmU
LfIYKMtsVRXcYuAfyG7riw==
           "]]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.10475170984656268`]},
         "47.865346357524395`"],
        Annotation[#, 47.865346357524395`, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}}, {{}, {}}}, {{}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAUD8YAhxQ5D8WZTY5Tbv8Pzi7g0eA
3ui/4ImPieaf4L841ZIJmIfiP4yKxM8MEvM/VPOzggj7478kWCGQkpbpPxxD
j7qKjeC/MO3fwIDj0D+cIXWo78rrv7wI/TNor+g/wCTpWlmhtT/4LkNCuobn
P2C6T7rDNOG/ZLx6BDbD5D9QUbtuWJ/Kv6zJrXTCi+o/QN2S+B+p2T8wFE/1
q6XnP+Q84XJxceK/+JTe1yCa1z+QgvIa/dPfP6owSxWh5ABAIBj+UQ/Aw7/w
M1c0abjAv5yJkKYLKeC/QJDMx5t6wD/wFdBt+4nuPxY/j2eIRQRAeFy+N3jP
5D90MZKdt5PlP/w7N3q1N+s/5vpyzTAh+j9QRRHsfPvDPyDjcjvDLvE/aH47
lT6D2r8EZ/CiFxzgP+CjN5ZKr+K/AJua+lfg6z/bhKt6
        "]]}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}}, {{}, {}}}}, {{{}, {{{}, {}, 
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`], LineBox[CompressedData["
1:eJw10ntIU1EYAPDlnG+T6crKaSpR2VKCNIus77ZMc9oWhmk+inxk2R+ZRMgk
sZqiFSGl+MpYVlCWmTRK8XEyLV3NR1qKJtM1W+6R7eVcUFbee/bB5XI43/l9
33kEpJ+Lz7Kj0Wh7/n/Lfyqs6KYkcKpdY4btZCyi5KCWOI9cM5wiw4LEaT2j
+l4T1NYsxwJ6FvZcvfe8CQZky2FGlpzI8WsWI1CeGb1L2DqxatCIPRPK270k
4PGM2DMiNife/mq/AXsGxOUkxjLqDdjTI14iUwqxBuzpUZ0suWFznx6vn0ed
zX2Gb0/1QKbLdCgsX9a6FKPH9bSo3lrB7nc3AMnXqFGXwjWhpXEEe3PosNuX
UkHQbeypUO7F2hTx22nszSJm77GRbGdb/0o0danItUxq8xQo9Oi+rNKHauzN
oBBWpiS9RIHXT6GNZ0sfxTNmoZrMn0DN/AMPCuK+QyZZbwyd5Gllt3bNwTbS
H0XGgA0uO9ZqsDeMhvw5WrqjGq+XoijnDGFSkRbn96DAQa88r0QtlJPzbegy
3Zj0sV0LReT4MeJ+4PK9lTaPRtP5SaY5kToQU/OQ4zYrU/yZx+M2OLTeXRil
NMBOyodgvz7HkigznpdCYdqZzkrGgq0/iD2o+xROmCGU6h8i+MXWNz9NcJra
H3AZqR2Tx01wh9o/rGxlf5Z7mmCYOh8QdTTPdIt+284PWrsyu+9V0QkqXwEv
S3Kamo6sIChfCaK0xkr5AI3A9wNoi5Cr4tMIqp4KhtzuZ3uzaAS+X9jf+0pc
zLTDnhpeO/pG10fTsaeF8aSUtrw5e4LqRweaxbHOrwIn7M0D377hRJLABXt6
KF8ZfP2HgzsxSL1PCC/gEC90HgR+vyC/Ua0py2bi9UZQFV7QhFR44nom8Pd2
EjZksLBnhvwnrFShnIU9M8gk4fr23tXYWwDLr03dV+6uwZ4FHBiTf2dCfLC3
CFUR77tjtD7YswK7TrQuqNqX+AcZ1Mte
           "]]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`], LineBox[CompressedData["
1:eJw1kntI01EUx5fPslJnIhb5TGcaUWJPyM5EpMAeYCgpxlCWmaDNwFcoGpEr
xUe10sYoHyHaH5EUoiO6Ou3ho9gMG+Ir87XtN9c299ORydp+v7MDl8vhnPM5
33vuCcu+lXLdhcPhxNuP42bNSoIyhOe6e/UQx9gGKfn40rsmSA85jK2T16Zx
LldFgfS5w2gS9vZ25uEOCr6NOcxCRluT5LZhCliehTxLrPWtukIhb40M0geF
cgGFPDPRbHbtHVPrkGcij1fLbTKTDnlGYr/r/kp0yDOSRgUdSl/VYb2BfEku
uRYj1wKTPqYnkkA3W71eg/0o0qCgL0WlLgKDf6518FOsAZ8Jy9OQ3mD3hLyC
ScLylkl0ZkN97eR7wvIWSaRHgjRL8ht5C+Re/0h2m2AFefNEx+ueXRqYRX2/
SFvSCePOUhXqmSavRPFuG9NqaGbyJ8nASOtMCD0HQqbfT3t+z80R7QwcZfg/
yExEtcBHPYE8pd33SH66+xPWDxNxQPqsVDyE+YNE3S7i8pSD0MjE+4hsqMXQ
qvkKVYzfRSrzznS+KFCB84czGxRiF+4UtLBxSOkNDt5KXUC/D8zjF4vDPCk4
xfKh6EmgJKLeiPFhkA2Flm6PNTn1QaTH3SBurhGOsfqhucBvKlH4B3LZ94Fd
f3fHnVWQse+Hs17quIkLelCy84GQ+1R0vmzdOT8wlMO2oiYb5s+DW5r3ad9+
K/IXoEzLgxsHaJzvItj/Y/T4eTP2W4bKvA9SD08z8jSQv7JZFp5DI08L9n2b
fzPq5FEOfTPVbluoRw8nHyaIOk0cPsszQMu+I4/SIl35uH/Qs7Ylmatx539n
9xP+dZli9ss9+bi/jvnJpZYdWG921Fc0Re3is/3WQMeLFVVkeCPPAl7q9gfp
Ch/kWWDucp2gMIuLPBqWlOHJU8V+yFuHQ+KAwndLe5C34ZifKk3rjzwrFMZ7
ufb5B/D/Awhy104=
           "]]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`], LineBox[CompressedData["
1:eJw1k3ss1WEYxw/mXgv9g4mclsRG5XZU9vymxIYpIxqFlly2Mrcum0WbStiI
COU2MjQrG0Xb8WRuY3K/LCHn5zg7xznM5eQcm1J+73u+27t3757n+TzP877P
a3s7KThWm8fjef1fBzuRGj1L9VqmPX6BCycVpoR81Ze3L8JdTjtoZm+TwZgv
QUX5gX6jWJm9Mp+wBN+HD6TExnva/bIGERCeEqt+Cu9PGYkobxtr0kLtlxxY
ytvC0tqPDkXWLOVtYlW2f7xzE0t5G6grf/AyvZilvA2Uyd3+lJ1YpvHreFQQ
NZtjyQLnPqxAIZOUf9xHk0+OOUF6xbvnh4DDl8uwOa53cipajIQnRSuVv7BN
fxUJT4KXzZJNXSxWkPDEGO0t3RNE1VLeMlYYnb4ZGz5DeSKc8caV9OReWt8S
8iwrI3JaImn8PCocGxf4wi4o4/x/IF/dkeJ3bRzucPlmkLfmmLr4rR/OcPxJ
jFQ+bK4w6Kb1jWG/1dW8FN4CkvhB1H3ibpx3UYTEvwcFGREJvCQRFnL2Tkz0
vtTDK1jELO7chHndhwI2pROoeWGTXfPMknN1WEPsIC6MFcZ0jAA5d4Jf3FN1
uy8LAsKHx6ZTzPMPMmofhLSwT7E7Hau03zH4+8JxeMpGBq6kfvjMWPZpySQQ
T/oDdwiRvfEQwzvSP9yqTxMqUlkYI/cDnYGnUs3bNjT3B4kZ7ZkN+yrqLwJ3
rwKn3NY1yl+GCeet9/zrIvreYnCNNCxRvx6l+SSgnCs5u+00SnlS8LOwHZLU
z1GeDKrGXBKvmEgoTw7GZaG+9oINWo8C9NzCfebttilvHdiYR8+adlSa+YMv
rZVedcf2YITMJ2S1JjkaHdnXzC/Y5ydW21pqMSR+C9I80k+O2+kwJN82FNkE
K9rXdBj6P4AfZn2ja0CXITwlsNN9lYF7+gz9X9AQdKE5rsqA8nag2qyh19jT
kPJUEPDWondgxJjy1JCLNrOv+IeZf5Bv0jw=
           "]]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.15262383550201264`]},
         "48.65793373463762`"],
        Annotation[#, 48.65793373463762, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}}, {{}, {}}}, {{}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAUD8YAhxQ5D8WZTY5Tbv8Pzi7g0eA
3ui/4ImPieaf4L841ZIJmIfiP4yKxM8MEvM/VPOzggj7478kWCGQkpbpPxxD
j7qKjeC/MO3fwIDj0D+cIXWo78rrv7wI/TNor+g/wCTpWlmhtT/4LkNCuobn
P2C6T7rDNOG/ZLx6BDbD5D9QUbtuWJ/Kv6zJrXTCi+o/QN2S+B+p2T8wFE/1
q6XnP+Q84XJxceK/+JTe1yCa1z+QgvIa/dPfP6owSxWh5ABAIBj+UQ/Aw7/w
M1c0abjAv5yJkKYLKeC/QJDMx5t6wD/wFdBt+4nuPxY/j2eIRQRAeFy+N3jP
5D90MZKdt5PlP/w7N3q1N+s/5vpyzTAh+j9QRRHsfPvDPyDjcjvDLvE/aH47
lT6D2r8EZ/CiFxzgP+CjN5ZKr+K/AJua+lfg6z/bhKt6
        "]]}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}}, {{}, {}}}}, {{{}, {{{}, {}, 
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403], LineBox[CompressedData["
1:eJw103tIU1EYAPC5tlqmWVGhgZETpUKmNIu09LvZ22SEKx8llK/pzDDppUQ4
ZZSklYmFWmJZaGZa4h9lKQcfsRab+TbRdKaM6R5tc87hfJT3nH1wuRzO+X7f
eXolZEQmMxkMRsj/b/WPw4Z6diSE+/PYFJ+OecS9XhVU2cCiRHRY0TWf6NtL
XBZVXrYac4gp0IdpVpiUUrEaFvS1KjjwHYNJYc+CWsZTf24cdiLeLEoNeOLF
bWUQz4yWsn8onUUM4plQ9Vkk5nisAPaMqODccscXl2XAnhFV1Hin9UgXAecb
kMA/ek+a1A70cIUOSSIO7FalLwCup0WL9m+Mmi4b0HzZNJo51T4eWWslngYV
1Y8NRX2eI54amQT54ldrLcSbQtJFiSFCZibeJNLNDAtfq4zEm0BP3XfejI7V
EU+FVF3HLvLVOpI/igxTSfYTUzoopccPo16+LdHG0UMSXW8QsbYcHogR6yCA
9vtQXpBvpssRPfG6EbSxTY9KDCRfjnqddoWKwh3jO9DJv16xzwv0UET3NyP2
irBENqgFCd2uRXHxHvsjbmjBccJFwrutfUodvMT98HZ8ZCE2Vk/azZCxlykL
YBvhIPYhpTgLCq+YSb8ceMpfjZ+kZsf8IKUpXf6wxwSBeP5QNytrG8s1Qipe
H/z5yBtsaTPCC7x+8K2ePjoUZIVuvD/w5jS3MUNhd+wfXM4oeP84ikHh8RNA
1d73rhA7UdifBLm0K6ecYlLkfEC+TxNfrmdSuJ4avjfJzP3P1pD7p4GBxEO/
Mz1YxJuGzvbtgnkNi3haCM4e5eZVsik8Hx10amQNksK1xDPAtvy6B0331hHP
CPY7H6JCPDlUF76fYCrxkBUfX++4vyA4Y2m+xHcm+WZI74nxFMZtIPVmYbSX
d36KcnG8D3CvuOoTdsuVeBao96tJ2GpzdbwvMA/JkkMtbsSzAkeRZrigdiPe
POS4+7WKRjYRzwa5/UlZuaWbqX8MbNCJ
           "]]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403], LineBox[CompressedData["
1:eJw1k2tIk2EUx+dS2wdRP0hXNW+l4AczNUsdZ4YRZnRxUqEiJlMsRMXQLqYV
ZSYm3oLSzEtNxJIgyMrKTmUuNd3mtMzwsjmbrnmZbm7avLT3fZ8deHg5nHN+
//M857zuSRnRyWwWi8U1H+rL2DJeTC23ccn7gQG0GVEl9YjzXJdgCm0GfLYg
c0lpF2N1FWVLWDvfdEc23od9vZTpMdfpxZHv80+Q4emR0+Ic4pDTSXg6jFE2
hg6stwHDW8TgovD6KSchMLwFDBs/0a4TiIDhafHSx7qQM10vgeFpMSjh3bnz
aTJSP4dF4YmtEa4yoNN7ZzCiOM3oYCcDRk+DBp/4DDfuL6DxVWpKL3Hw8Bjh
TeNOv9FAx5gRwlPhqJete71cQXiT6M9pEZYlKAlPiSUP0qv58knCU+Cx4KIS
7rqc8ORYoDmVWB72m9SPUP33JO8fhId0/jD9LkLnfhDQej9xtXnBI7tKDHtp
/gB+7ml47MqSEp4UW5xjB3Vv+0l9N7rECuK+be0l+R2YXbktZt8uCZTR8TZ8
1ZWTntIogRu034zTpmZ/m4PDYJmwtz/nrqdoAuqZOFTMXmu6WqwifhsUbhnO
yuP/hQMMH+JLv1jFNmhJvBtqvrqtToi0lv4gD4KOVxjnIJDpHzqWfGrY9hpI
Ze4HV9R7GrruqaGGuT/ECkLfmKJmQcq8Dww9zYx01lt4csC6HQHKKB3JV4Aw
k1vr+1xP+Eowzy/C46jBMh/YbXvTJvi1keipgO1buDjZsGKZL/zLvxB9f7uJ
8NRgfdo+V1y5SngakBj5fgNDa6SfGXgfaZfj3bpBeHNg3g/+oU4Wj+wfKBsf
bZwMteKJmf0EbZPo9ocgNo/sL/Veii1KNo+pX6T0LpcWbOIxejr4I/VQXHe1
Jjw9mPerqm/NmvD0YP6/TPljNoS3BEmOZ6Oia20JzwDFaVONC4GbCc9I+eVe
WRzCW4Zbn3oUuSsc3n+6qdI0
           "]]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403], LineBox[CompressedData["
1:eJw10n0s1HEYAPCbeV9LR1uHVGqZQmnp5qX2+KNRcwr/MKklEVPTGxO1RPOW
bujlaNdqV5eXUIkatZ6jRdbhRDl3l4h0wu2c4w47yu/79Wy//fbd93k+z/fN
9VRKRLwZi8U68P9b+ZMwovZy262027aSvUwYMLDTUhxXZy1JYGIOK3PYAdUL
VpIH5Ssxi/MhrXd+vbOUdEpXQo+xDul89zIzCfH0GJha80aWZ069GUx6WqtM
8l9C4ukwUVns2l64jMSbRkVUcsaX6/NIPC22xFSrXvQuIvG0mJse1CQ8MkPr
NVi0tqIrOFWHTLp0EocsszzlCdNI+k2gVffuUq+T48jw5eMI7NwPIsdB6qnR
Lkoy6+83SL0xrAljH7T1bqHeKGalxn5KU4uAeCNoGS/2yTZ1A/GG0TqqR8Av
agPiDaHaSdBvF9pI61U4wyuMbT3Wg2VM/gBWn9G2V8r78TTT7zvaZ+Tm7fdT
oDfj92LeD+sK5Q0FXZ8Mdx6O9OO+HaD1HcivUm6xuKai+R9xU4jHCXOjEouZ
+SaM3ren2d1ajlnMuAobPDKdfRWvcPWGM1zcxGNXe+AxmQfjXEAlN/MnHTeB
t7w2slw4Cr7EBxHHMf9o3RSd74D16T1FG+01dL8y8OSU2Njw/oIPWT94m7c2
BHN+QyLZH3he0N7bcH8YhGT/0GUM6iw5pAIZOR9wMy7mbkuRr54f6LKv+Air
+2n+MDgF1H27tEZB/RFoZEvZm92GgN4PJIfG8S9uHaH9xmBUZVoCTzX11FBy
9n1fAWuSeuOwzBt8HfNcQ70JcDdpOKLzWrqeSZhqyeeHhuuop4HAGhd/kZWe
elq4+8guvKNeD13kfYIq9c9Nacgc0PcLX5+5Ogi3G2i9DriNeWLBcQPtNwOK
h14KrtFAPT2UjvU519vOU08PvHOmHb0Fi9SbhSclslhp8QL15sDZ6XPzOisT
9QywK2wqwhC9RD0jWLwUiMdzTPAPyjfjWQ==
           "]]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[
          0.5643000404374403]},
         "55.47378657221794`"],
        Annotation[#, 55.47378657221794, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}}, {{}, {}}}, {{}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAUD8YAhxQ5D8WZTY5Tbv8Pzi7g0eA
3ui/4ImPieaf4L841ZIJmIfiP4yKxM8MEvM/VPOzggj7478kWCGQkpbpPxxD
j7qKjeC/MO3fwIDj0D+cIXWo78rrv7wI/TNor+g/wCTpWlmhtT/4LkNCuobn
P2C6T7rDNOG/ZLx6BDbD5D9QUbtuWJ/Kv6zJrXTCi+o/QN2S+B+p2T8wFE/1
q6XnP+Q84XJxceK/+JTe1yCa1z+QgvIa/dPfP6owSxWh5ABAIBj+UQ/Aw7/w
M1c0abjAv5yJkKYLKeC/QJDMx5t6wD/wFdBt+4nuPxY/j2eIRQRAeFy+N3jP
5D90MZKdt5PlP/w7N3q1N+s/5vpyzTAh+j9QRRHsfPvDPyDjcjvDLvE/aH47
lT6D2r8EZ/CiFxzgP+CjN5ZKr+K/AJua+lfg6z/bhKt6
        "]]}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}}, {{}, {}}}}, {{{}, {{{}, {}, 
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.], 
          LineBox[CompressedData["
1:eJw10ntIU1EYAPClxiqbrzVMpUSLlCIyemCifTfMMiMZZWb1h5g6h6aOzBAt
LRQFX2QZPhqWZKZmQZGZLjjY0ljMYT6W5oqZS7c2t+m2u2s5Ke89++ByOZzv
/L7vPIKu5J5Nd2GxWFH/v7U/ExT6EWu6nBrzBw7QYUd7TiZLKbdlENBBouJb
4tOJagqam9bChrpdp0WXOigYlq+FFckcE21ZERQwnhWdh+DIM/ft2LOgj/Gv
4yoL7NhbQvMZotaSjXbsLaKq4pXq9Rw79szosOpYfkcXiT0zcigJVzKLxOuN
SOoe1y9hk0Cnyw2oIVvRX+9B4np6lBMc/tXPkwSab9Kh+PfKtsxJG/a0SLvN
K3ZRY8PeHJq54MH65ur0NKg7RPZElG/D3iwqD0pX8kos2JtBikej+WqJCXtq
VFCqal4Ym8PrVUjeS7GsL+ahkc6fQubQgbIjGTpIo+sp0WyKgJt0UQ9htD+G
3FvFz/KNBuyNoP2WuNhrN4x4vQyFDCXwBzhmnC9F6kpViSh6AO7S830obIu0
KkDyAW7T407kf6oholQzAc4bNuxgr/Zy5+ExMw+b+YWf1RIDHveBb92rnucB
ZghnfBj2V5wbTLbieRmUPfQ1vrVYnP0BcYKXrShdhINM/yA4Ol7HCzaBkNkf
aKIHHb/aF0DM7B8EFS/rq/YuwAhzPjAfVfQ3nnIh8PlBceOUYWuKG8Hkz0C7
YJ+X7ieLYPxZWNVmLie3OJz3A1ZhXnuhfAXXm4MEihe4U+tw3i+k2mO6a8pY
2NOBNpT/oPyOC/b0wD6e0dIz7EYw/Rgg7fu4cF0Ym2A8IyQpRY6c7A24PzNo
I6mQsLJNhIJ5n5Boqi24KnQn8PuFe3mSN4ECDl6/BF+2d+ZWdHvgehao3fWO
1Ux6Ys8KnArjuM+EF/asoB8VPfXL8saeDYa40zcFYm/skfApoHqAX+qDPTsc
Ml3vqtH6YI8C79/eu4smucQ/jbzXnw==
           "]]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.], 
          LineBox[CompressedData["
1:eJw1kwtIk3EQwNc0S10WiabQ08QSM/OZEnZLS3BkhWmIDVmiZlimlKUSWAkO
K8mKLEtIURJFUEwqH/E3TckyW/maj+VjudwcY3PzvUnf476D7/tz39397u5/
9+1LvB6dzOfxeKHUQ5+sLBNX6wtvPfOGwJ+RJRLS9DWhykYOKYwsEvHjDte8
RyPwqpSWBaKv7n4S5TYGP3ppMRHqPN09OQYsz0QmzhZJW85xPCPZP7YSpAvg
ePMkR+1xqS5mFHkGktZ2My359Tjy9IT6vqK1kiNPTzQevvKnWeMYryOtkYJV
bf4oMO69WpL1zEW8a3gE882RwhOSwJVMBTD4UjXxkjoX3v/A1TdLqFf8b9EE
8lTke8WpYN3xP8j7S9sz7e9MI09Jfi6dD/FTzCBvijjmt99qcVcib5Jc+7eW
lXpGjvHjpGtvQ9WBqwp4yfiPkPWBbM8rlmlIYvIN0f6lkdYqOMLw+0lmqN3R
7dGzyJMRk2WgeDpYg/E9ZDBbLSob0KB/Jyl6kS6KdntHihl7M13fjcqmBnKX
0WvoeR7OrS8HbsKUnl3fNQTlrB2qMkJ9xG9UqDdDxHtjbOOkBoJZPjh4N36S
lRjQ3kPrgx1KPVcfxCcd8yn8ooUAtn7wUbiv5/prIJXtDy6npDjfC1JDGds/
SGZktd4CNcjY+wFhYEJYf6yZuz/oXDi4c6uZJ2T9p+g9iKmLX0a+EhK3xUWa
Xea5+cBwZUZXv7se86nAbrgyoD3cwM0XZtdqbK3rTJhfDeYaQ8HzKY43ByXh
Dw/ttpixHi2ESWYkjjk8IcvTwedvFTnVe/hC3D/ge0lXeWIrYR+7n3T+XxFO
G4W4vzT/geW2DcbP0/0FtdZuErL5jBAX0tSmGtyMPBPNj/L7aIs8E4gEfPt0
ox3yFoDaD6fUEnvkLdL8PmmBAHlLQP0vF3f4bkHeMlD7veFks4PwP0rG0pA=

           "]]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.], 
          LineBox[CompressedData["
1:eJw903tIU1EYAPDpzOwhmAujklCjTNBVKiL5+G4Pksw0pT9KQtHSDRtG0TQM
TW2oKJYDETWFQG2LaGrgi6zPjFY+UyNtlm1zDzana25OB2qW9x774HI5nO/7
feece65v+u2kDGcWixX179l8M+FAaWXZnsZdZgyhYwX9pu3+l9hzmEnHMjbf
yskPCjVgfd1m2FGQ+juBx9XjyPBmLOEgV7nmUa1FxlvCUW6XRfnNQDwb8vuz
Uo726olnxWR9jzrpnYZ4i9hGiWQtBWriWXDq0JzlRqKOeBbklF7mXktXkXoz
jo6U5pVXqJFOH57H3hjR/t3nZ0k/E7509bHeuzqDNF9nRONsUFGLVUk8A0pz
KYHPn+/E06PtoOxJhfgH8bTIj7pQEzD0iXgapF7n7NNY+oHx1Jhc1/MrMWwQ
GE+F4bDc/koiAab+J842zTwedcihls5XoJdzWsNJfwXcpPtN4opA7BPRqoIT
tP8VJxW5clmHhnhj2OmWqkha1ZH6AbyeEWDvqNSR/A8YLj6SoQ6ewCp6vged
SioeKrvGsZAev0Cvz06tzd3j+P8T22MEvsWP8BkzD5FiVvVUsQqYcQ+kxIoo
93IdhDM+NBYEJnQ/XSDzA8DNr8trlJi21gehkXEiYZEeQpn1g+OBMEt1Tgd8
Zn9gLNt+3FuuhQZm/5B81tb3ZU4LY8z5QJv5Y6XbG+vW+YHHc0vNTu4qyVdD
Q63Q0125QHwNeCr3ZqTHT5Pz1UKfPfswzzhE+ulhbVJ+7E7+BPEMwPGsEioa
VcQzQrxLiTyi0Eg8E3hvxHiPp1jIeuYhWm5qjxXZiGeGpIIWEzatEM8CYcGB
9U08B4wy9xNkbc1XzojWgdxfGO5L6O/kbJB6K8guctbNUhbF9LOBX1zb/ZAO
J4r8H8ArzVyMljtRjLcEb+/6DUk92BT5vyBecjqYvcSmGG8Z+N5DB7JdXYi3
AoL6jTSO2IV4Dgg+tUMmfr+N+gtnXOHw
           "]]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ]}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}, {
       TagBox[
        TooltipBox[
         {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
          0.009166666666666668], AbsoluteThickness[1.6], Opacity[1.]},
         "62.68738495394587`"],
        Annotation[#, 62.68738495394587, 
         "Tooltip"]& ], {}, {}, {}, {}, {}, {}, {}}}, {{}, {}}}, {{}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6], PointBox[CompressedData["
1:eJwBUQGu/iFib1JlAgAAABQAAAACAAAAUD8YAhxQ5D8WZTY5Tbv8Pzi7g0eA
3ui/4ImPieaf4L841ZIJmIfiP4yKxM8MEvM/VPOzggj7478kWCGQkpbpPxxD
j7qKjeC/MO3fwIDj0D+cIXWo78rrv7wI/TNor+g/wCTpWlmhtT/4LkNCuobn
P2C6T7rDNOG/ZLx6BDbD5D9QUbtuWJ/Kv6zJrXTCi+o/QN2S+B+p2T8wFE/1
q6XnP+Q84XJxceK/+JTe1yCa1z+QgvIa/dPfP6owSxWh5ABAIBj+UQ/Aw7/w
M1c0abjAv5yJkKYLKeC/QJDMx5t6wD/wFdBt+4nuPxY/j2eIRQRAeFy+N3jP
5D90MZKdt5PlP/w7N3q1N+s/5vpyzTAh+j9QRRHsfPvDPyDjcjvDLvE/aH47
lT6D2r8EZ/CiFxzgP+CjN5ZKr+K/AJua+lfg6z/bhKt6
        "]]}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}}, {{}, {}}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->800,
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->All,
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[46]=",ExpressionUUID->"1da52e9b-2c65-4fbe-8f9a-2dfd5cefc037"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1904, 988},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowStatusArea->None,
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowGroupOpener->True,
TrackCellChangeTimes->False,
SpellingDictionaries->{"CorrectWords"->{
 "loglikelihood", "Skilling", "unnormalised", "parameterised", "logevidence"}},
Magnification:>1.3 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]

