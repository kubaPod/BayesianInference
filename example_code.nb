Notebook[{

Cell[CellGroupData[{
Cell["Nested sampling with the BayesianInference package", \
"Title",ExpressionUUID->"c3f34d57-925e-4f95-92c2-19d5b664416d"],

Cell[CellGroupData[{

Cell["General", \
"Chapter",ExpressionUUID->"624c9164-0fe4-4f1e-b362-624e99f78c18"],

Cell[TextData[{
 "This package implements the nested sampling algorithm as described by John \
Skilling in his 2006 paper \[OpenCurlyDoubleQuote]Nested Sampling for General \
Bayesian Computation\[CloseCurlyDoubleQuote] (Bayesian Analysis, 1, number 4, \
pp. 833 - 860; available at ",
 Cell[BoxData[
  TemplateBox[{
   StyleBox["\"http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.117.\
5542&rep=rep1&type=pdf\"", "Text", StripOnInput -> False],
    "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.117.5542&rep=\
rep1&type=pdf"},
   "HyperlinkURL"]],ExpressionUUID->"d90716e5-c339-4a0f-bef1-e6bd26265ab8"],
 "). "
}], "Text",ExpressionUUID->"fe56e51f-9879-46b8-bd1b-3b8a3cf97438"],

Cell["Load the package:", \
"Text",ExpressionUUID->"c2cd2525-6743-4f5a-a26d-65c7614a84ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "BayesianInference`"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[167]:=",ExpressionUUID->"9091f228-26fe-4eaf-9bca-4b7d4425d20b"],

Cell["The general workflow for using this package is as follows:", \
"Text",ExpressionUUID->"5dcbada7-f440-4639-9044-7fc10730d39a"],

Cell[CellGroupData[{

Cell[TextData[{
 "Define an inference problem using ",
 StyleBox["defineInferenceProblem",
  FontWeight->"Bold"],
 ". This returns an ",
 StyleBox["inferenceObject",
  FontWeight->"Bold"],
 " that contains all of the relevant  information needed for the next steps. \
defineInferenceProblem will do some sanity checks to try and anticipate \
problems further ahead"
}], "Item",ExpressionUUID->"6b63ee2e-50da-4b21-a5c1-2c763db7823a"],

Cell[TextData[{
 "Use ",
 StyleBox["nestedSampling",
  FontWeight->"Bold"],
 " or ",
 StyleBox["parallelNestedSampling",
  FontWeight->"Bold"],
 " to run the algorithm on the inferenceObject"
}], "Item",ExpressionUUID->"1d7696b3-2f32-4e9d-ac6b-1f64a5d4d592"],

Cell["Use visualisation functions to interpret the result", \
"Item",ExpressionUUID->"d8765d25-4067-4336-ab15-3df55ef272f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["defineInferenceProblem and inferenceObject", \
"Subsection",ExpressionUUID->"941b4198-1153-45c4-baa9-2e7f28efe817"],

Cell["\<\
Here\[CloseCurlyQuote]s a typical usage example of defineInferenceProblem \
corresponding to the problem of inferencing the parameters of a normal \
distribution:\
\>", "Text",ExpressionUUID->"7d895088-c675-4a34-9786-255340e35a3d"],

Cell[BoxData[
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", "100"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"mu", ",", " ", "sigma"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mu", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sigma", ",", "0", ",", "\[Infinity]"}], "}"}]}], "}"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"ProductDistribution", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "100"}], "]"}], ",", 
       RowBox[{"ExponentialDistribution", "[", 
        RowBox[{"1", "/", "100"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[209]:=",ExpressionUUID->"229db5bd-6b08-495b-a533-454eca497c0b"],

Cell["\<\
Note the tooltip on the inferenceObject that gives a summary of its contents. \
The inferenceObject is basically just a wrapper for an Association that holds \
all relevant information. It\[CloseCurlyQuote]s important to note, though, \
that due to its typesetting you cannot copy-paste it in a notebook:\
\>", "Text",ExpressionUUID->"42e4b42e-e8f4-47c1-9b38-32b73edcffb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inferenceObject", "[", 
   TagBox[
    TooltipBox[
     FrameBox[
      InterpretationBox[
       "\"\<<< \\!\\(\\*RowBox[{\\\"7\\\"}]\\) defined properties >>\>\"",
       StringForm["<< `1` defined properties >>", 7],
       Editable->False],
      StripOnInput->False],
     TagBox[
      GridBox[{{"\"Data\"", "\"List (100 \[Times] 1)\""}, {
        "\"GeneratingDistribution\"", "\"Distribution (1D, Real)\""}, {
        "\"Parameters\"", "\"List (2 \[Times] 3)\""}, {
        "\"PriorDistribution\"", "\"Distribution (2D, Vector)\""}, {
        "\"ParameterSymbols\"", "\"List (2)\""}, {
        "\"LogLikelihoodFunction\"", "\"CompiledFunction[...]\""}, {
        "\"LogPriorPDFFunction\"", "\"CompiledFunction[...]\""}}, 
       GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> False, 
       GridBoxItemSize -> {
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"]],
    Annotation[#, 
     Grid[{{"Data", "List (100 \[Times] 1)"}, {
       "GeneratingDistribution", "Distribution (1D, Real)"}, {
       "Parameters", "List (2 \[Times] 3)"}, {
       "PriorDistribution", "Distribution (2D, Vector)"}, {
       "ParameterSymbols", "List (2)"}, {
       "LogLikelihoodFunction", "CompiledFunction[...]"}, {
       "LogPriorPDFFunction", "CompiledFunction[...]"}}, Alignment -> Left], 
     "Tooltip"]& ], "]"}], "//", "FullForm"}]], "Input",
 CellLabel->
  "In[211]:=",ExpressionUUID->"d3dabd78-a362-4b91-9a66-7267189a241a"],

Cell["\<\
This is intentional: if it was possible to copy-paste the object, it would be \
necessary to store potentially large amounts of data in the notebook, which \
would be slow.\
\>", "Text",ExpressionUUID->"c679e254-e3a8-4a9c-8027-42b5bc0098c5"],

Cell["\<\
This is how you check what properties are contained in the object:\
\>", "Text",ExpressionUUID->"8a107e1f-20c4-4c1f-a3b4-1f1117951021"],

Cell[BoxData[
 RowBox[{"obj", "[", "\"\<Properties\>\"", "]"}]], "Input",
 CellLabel->
  "In[210]:=",ExpressionUUID->"1e145958-b914-454b-a4d0-b89e59878fb4"],

Cell["\<\
You can add information manually, even properties that are just for your own \
convenience:\
\>", "Text",ExpressionUUID->"3e698b44-f3af-47d5-90d7-a19c9f1bdeb1"],

Cell[BoxData[{
 RowBox[{"obj", " ", "=", " ", 
  RowBox[{"Append", "[", 
   RowBox[{"obj", ",", " ", 
    RowBox[{"\"\<Name\>\"", "\[Rule]", " ", "\"\<Example\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"obj", "[", "\"\<Properties\>\"", "]"}]}], "Input",
 CellLabel->
  "In[213]:=",ExpressionUUID->"ed2efe4d-31b0-4c57-9f4f-22709228e942"],

Cell["\<\
To see what possible inputs there are for defining your problem, evaluate:\
\>", "Text",ExpressionUUID->"7ceccd37-8804-46d2-aa8a-15d95a9bbbc8"],

Cell[BoxData[
 RowBox[{"defineInferenceProblem", "[", "]"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"97ccfc1b-d4e2-4e95-8d8d-ec1689c8fe9c"],

Cell["\<\
To run the nested sampling algorithm, we ultimately need to define the \
following properties:\
\>", "Text",ExpressionUUID->"79403abe-c914-4632-ac0e-c951f7a23119"],

Cell[CellGroupData[{

Cell["\<\
Parameters: A list specifying the parameters that are to be estimated and \
their limits (which are allowed to be infinite)\
\>", "Item",ExpressionUUID->"dedcbaac-08fb-440d-b792-4027247452f6"],

Cell["\<\
LogLikelihoodFunction: a function (preferably compiled) that evaluates the \
loglikelihood at a given point in the parameter space\
\>", "Item",ExpressionUUID->"7efc1576-57dc-4682-90c3-ea03125e110e"],

Cell["\<\
LogPriorPDFFunction: The logPDF function (preferably compiled) of the prior \
distribution (does not need to be normalised, but the computed evidence \
depends on its normalisation constant)\
\>", "Item",ExpressionUUID->"15133744-1b1f-4243-bf81-39dde16d063c"],

Cell["\<\
StartingPoints: A set of samples from the prior to use as a starting point\
\>", "Item",ExpressionUUID->"0cc6ffc5-a45a-4f5b-8cf3-0f0af5457e1e"]
}, Open  ]],

Cell["\<\
The role of defineInferenceProblem is to construct these properties from the \
properties supplied by the user. However, the you can forego the use of \
defineInferenceProblem by simply creating an association with the 4 required \
items and wrapping inferenceObject around it.\
\>", "Text",ExpressionUUID->"2578b9b2-508a-44a5-b9d5-a8478630ed22"],

Cell[TextData[{
 "The convention that is used throughout this package, is that the ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "fe7357b8-dd27-4c63-9566-f76f793669ad"],
 " estimation parameters from an vector in ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "1878f550-b5e8-4bc6-948b-f3d82df18183"],
 "D space. For example, if the loglikelihood function is a function of 2 \
parameters, it should be of the form:"
}], "Text",ExpressionUUID->"298e3973-90b4-4529-99cc-49a8f76d6537"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"logLikelihood", "[", "paramVector_List", "]"}], ":=", " ", 
   RowBox[{"numericFunctionOf", "[", 
    RowBox[{
     RowBox[{"paramVector", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"paramVector", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"c63d85dc-a2d5-4209-9209-239524ab9c44"],

Cell[BoxData["$MachineLogZero"], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"abfea12f-767a-4206-963b-247dd18fc1e9"],

Cell[TextData[{
 "Furthermore, the code works best if we stay within the realm of machine \
numbers. However, since the log of zero cannot be represented in machine \
numbers, the package uses a value called ",
 StyleBox["$MachineLogZero",
  FontWeight->"Bold"],
 " instead:"
}], "Text",ExpressionUUID->"a22373cc-f058-4f76-82b5-12e0599b268c"],

Cell[BoxData["$MachineLogZero"], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"1e065af1-1a03-447e-8db1-714257167fc6"],

Cell["\<\
This value should be returned whenever the point in parameter space is \
outside of the support of the prior or loglikelihood. If you use \
defineInferenceProblem to create the loglikelihood and log prior PDF, this is \
handled automatically:\
\>", "Text",ExpressionUUID->"571b30ca-5609-4682-ae0e-d2ce69f3e8d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"-", "1"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obj", "[", "\"\<LogLikelihoodFunction\>\"", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"-", "1"}]}], "}"}], "]"}]}], "Input",
 CellLabel->
  "In[221]:=",ExpressionUUID->"3bc9806e-4e55-4877-be73-33e722b5db3c"],

Cell[CellGroupData[{

Cell["Known issues:", \
"Subsubsection",ExpressionUUID->"0729daee-49c4-4576-8f19-0a1bafc498cd"],

Cell["\<\
Please note that if you specify an explicit PriorDistribution, the limits \
specified by the parameters will cut off the prior without adjusting the \
normalisation constant of the prior PDF:\
\>", "Text",ExpressionUUID->"299b2284-7d50-4983-9afd-e25b994ae4d2"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"obj", "=", 
       RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", "100"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"mu", ",", " ", "sigma"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mu", ",", 
              RowBox[{"-", "lim"}], ",", "lim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sigma", ",", "0", ",", "lim"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
          RowBox[{"ProductDistribution", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "100"}], "]"}], ",", 
            RowBox[{"ExponentialDistribution", "[", 
             RowBox[{"1", "/", "100"}], "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Exp", "@", 
         RowBox[{
          RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"lim", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Infinity]", ",", "10"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[259]:=",ExpressionUUID->"f3198af2-e07d-4a59-83d2-d6241dab0731"],

Cell["\<\
When specifying the prior distribution as a list of distributions (in which \
case defineInferenceProblem will construct a ProductDistribution for you), \
the normalisation will be restored:\
\>", "Text",ExpressionUUID->"fd3663d4-f4e7-461a-9b0d-2c61859f0e61"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"obj", "=", 
       RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", "100"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"mu", ",", " ", "sigma"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mu", ",", 
              RowBox[{"-", "lim"}], ",", "lim"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sigma", ",", "0", ",", "lim"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "100"}], "]"}], ",", 
            RowBox[{"ExponentialDistribution", "[", 
             RowBox[{"1", "/", "100"}], "]"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Exp", "@", 
         RowBox[{
          RowBox[{"obj", "[", "\"\<LogPriorPDFFunction\>\"", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"lim", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Infinity]", ",", "10"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[261]:=",ExpressionUUID->"51c650e7-5220-49ba-b915-269eca8a7773"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["General nested sampling problems", \
"Subsection",ExpressionUUID->"9c6d33f5-ad36-4bd4-aeec-91b49adb4607"],

Cell[CellGroupData[{

Cell["Cauchy distribution", \
"Subsubsection",ExpressionUUID->"d999f0a5-3322-4d46-9a9d-41c72825f113"],

Cell["\<\
As a simple example, here is how you inference the parameters of a Cauchy \
distribution from some data. \
\>", "Text",ExpressionUUID->"525d5a1b-6599-4f60-a750-615a05128698"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"CauchyDistribution", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "25"}], "]"}]}], ";"}], "\n", 
 RowBox[{"obj", " ", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"CauchyDistribution", "[", 
      RowBox[{"a", ",", " ", "b"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "0.01", ",", "100"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\""}], 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<OriginalDistribution\>\"", " ", "\[Rule]", " ", "dist"}]}], 
   " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "an", " ", "optional", " ", "property", " ", 
     "that", " ", "we", " ", "attach", " ", "for", " ", "convenience"}], " ", 
    "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[219]:=",ExpressionUUID->"89f371e4-4212-4849-8da4-bc154bf5086d"],

Cell["\<\
Note that the data has been transformed from a vector to a matrix as part of \
the standardisation process:\
\>", "Text",ExpressionUUID->"5d78d050-d9dc-499a-830a-46e8f3aafa1a"],

Cell[BoxData[{"testdata", "\[IndentingNewLine]", 
 RowBox[{"obj", "[", "\"\<Data\>\"", "]"}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"224b884a-511e-4a16-bf38-b70655db05e8"],

Cell["Run the algorithm.", \
"Text",ExpressionUUID->"9c4464e2-9891-4e02-9d77-058970dec72a"],

Cell[CellGroupData[{

Cell["\<\
 The \[OpenCurlyDoubleQuote]MonteCarloSteps\[CloseCurlyDoubleQuote] option \
determines how many MCMC steps to take to generate each new sample.\
\>", "Item",ExpressionUUID->"f6f25b18-9a75-484c-a926-863c57922e19"],

Cell["\<\
The \"MinMaxAcceptanceRate\" option determines the limits of the MCMC \
acceptance rate before the algorithm accepts a new sample.\
\>", "Item",ExpressionUUID->"c8bc7da0-97aa-45a8-94d7-e409c07599c5"],

Cell["\<\
The \"TerminationFraction\" option determines how long the algorithm iterates \
before convergence is reached.\
\>", "Item",ExpressionUUID->"fc329690-1965-4b30-b23d-0dfe742e0b84"],

Cell["\<\
The \[OpenCurlyDoubleQuote]MaxIterations\[CloseCurlyDoubleQuote] determines \
the maximum number of samples that will be generated\
\>", "Item",ExpressionUUID->"6d70996d-94ab-4800-9bfa-2c408817d8a9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"result", " ", "=", 
  RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "100"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MinMaxAcceptanceRate\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.9"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"result", "[", "\"\<LogEvidence\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"result", "[", "\"\<Properties\>\"", "]"}]}], "Input",
 CellLabel->
  "In[225]:=",ExpressionUUID->"51cb9ac9-9a78-449e-b410-15d3a99a7df9"],

Cell[TextData[{
 "The standard error on the logevidence is obtained by Monte Carlo sampling \
of the ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "440e60b9-c886-4254-af8b-17dbd4ebb325"],
 "-axis values of the integral as described by Skilling in chapter 8 of his \
paper. The \[OpenCurlyDoubleQuote]PostProcessSamplingRuns\
\[CloseCurlyDoubleQuote] option controls how many such Monte Carlo samples \
are used to compute this standard error."
}], "Text",ExpressionUUID->"10d23ac1-6bb4-4ef2-a8c3-2e241dbd0d41"],

Cell[TextData[{
 "To speed up the computation, you can use ",
 StyleBox["parallelNestedSampling",
  FontWeight->"Bold"],
 " to divide the process over multiple kernels. Instead of having 100 living \
points, you can run 4 kernels with each 25 living points each (which each \
converge faster than 1 process with 100 points) for a comparable result:"
}], "Text",ExpressionUUID->"6c8c1185-8eeb-4ed2-80d9-b7f19eeb5501"],

Cell[BoxData[{
 RowBox[{"result", "=", 
  RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "25"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MinMaxAcceptanceRate\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.9"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"result", "[", "\"\<LogEvidence\>\"", "]"}]}], "Input",
 CellLabel->
  "In[239]:=",ExpressionUUID->"a47f8460-0e47-4cea-98c6-be14ffa00e40"],

Cell[TextData[{
 "Use the ",
 StyleBox["calculationReport",
  FontWeight->"Bold"],
 " function to get a quick overview of the result:"
}], "Text",ExpressionUUID->"b36a7a86-55b4-486c-80b8-7078d4f12129"],

Cell[BoxData[
 RowBox[{"calculationReport", "[", "result", "]"}]], "Input",
 CellLabel->
  "In[241]:=",ExpressionUUID->"eca11bcf-67d9-4333-b81f-c825f03583cd"],

Cell[TextData[{
 "Visualise the posterior distribution of the parameters ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "e252e61b-ed14-437e-aad4-042883d30c9b"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "32b510ec-e797-4af2-99a9-1ff625b8c58b"],
 ":"
}], "Text",ExpressionUUID->"cdc731db-c506-4ae3-980f-c094e1fa0c4c"],

Cell[BoxData[{
 RowBox[{"Mean", "[", 
  RowBox[{"result", "[", "\"\<EmpiricalPosteriorDistribution\>\"", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Covariance", "[", 
  RowBox[{"result", "[", "\"\<EmpiricalPosteriorDistribution\>\"", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"covarianceMatrixPlot", "[", "result", "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{"result", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ScalingFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", "\"\<Log\>\"", ",", "None"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PerformanceGoal", "\[Rule]", " ", "\"\<Speed\>\""}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[166]:=",ExpressionUUID->"c8472bdd-c686-473b-8a7a-7a4601c77970"],

Cell[TextData[{
 "Note that the bubble chart above is cluttered up with many samples with \
very small weights. You can use the function ",
 StyleBox["takePosteriorFraction",
  FontWeight->"Bold"],
 " to discard the samples with the smallest weights and retain the most \
important samples. In the example below, 1% of the posterior mass is \
discarded:"
}], "Text",ExpressionUUID->"0c599086-253a-4d81-a9d0-c03bba2b3217"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"truncatedResult", " ", "=", " ", 
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{"result", ",", "0.99"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", "\[IndentingNewLine]", 
  RowBox[{"truncatedResult", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ScalingFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", "\"\<Log\>\"", ",", "None"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[171]:=",ExpressionUUID->"5ea9102c-5b40-4d5d-b824-05ccb85bc18e"],

Cell[TextData[{
 "Plot the marginal PDFs of ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "47bba337-f3a4-4c06-8d56-087fcba77dc5"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "4fae5fe1-6ef6-4767-9b99-dcac6868dde7"],
 ":"
}], "Text",ExpressionUUID->"d534d4d8-9d1d-446f-9d9a-ed0c8ed8214d"],

Cell[BoxData[{
 RowBox[{"posteriorMarginalPDFPlot1D", "[", 
  RowBox[{"truncatedResult", ",", "a", ",", 
   RowBox[{"ScalingFunctions", "->", "\"\<Log\>\""}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}], ",", "All"}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorMarginalPDFPlot1D", "[", 
  RowBox[{"truncatedResult", ",", "b", ",", 
   RowBox[{"ScalingFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.01", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}], ",", "All"}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->
  "In[208]:=",ExpressionUUID->"48ab6113-e03d-46c6-b731-a97647066684"],

Cell["\<\
Compare the original distribution that generated the data with the Bayesian \
predictive distribution:\
\>", "Text",ExpressionUUID->"d1e714d7-a5a4-4948-bb3c-2eed94ddd266"],

Cell[BoxData[
 RowBox[{"LogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", "truncatedResult", "]"}], ",", 
        "x"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"EstimatedDistribution", "[", 
         RowBox[{
          RowBox[{"Flatten", " ", "@", " ", 
           RowBox[{"result", "[", "\"\<Data\>\"", "]"}]}], ",", 
          RowBox[{"result", "[", "\"\<GeneratingDistribution\>\"", "]"}], ",", 
          RowBox[{"ParameterEstimator", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<MaximumLikelihood\>\"", ",", " ", 
             RowBox[{"Method", " ", "->", " ", "\"\<FindMaximum\>\""}]}], 
            "}"}]}]}], "]"}], ",", " ", "x"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"result", "[", "\"\<OriginalDistribution\>\"", "]"}], ",", 
        "x"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Posterior predictive PDF\>\"", ",", " ", 
      "\"\<PDF based on maximum likelihood estimate\>\"", ",", " ", 
      "\"\<PDF of original distribution\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[191]:=",ExpressionUUID->"7cf996e1-36e2-4b55-878a-616faeff539e"],

Cell["\<\
Compute the evidence of a competing model to see if it offers a better \
explanation of the data. In this case the evidence is significantly lower for \
model 2, so the Cauchy distribution explains the data better than a normal \
distribution:\
\>", "Text",ExpressionUUID->"4b312315-a2f6-44eb-928a-02983d3d8e6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"obj2", " ", "=", 
   RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"a", ",", " ", "b"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "0.01", ",", "100"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\""}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obj2", "=", 
   RowBox[{"generateStartingPoints", "[", 
    RowBox[{"obj2", ",", " ", "25"}], "]"}]}], ";"}], "\n", 
 RowBox[{"result2", " ", "=", 
  RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{"obj2", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"result2", "[", "\"\<LogEvidence\>\"", "]"}]}], "Input",
 CellLabel->
  "In[235]:=",ExpressionUUID->"2375529a-b224-4e04-8f0b-6cfce3e8ab9a"],

Cell[BoxData[
 RowBox[{"LogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", "result", "]"}], ",", "x"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"predictiveDistribution", "[", "result2", "]"}], ",", "x"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"result", "[", "\"\<OriginalDistribution\>\"", "]"}], ",", 
        "x"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Posterior predictive PDF model 1\>\"", ",", " ", 
      "\"\<Posterior predictive PDF model 2\>\"", ",", " ", 
      "\"\<PDF of original distribution\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[214]:=",ExpressionUUID->"97f91a6a-ea1c-4c7f-9959-e4123be4dd17"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fitting Normal data with a SkewNormal distribution", \
"Subsubsection",ExpressionUUID->"016c2ace-24ef-40c8-bc76-9fa490bc7769"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "50"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"<|", "|>"}]}], ";"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"38adc9dc-eac0-479c-a54d-6998a43e56c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"SkewNormalDistribution", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{"dist", ",", "20"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"<|", "|>"}]}], ";"}]}], "Input",
 CellLabel->
  "In[274]:=",ExpressionUUID->"05405bfa-ea1b-4ef9-954c-3eed34b6cc52"],

Cell[BoxData[
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"SkewNormalDistribution", "[", 
         RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", "x"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->
  "In[127]:=",ExpressionUUID->"73c88b0a-8a29-44a0-a23f-749ae325f129"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "[", "\"\<Normal\>\"", "]"}], " ", "=", " ", 
  RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"a", ",", " ", "b"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "0.1", ",", "10"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\""}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<OriginalDistribution\>\"", " ", "\[Rule]", " ", "dist"}]}],
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "100"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "3000"}]}], 
   "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"d2028e80-3d63-4c29-8f38-87b677d35f29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], " ", "=", " ", 
  RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
       RowBox[{"SkewNormalDistribution", "[", 
        RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "0.1", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<LocationParameter\>\"", ",", " ", "\"\<ScaleParameter\>\"", ",", 
         " ", "\"\<LocationParameter\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<OriginalDistribution\>\"", " ", "\[Rule]", " ", "dist"}]}],
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "100"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "3000"}]}], 
   "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"b622be28-9d7d-492b-a5d5-2abcbde9e3af"],

Cell[BoxData[{
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{
     RowBox[{"result", "[", "\"\<Normal\>\"", "]"}], ",", "0.99"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{
     RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], ",", "0.99"}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{
   RowBox[{"takePosteriorFraction", "[", 
    RowBox[{
     RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], ",", "0.99"}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"f1c4d1a3-c23d-4a42-a171-307b2577dd7d"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"testdata", ",", 
     RowBox[{"{", "0.1", "}"}], ",", "\"\<PDF\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PDF", "[", 
         RowBox[{
          RowBox[{"predictiveDistribution", "[", 
           RowBox[{"takePosteriorFraction", "[", 
            RowBox[{
             RowBox[{"result", "[", "\"\<Normal\>\"", "]"}], ",", "0.99"}], 
            "]"}], "]"}], ",", "x"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PDF", "[", 
         RowBox[{
          RowBox[{"predictiveDistribution", "[", 
           RowBox[{"takePosteriorFraction", "[", 
            RowBox[{
             RowBox[{"result", "[", "\"\<SkewNormal\>\"", "]"}], ",", 
             "0.99"}], "]"}], "]"}], ",", "x"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[126]:=",ExpressionUUID->"cb413159-1ef0-4b82-bad8-056199db4cb0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Regression", \
"Subsubsection",ExpressionUUID->"005ca54c-da34-48e2-8493-06b12e6078d3"],

Cell["\<\
Regression problems can be specified as well. First define some test data:\
\>", "Text",ExpressionUUID->"210f6c26-ff10-449b-a992-93605abe9f4e"],

Cell[BoxData[{
 RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SeedRandom", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"testdata", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{"#", "+", 
          RowBox[{"2", " ", 
           RowBox[{"RandomReal", "[", "]"}]}]}], ")"}]}], ")"}], "&"}], "/@", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "20"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"List", "@@@", "testdata"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "testdata"}], "Input",
 CellLabel->
  "In[189]:=",ExpressionUUID->"eda63068-e7af-4003-bbc7-9d06cd13dced"],

Cell[TextData[{
 "Note that the data is specified as a list of rules or as a rule of lists (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in1", ",", " ", "in2", ",", " ", "..."}], "}"}], "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"out1", ",", " ", "out2", ",", " ", "..."}], "}"}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "94b86c88-6243-4c65-9bd3-3e42dcf98f75"],
 ") just like in ",
 Cell[BoxData[
  TemplateBox[{
   StyleBox["\"Predict\"", "Text", Bold, StripOnInput -> False],
    "paclet:/ref/Predict"},
   "HyperlinkPaclet"]],ExpressionUUID->"bb40589d-ada4-4fb8-83d1-df5a5cb48876"],
 ". "
}], "Text",ExpressionUUID->"0bdd4ac7-ff0f-418c-87bb-4266a50cf842"],

Cell["\<\
The model is specified as a distribution that depends on an independent \
variable (note the standardisation of the data):\
\>", "Text",ExpressionUUID->"36901d8a-3775-4fb5-8a8e-528b395d42a4"],

Cell[BoxData[{
 RowBox[{"obj", "=", 
  RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
     RowBox[{"NormalDistribution", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ",", 
       "\[IndentingNewLine]", "sigma"}], "\[IndentingNewLine]", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sigma", ",", "0.1", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
     RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<LocationParameter\>\"", ",", "\"\<LocationParameter\>\"", ",", 
       " ", "\"\<ScaleParameter\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"obj", "[", "\"\<Data\>\"", "]"}]}], "Input",
 CellLabel->
  "In[191]:=",ExpressionUUID->"0bece909-f8bd-4067-914d-743675c6bff2"],

Cell[TextData[{
 "The functions ",
 StyleBox["predictiveDistribution",
  FontWeight->"Bold"],
 " and ",
 StyleBox["regressionPlot1D",
  FontWeight->"Bold"],
 " are useful helper functions to visualise the results:"
}], "Text",ExpressionUUID->"ab55195f-f51b-4a91-8906-e1197ad6bbbb"],

Cell[BoxData[{
 RowBox[{"result", "=", 
  RowBox[{"nestedSampling", "[", "obj", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"predictions", "=", 
   RowBox[{"predictiveDistribution", "[", 
    RowBox[{
     RowBox[{"takePosteriorFraction", "[", 
      RowBox[{"result", ",", "0.99"}], "]"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2", ",", "0.1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"regressionPlot1D", "[", 
  RowBox[{"result", ",", "predictions"}], "]"}]}], "Input",
 CellLabel->
  "In[198]:=",ExpressionUUID->"d7c9dbb4-5f69-48f3-8a47-1d1c6af3ff80"],

Cell["Compare 3 polynomial models of increasing order:", \
"Text",ExpressionUUID->"0bee3961-019b-413b-a42c-5880deccbcd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"variables", "[", "order_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sequence", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<c\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "order"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"s0", ",", "0.01", ",", "100"}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"result", "=", "\[IndentingNewLine]", 
  RowBox[{"Association", "@", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"order", "->", " ", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"obj", "=", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"vars", " ", "=", " ", 
              RowBox[{"variables", "[", "order", "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"defineInferenceProblem", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<Data\>\"", "\[Rule]", " ", "testdata"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<GeneratingDistribution\>\"", " ", "\[Rule]", " ", 
               RowBox[{"NormalDistribution", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vars", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}], ",", " ", "1"}], "]"}], "]"}], " ", 
                  ".", " ", 
                  RowBox[{"x", "^", 
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "order"}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<Parameters\>\"", "\[Rule]", "vars"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<IndependentVariables\>\"", "\[Rule]", " ", 
               RowBox[{"{", "x", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<PriorDistribution\>\"", "\[Rule]", " ", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"\"\<LocationParameter\>\"", ",", 
                   RowBox[{"order", "+", "1"}]}], "]"}], ",", " ", 
                 "\"\<ScaleParameter\>\""}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"nestedSampling", "[", "\[IndentingNewLine]", 
         RowBox[{"obj", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "25"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "3000"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"order", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], 
    "]"}]}]}]}], \
"Input",ExpressionUUID->"73cf2cba-512c-4d18-849a-9b6f2a7c28ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"regressionPlot1D", "[", 
    RowBox[{"#", ",", 
     RowBox[{"predictiveDistribution", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2", ",", "0.1"}], "]"}]}], "]"}]}], "]"}], 
   "&"}], "/@", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"takePosteriorFraction", "[", 
      RowBox[{"#", ",", "0.99"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
    "result"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[178]:=",ExpressionUUID->"094fb4a8-d123-4687-a48b-7234c6a1c4ce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gaussian process", \
"Subsection",ExpressionUUID->"b61ec9d9-957c-4b6a-a30c-cd85ce37de98"],

Cell[CellGroupData[{

Cell["1D", \
"Subsubsection",ExpressionUUID->"96229166-9049-4c5e-955c-f84582fb9961"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", "100"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "\[Rule]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Function", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"0.5", " ", "#"}], "]"}], "+", 
         RowBox[{"0.4", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "#"}], "]"}]}], "+", 
         RowBox[{"0.4", "#"}], "+", "1", "+", 
         RowBox[{"0.3", "*", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", "]"}], ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"x", "+", 
        RowBox[{"0.2", "*", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", "]"}], ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"List", "@@@", 
   RowBox[{"Thread", "[", "testdata", "]"}]}], 
  "]"}]}], "Input",ExpressionUUID->"80d48443-5e1c-4a65-a617-ae2b51124942"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"result", "=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s1", ",", "0.01", ",", "100"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"l", ",", "0.05", ",", " ", "30"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"s0", ",", "0.02", ",", "20"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"m", ",", " ", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"gaussianProcessNestedSampling", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"normalizeData", "[", "testdata", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{"s1", " ", "*", 
         RowBox[{"Boole", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Subtract", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "2"], "<", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"6", " ", "l"}], ")"}], "2"]}], "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Divide", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Subtract", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "2"], ",", 
             SuperscriptBox["l", "2"]}], "]"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", "s0", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Function", "[", "m", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ScaleParameter\>\"", ",", " ", "\"\<ScaleParameter\>\"", ",", 
         "\"\<ScaleParameter\>\"", ",", " ", "\"\<LocationParameter\>\""}], 
        "}"}], ",", "\[IndentingNewLine]", "vars", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<SamplePoolSize\>\"", " ", "\[Rule]", " ", "25"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "10000"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MinIterations\>\"", "\[Rule]", "20"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "100"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<MonteCarloStepDistribution\>\"", " ", "\[Rule]", 
        "NormalDistribution"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<InitialMonteCarloStepSize\>\"", " ", "\[Rule]", " ", "0.075"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Monitor\>\"", " ", "\[Rule]", " ", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Likelihood\>\"", " ", "\[Rule]", " ", "\"\<Custom\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<LikelihoodMaximum\>\"", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MonteCarloStepSizeAdjustment\>\"", " ", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Order\>\"", " ", "\[Rule]", " ", "2"}], ",", " ", 
          RowBox[{"\"\<HistoryLength\>\"", "\[Rule]", "10"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", "result", 
  "]"}]}], "Input",ExpressionUUID->"1aa21abf-8a3e-4e4e-9f6a-1625bab22d65"],

Cell[BoxData[
 RowBox[{"covarianceMatrixPlot", "[", "result", 
  "]"}]], "Input",ExpressionUUID->"93091536-6b82-464c-9ddd-e795673cb45c"],

Cell[BoxData[
 RowBox[{"posteriorMarginalPDFPlot1D", "[", 
  RowBox[{"result", ",", "1"}], 
  "]"}]], "Input",ExpressionUUID->"18ae8199-2107-4391-b68a-896a376e71fb"],

Cell[BoxData[
 RowBox[{"posteriorMarginalPDFDensityPlot2D", "[", 
  RowBox[{"result", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"a99c7639-9107-49b2-8e21-61663afefbed"],

Cell[BoxData[
 RowBox[{"posteriorBubbleChart", "[", 
  RowBox[{"result", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "0.99"}], 
  "]"}]], "Input",ExpressionUUID->"ec0824d4-d056-48d2-80aa-9a702f192364"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"predictions", " ", "=", " ", 
   RowBox[{"predictFromGaussianProcess", "[", 
    RowBox[{"result", ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "3"}], ",", "3", ",", "0.2"}], "]"}], ",", "0.99"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gaussianProcessPredictionPlot", "[", 
  RowBox[{"result", ",", " ", "predictions", ",", " ", 
   RowBox[{"\"\<DistributionPercentiles\>\"", " ", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"0.01", ",", " ", "0.5", ",", " ", "0.99"}], "}"}]}]}], 
  "]"}]}], "Input",ExpressionUUID->"18f7fd72-b160-4bdb-9712-01cd3a87a018"],

Cell[BoxData[
 RowBox[{"calculationReport", "[", "result", 
  "]"}]], "Input",ExpressionUUID->"1ad9895f-d50c-4eb6-ab16-e35bc4035b66"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial fitting", \
"Subsubsection",ExpressionUUID->"49bdc88f-3bd7-46d7-af5f-15f934a06149"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", "20"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "\[Rule]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Function", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0.4", "#"}], "+", "1", "+", 
         RowBox[{"1", "*", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"CauchyDistribution", "[", "]"}], ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "[", "x", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"List", "@@@", 
   RowBox[{"Thread", "[", "testdata", "]"}]}], 
  "]"}]}], "Input",ExpressionUUID->"385f3733-4b0d-43c0-9ec8-ecdb4fd55572"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"result", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"order", "->", " ", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vars", "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Symbol", "[", 
                   RowBox[{"\"\<x\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
                  RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", "order"}], "}"}]}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"s0", ",", "0.01", ",", "100"}], "}"}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"gaussianProcessNestedSampling", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"normalizeData", "[", "testdata", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Function", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Function", "[", "s0", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Function", "[", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Total", "@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", 
                 SuperscriptBox["#", 
                  RowBox[{"i", "-", "1"}]]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "vars", "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{"\"\<LocationParameter\>\"", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "vars", "]"}], "-", "1"}]}], "]"}], 
              ",", " ", "\"\<ScaleParameter\>\""}], "}"}]}], ",", 
           "\[IndentingNewLine]", "vars", ",", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Likelihood\>\"", " ", "\[Rule]", " ", "\"\<Custom\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"order", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", 
  RowBox[{"result", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "\"\<LogEvidence\>\""}], "]"}], "]"}], 
  "]"}]}], "Input",ExpressionUUID->"fb4dd365-b2ee-48be-afdc-5769d0def199"],

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"posteriorBubbleChart", "[", 
     RowBox[{
      RowBox[{"result", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", "0.99"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "result", "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "]"}]], "Input",ExpressionUUID->"15f8dad7-22c1-4236-8541-d14249b6a5a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"predictions", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"predictFromGaussianProcess", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3", ",", "0.2"}], "]"}], ",", "0.99"}], 
      "]"}], "&"}], "/@", "result"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gaussianProcessPredictionPlot", "[", 
     RowBox[{
      RowBox[{"result", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"predictions", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"\"\<DistributionPercentiles\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"0.01", ",", "0.5", ",", "0.99"}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "result", "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "]"}]}], "Input",ExpressionUUID->"80c90c0d-fcc3-4c83-bacb-a1198abe2346"]
}, Closed]],

Cell[CellGroupData[{

Cell["With trend in noise level", \
"Subsubsection",ExpressionUUID->"6bf01131-4c0f-443b-8a26-c859b624723c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"result", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"order", "->", " ", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vars", "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Symbol", "[", 
                   RowBox[{"\"\<x\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
                  RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", "order"}], "}"}]}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"s0", ",", "0.01", ",", "100"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"s1", ",", "0.01", ",", "100"}], "}"}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"gaussianProcessNestedSampling", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"normalizeData", "[", "testdata", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Function", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Function", "[", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s0", " ", "+", " ", 
               RowBox[{"#", " ", "s1"}]}], ")"}], "2"], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Function", "[", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Total", "@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", 
                 SuperscriptBox["#", 
                  RowBox[{"i", "-", "1"}]]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "vars", "]"}], "-", "2"}]}], 
                 "}"}]}], "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{"\"\<LocationParameter\>\"", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "vars", "]"}], "-", "1"}]}], "]"}], 
              ",", " ", "\"\<ScaleParameter\>\""}], "}"}]}], ",", 
           "\[IndentingNewLine]", "vars", ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<Likelihood\>\"", " ", "\[Rule]", " ", "Automatic"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"order", ",", 
        RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", 
  RowBox[{"result", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "\"\<LogEvidence\>\""}], "]"}], "]"}], 
  "]"}]}], "Input",ExpressionUUID->"b988cd55-80f8-4dc7-9e51-bacdbc2f1740"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"predictions", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"predictFromGaussianProcess", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3", ",", "0.2"}], "]"}], ",", "0.99"}], 
      "]"}], "&"}], "/@", "result"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gaussianProcessPredictionPlot", "[", 
     RowBox[{
      RowBox[{"result", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"predictions", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"\"\<DistributionPercentiles\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"0.01", ",", "0.5", ",", "0.99"}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "result", "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "]"}]}], "Input",ExpressionUUID->"af3e4814-7a66-492d-afb0-88745a124164"]
}, Closed]],

Cell[CellGroupData[{

Cell["2D", \
"Subsubsection",ExpressionUUID->"1f539c70-5a79-4bee-bd88-cd7241252ff7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "2"]}], ")"}]}], "&"}], 
    " ", "@", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"100", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"Transpose", "@", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"testdata", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"testdata", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",ExpressionUUID->"c9b08ba6-420b-4df9-aab6-fd8f1d663c3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"result", "=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s1", ",", "0.01", ",", "100"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"l", ",", "0.05", ",", " ", "30"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"s0", ",", "0.02", ",", "20"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"m", ",", " ", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"gaussianProcessNestedSampling", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"normalizeData", "[", "testdata", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dist", " ", "=", " ", 
            RowBox[{"Norm", "[", 
             RowBox[{"Subtract", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"s1", " ", "*", 
           RowBox[{"Boole", "[", 
            RowBox[{"dist", "<", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"6", " ", "l"}], ")"}], "2"]}], "]"}], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"Divide", "[", 
               RowBox[{"dist", ",", "l"}], "]"}], "2"]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", "s0", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Function", "[", "m", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ScaleParameter\>\"", ",", " ", "\"\<ScaleParameter\>\"", ",", 
         "\"\<ScaleParameter\>\"", ",", " ", "\"\<LocationParameter\>\""}], 
        "}"}], ",", "\[IndentingNewLine]", "vars", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<SamplePoolSize\>\"", " ", "\[Rule]", " ", "25"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "10000"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MinIterations\>\"", "\[Rule]", "20"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "100"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<InitialMonteCarloStepSize\>\"", " ", "\[Rule]", " ", "0.075"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<TerminationFraction\>\"", " ", "\[Rule]", " ", "0.01"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Monitor\>\"", " ", "\[Rule]", " ", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Likelihood\>\"", " ", "\[Rule]", " ", "\"\<Custom\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<LikelihoodMaximum\>\"", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MonteCarloStepSizeAdjustment\>\"", " ", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Order\>\"", " ", "\[Rule]", " ", "2"}], ",", " ", 
          RowBox[{"\"\<HistoryLength\>\"", "\[Rule]", "10"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", "result", 
  "]"}]}], "Input",ExpressionUUID->"308cd261-e803-4cd2-b5eb-9d4405f75d76"],

Cell[BoxData[
 RowBox[{"predictFromGaussianProcess", "[", 
  RowBox[{"result", ",", " ", "10", ",", "1"}], 
  "]"}]], "Input",ExpressionUUID->"6fa08671-00fe-4c55-988c-dfabc4aec585"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testData", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"RandomFunction", "[", 
     RowBox[{
      RowBox[{"OrnsteinUhlenbeckProcess", "[", 
       RowBox[{"2", ",", ".2", ",", ".3", ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "10", ",", ".1"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "@", 
  "testData"}]}], \
"Input",ExpressionUUID->"9be9f6bc-a2c2-4f2a-8934-2d77a427e15f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resultOUP", "=", 
   RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dat", "=", "testData"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Sigma]", ",", "\[Theta]"}], "}"}], ",", 
         RowBox[{"LogLikelihood", "[", 
          RowBox[{
           RowBox[{"OrnsteinUhlenbeckProcess", "[", 
            RowBox[{"\[Mu]", ",", "\[Sigma]", ",", "\[Theta]", ",", 
             RowBox[{"dat", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"Rest", "/@", "dat"}]}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<LocationParameter\>\"", ",", "\"\<ScaleParameter\>\"", ",", 
       "\"\<ScaleParameter\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "0.01", ",", "20"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0.01", ",", "20"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "25"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "1000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", "resultOUP", 
  "]"}]}], "Input",ExpressionUUID->"31743788-6bbe-46a5-b208-bff2943eb43f"],

Cell[BoxData[
 RowBox[{"resultOUP", "[", "\"\<LogEvidence\>\"", 
  "]"}]], "Input",ExpressionUUID->"9df611a3-a845-4283-b053-b217c58ac1aa"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"max", " ", "=", "15"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"InverseCDF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"predictiveDistribution", "[", "\[IndentingNewLine]", 
                RowBox[{"resultOUP", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OrnsteinUhlenbeckProcess", "[", 
                    RowBox[{"##", ",", 
                    RowBox[{"testData", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
                   "[", "t", "]"}], "&"}], ",", "\[IndentingNewLine]", 
                 "0.99"}], "\[IndentingNewLine]", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0.01", ",", "0.5", ",", "0.99"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0.1", ",", "max", ",", "1"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0.1", ",", "max"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Point", "/@", "testData"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"InverseCDF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"predictiveDistribution", "[", "\[IndentingNewLine]", 
                RowBox[{"resultOUP", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OrnsteinUhlenbeckProcess", "[", 
                    RowBox[{"##", ",", 
                    RowBox[{"testData", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}], 
                   "[", "t", "]"}], "&"}], ",", "\[IndentingNewLine]", 
                 "0.99"}], "\[IndentingNewLine]", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0.01", ",", "0.5", ",", "0.99"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0.1", ",", 
               RowBox[{"max", "-", "10"}], ",", "0.2"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"10.1", ",", "max"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Point", "/@", "testData"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"19c6cec6-3171-486f-9c36-2e2d0ecc7666"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resultGBM", "=", 
   RowBox[{"parallelNestedSampling", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dat", "=", "testData"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Sigma]"}], "}"}], ",", 
         RowBox[{"LogLikelihood", "[", 
          RowBox[{
           RowBox[{"GeometricBrownianMotionProcess", "[", 
            RowBox[{"\[Mu]", ",", "\[Sigma]", ",", 
             RowBox[{"dat", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"Rest", "/@", "dat"}]}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<ScaleParameter\>\"", ",", "\"\<ScaleParameter\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "0.01", ",", "100"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "0.01", ",", "20"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<MonteCarloSteps\>\"", "\[Rule]", "300"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SamplePoolSize\>\"", "\[Rule]", "25"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "1000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ParallelRuns\>\"", "\[Rule]", "4"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dataset", "[", "resultGBM", 
  "]"}]}], "Input",ExpressionUUID->"ab1ba95d-aa60-49be-8e84-66f6239f040e"],

Cell[BoxData[
 RowBox[{"resultGBM", "[", "\"\<LogEvidence\>\"", 
  "]"}]], "Input",ExpressionUUID->"3a8786a6-69ad-4fae-b0b2-fb83d617bf48"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"max", " ", "=", "15"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"InverseCDF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"predictiveDistribution", "[", "\[IndentingNewLine]", 
                RowBox[{"resultGBM", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"GeometricBrownianMotionProcess", "[", 
                    RowBox[{"##", ",", 
                    RowBox[{"testData", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
                   "[", "t", "]"}], "&"}], ",", "\[IndentingNewLine]", 
                 "0.99"}], "\[IndentingNewLine]", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0.01", ",", "0.5", ",", "0.99"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0.1", ",", "max", ",", "1"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0.1", ",", "max"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Point", "/@", "testData"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"InverseCDF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"predictiveDistribution", "[", "\[IndentingNewLine]", 
                RowBox[{"resultGBM", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"GeometricBrownianMotionProcess", "[", 
                    RowBox[{"##", ",", 
                    RowBox[{"testData", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}], 
                   "[", "t", "]"}], "&"}], ",", "\[IndentingNewLine]", 
                 "0.99"}], "\[IndentingNewLine]", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0.01", ",", "0.5", ",", "0.99"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0.1", ",", 
               RowBox[{"max", "-", "10"}], ",", "0.2"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"10.1", ",", "max"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Point", "/@", "testData"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"bd10a345-91b1-41ae-837e-7f7ec9210626"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1904, 997},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowGroupOpener->True,
TrackCellChangeTimes->False,
SpellingDictionaries->{"CorrectWords"->{"loglikelihood", "Skilling"}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]

